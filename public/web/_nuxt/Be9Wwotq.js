import{d as B,e as C,s as D,aK as f,j as R,k as z,o as y,l as r,c as A,v as N,m as a,q as e,z as S,t as j,_ as q,y as k,x as $,ap as p}from"#entry";import L from"./CDSfhndf.js";import{_ as M}from"./Brlt-NDg.js";import T from"./BjYsydzc.js";import{_ as E}from"./Ds48qA85.js";import{_ as G}from"./BYm23QKU.js";import{a as K,c as H,d as J}from"./CthPp3Zu.js";import{c as O,a as P}from"./BUyfW8JT.js";import"./DoL5-2Ox.js";import"./DGUAW_1C.js";import"./DDJ79SjH.js";import"./Ti3HjCpC.js";import"./DegKy-XA.js";import"./B1TeSxwV.js";import"./RmzZBBRE.js";import"./C4jlvBh2.js";import"./C-XPfH0G.js";import"./7d3iyZ8h.js";import"./DaWZu8wl.js";const Q={key:0,class:"flex items-center justify-center py-10"},W={class:"mt-10 flex justify-end gap-2"},ye=B({__name:"edit",props:{id:{}},emits:["close"],setup(v,{emit:V}){const i=V,l=v,{t:o}=C(),t=D({id:l.id,name:"",description:""}),b=O({name:P().required(o("system-perms.role.nameInput"))}),{lockFn:g,isLock:x}=f(async()=>{try{const{createdAt:n,updatedAt:s,permissions:d,...c}=await K(l.id);t.value=c}catch(n){console.error("获取详情失败:",n),p().error(o("system-perms.role.getRoleFailed"))}}),{lockFn:U,isLock:w}=f(async()=>{try{l.id?await H({...t.value,id:t.value.id}):await J(t.value),p().success(o("system-perms.role.success")),i("close",!0)}catch(n){console.error("提交失败:",n),p().error(o("system-perms.role.error"))}});return R(()=>l.id&&g()),(n,s)=>{const d=S,c=L,u=M,F=T,_=q,I=E,h=G;return y(),z(h,{title:e(o)("system-perms.role.roleInfo"),description:e(o)("system-perms.role.roleInfoDesc"),ui:{content:"max-w-md"},onClose:s[3]||(s[3]=m=>i("close",!1))},{default:r(()=>[e(x)?(y(),A("div",Q,[a(d,{name:"i-lucide-loader-2",class:"size-8 animate-spin"})])):N("",!0),a(I,{state:e(t),schema:e(b),class:"space-y-4",onSubmit:e(U)},{default:r(()=>[a(u,{label:e(o)("system-perms.role.name"),name:"name",required:""},{default:r(()=>[a(c,{modelValue:e(t).name,"onUpdate:modelValue":s[0]||(s[0]=m=>e(t).name=m),placeholder:e(o)("system-perms.role.nameInput"),ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(u,{label:e(o)("system-perms.role.describe"),name:"description"},{default:r(()=>[a(F,{modelValue:e(t).description,"onUpdate:modelValue":s[1]||(s[1]=m=>e(t).description=m),ui:{root:"w-full"},placeholder:e(o)("system-perms.role.descriptionInput")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),j("div",W,[a(_,{color:"neutral",variant:"soft",size:"lg",onClick:s[2]||(s[2]=m=>i("close",!1))},{default:r(()=>[k($(e(o)("console-common.cancel")),1)]),_:1}),a(_,{color:"primary",size:"lg",type:"submit",loading:e(w)},{default:r(()=>[k($(e(o)("console-common.confirm")),1)]),_:1},8,["loading"])])]),_:1},8,["state","schema","onSubmit"])]),_:1},8,["title","description"])}}});export{ye as default};
