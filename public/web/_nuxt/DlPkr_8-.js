import{d as N,b as j,ap as G,au as A,f as I,g as D,aJ as v,i as M,c as u,o as m,j as T,p as e,l as o,y as q,q as a,v as l,k as n,C as J,_ as O,x as p,A as R}from"#entry";import{_ as H}from"./DS-TE4M7.js";import K from"./BruVSCWF.js";import{_ as Q}from"./D-6Co9ha.js";import{m as W,n as X}from"./BvGrPIC1.js";import{c as Y,a as Z}from"./BUyfW8JT.js";import"./BgHJjJs-.js";import"./DaWZu8wl.js";const ee={class:"extension-profiles-container pb-8"},te={key:0,class:"flex h-60 items-center justify-center"},se={key:1,class:"space-y-4"},oe={class:"text-lg font-semibold"},ae={class:"bg-muted space-y-4 rounded-lg p-4"},le={class:"text-sm font-medium"},ne={class:"text-muted-foreground text-sm"},re={key:0,class:"flex flex-1 items-center justify-between gap-4"},ie={class:"font-mono text-sm"},ce={key:1,class:"flex flex-1 flex-col items-start gap-4"},fe={class:"flex gap-3"},me={class:"space-y-4"},pe={class:"text-lg font-semibold"},de={class:"space-y-1"},_e={href:"https://www.buildingai.cc",target:"_blank",class:"text-primary hover:underline"},ue={class:"flex gap-3 pt-4"},Ie=N({__name:"index",setup(xe){const{t}=j(),V=G(),s=A({platformSecret:"",platformInfo:{}}),x=I(!1),i=I(""),F=Y({platformSecret:Z()}),S={root:"flex items-center gap-4",label:"min-w-20 flex-shrink-0"},C=D(()=>s.platformInfo&&Object.keys(s.platformInfo).length>0),{isLock:c,lockFn:g}=v(async()=>{try{const r=await W();s.platformInfo=r.platformInfo||{},s.platformSecret=r.platformSecret||"",x.value=!1,i.value=""}catch(r){console.error("Get platform info failed:",r)}}),y=async r=>{await X({platformSecret:r}),V.success(t("extensions.profiles.setSecretSuccess")),await g()},{isLock:k,lockFn:U}=v(async()=>{try{await y(s.platformSecret)}catch(r){console.error("Failed to set platform secret:",r)}}),$=()=>{i.value="",x.value=!0},E=()=>{x.value=!1,i.value=""},{isLock:h,lockFn:P}=v(async()=>{try{await y(i.value)}catch(r){console.error("Failed to save secret:",r)}});return M(()=>g()),(r,f)=>{const z=q,B=J,d=H,_=O,w=K,L=Q;return m(),u("div",ee,[e(c)?(m(),u("div",te,[o(z,{name:"i-ph-spinner-gap-bold",class:"text-primary size-8 animate-spin"})])):e(C)?(m(),u("div",se,[a("h3",oe,l(e(t)("extensions.profiles.platformInfo")),1),a("div",ae,[o(d,{label:e(t)("extensions.profiles.platformIcon"),ui:S},{default:n(()=>[o(B,{src:e(s).platformInfo?.websiteIcon,class:"size-10"},null,8,["src"])]),_:1},8,["label"]),o(d,{label:e(t)("extensions.profiles.platformName"),ui:S},{default:n(()=>[a("div",le,l(e(s).platformInfo?.websiteName),1)]),_:1},8,["label"]),o(d,{label:e(t)("extensions.profiles.appCount"),ui:S},{default:n(()=>[a("div",ne,l(e(s).platformInfo?.appCount),1)]),_:1},8,["label"]),o(d,{label:e(t)("extensions.profiles.platformSecret"),ui:{root:"flex items-baseline gap-4",label:"min-w-20 flex-shrink-0"}},{default:n(()=>[e(x)?(m(),u("div",ce,[o(w,{modelValue:e(i),"onUpdate:modelValue":f[0]||(f[0]=b=>R(i)?i.value=b:null),placeholder:e(t)("extensions.profiles.platformSecretPlaceholder"),class:"w-90 flex-1"},null,8,["modelValue","placeholder"]),a("div",fe,[o(_,{color:"primary",loading:e(h),disabled:e(c),onClick:e(P)},{default:n(()=>[p(l(e(t)("extensions.profiles.saveSecret")),1)]),_:1},8,["loading","disabled","onClick"]),o(_,{variant:"outline",disabled:e(h)||e(c),onClick:E},{default:n(()=>[p(l(e(t)("extensions.profiles.cancelEdit")),1)]),_:1},8,["disabled"])])])):(m(),u("div",re,[a("div",ie,l(e(s).platformSecret||e(t)("extensions.profiles.emptySecret")),1),o(_,{variant:"outline",disabled:e(h)||e(c),onClick:$},{default:n(()=>[p(l(e(s).platformSecret?e(t)("extensions.profiles.editSecret"):e(t)("extensions.profiles.setSecret")),1)]),_:1},8,["disabled"])]))]),_:1},8,["label"])])])):(m(),T(L,{key:2,schema:e(F),state:e(s),class:"space-y-6",onSubmit:e(U)},{default:n(()=>[a("div",me,[a("h3",pe,l(e(t)("extensions.profiles.platformSecret")),1),o(d,{label:e(t)("extensions.profiles.platformSecret"),name:"platformSecret",error:e(s).platformSecret&&!e(s).platformInfo?e(t)("extensions.profiles.secretError"):!1},{help:n(()=>[a("div",de,[a("div",null,[p(l(e(t)("extensions.profiles.help"))+" ",1),a("a",_e,l(e(t)("extensions.profiles.howToGetSecret")),1)])])]),default:n(()=>[o(w,{modelValue:e(s).platformSecret,"onUpdate:modelValue":f[1]||(f[1]=b=>e(s).platformSecret=b),placeholder:e(t)("extensions.profiles.platformSecretPlaceholder"),size:"lg",class:"w-sm"},null,8,["modelValue","placeholder"])]),_:1},8,["label","error"])]),a("div",ue,[o(_,{color:"primary",size:"lg",type:"submit",loading:e(k),disabled:e(c)},{default:n(()=>[p(l(e(t)("console-common.save")),1)]),_:1},8,["loading","disabled"]),o(_,{variant:"outline",size:"lg",disabled:e(k)||e(c),onClick:f[2]||(f[2]=b=>e(s).platformSecret="")},{default:n(()=>[p(l(e(t)("console-common.reset")),1)]),_:1},8,["disabled"])])]),_:1},8,["schema","state","onSubmit"]))])}}});export{Ie as default};
