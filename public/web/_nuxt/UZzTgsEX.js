const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./zN4c5UZi.js","./Dgvg0_To.js","./CDSfhndf.js","./CyWWYgEs.js","./CsY35JUW.js","./DBwQYu6J.js","./DnFVE45b.js","./DegKy-XA.js","./DSCppvl0.js","./7d3iyZ8h.js","./DXP7Kkdt.js","./BRI4D6WA.js","./B-p4_8pw.js","./D5RgyGfN.js","./CR9qioUt.js","./DlAUqK2U.js","./DqG-kozZ.js","./DyTskiS5.js","./DoL5-2Ox.js","./DVSiT9pd.js","./D_1uxSdv.js","./sOcWbrx-.js","./Brlt-NDg.js"])))=>i.map(i=>d[i]);
import{d as M,aJ as q,i as A,ap as F,e as G,s as m,aU as v,R as _,au as H,j as J,c,o as l,t as s,x as i,k as T,q as t,l as w,m as o,y as b,z as Q,F as D,_ as W,C as X,A as Y,v as Z,aq as ee,U as y}from"#entry";import{g as ae}from"./ChM0pAjz.js";import{a as se,b as te,c as ne}from"./D-hk-k_E.js";import{u as I}from"./DW_vtyFa.js";const le={class:"flex h-full flex-1 flex-col px-4 pt-4"},ie={class:"mb-2"},oe={class:"flex items-center justify-between"},ue={class:"text-2xl font-bold"},ce={class:"text-muted-foreground mt-1 text-sm"},re={class:"flex gap-2"},de={key:0,class:"flex h-64 items-center justify-center"},pe={class:"text-muted-foreground flex items-center gap-2"},me={key:1,class:"flex h-full min-h-0 flex-1 flex-col"},ve={class:"flex border-b"},be=["onClick"],fe={class:"flex-1 overflow-auto p-4"},Ce=M({__name:"publish",setup(he){const U=_(()=>y(()=>import("./zN4c5UZi.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]),import.meta.url)),$=_(()=>y(()=>import("./D5RgyGfN.js"),__vite__mapDeps([13,1,3,4,5,6,7,8,9,10,11,14,15]),import.meta.url)),K=_(()=>y(()=>import("./DqG-kozZ.js"),__vite__mapDeps([16,1,2,17,18,19,20]),import.meta.url)),V=_(()=>y(()=>import("./sOcWbrx-.js"),__vite__mapDeps([21,1,12,2,3,4,5,6,7,8,9,10,11,22,18]),import.meta.url)),{params:z}=q(),n=A(()=>z.id),k=F(),{t:r}=G(),x=m(!1),u=m(!1),a=m(),f=m("status"),h=m([{value:"status",label:r("ai-agent.backend.publish.status"),icon:"i-lucide-globe",component:v(V)},{value:"settings",label:r("ai-agent.backend.publish.settings"),icon:"i-lucide-settings",component:v(K)},{value:"embed",label:r("ai-agent.backend.publish.embed"),icon:"i-lucide-code",component:v($)},{value:"api",label:r("ai-agent.backend.publish.api"),icon:"i-lucide-terminal",component:v(U)}]),R=I("ai-agent:publish:tabs").value.map(e=>({value:e.meta?.value,label:r(e.meta?.label),icon:e.meta?.icon,component:v(e.component)}));console.log(R,I("ai-agent:publish:tabs")),h.value=[...h.value,...R];const E=A(()=>h.value.find(e=>e.value===f.value)?.component),g=H({allowOrigins:[],rateLimitPerMinute:60,showBranding:!0,allowDownloadHistory:!1}),L=async()=>{if(n.value)try{x.value=!0;const e=await ae(n.value);a.value=e,e.publishConfig&&Object.assign(g,e.publishConfig)}catch(e){console.error("加载智能体信息失败:",e)}finally{x.value=!1}},O=async()=>{if(n.value)try{u.value=!0;const e={publishConfig:{...g}},C=await ne(n.value,e);a.value&&(a.value.isPublished=!0,a.value.publishToken=C.publishToken,a.value.apiKey=C.apiKey,a.value.publishConfig=g),k.success("智能体发布成功！"),f.value="status"}catch(e){console.error("发布智能体失败:",e)}finally{u.value=!1}},B=async()=>{if(n.value)try{u.value=!0,await se(n.value),a.value&&(a.value.isPublished=!1,a.value.publishToken=void 0,a.value.apiKey=void 0,a.value.publishConfig=void 0),k.success("已取消发布")}catch(e){console.error("取消发布智能体失败:",e)}finally{u.value=!1}},j=async()=>{if(n.value)try{const e=await te(n.value);a.value&&(a.value.apiKey=e.apiKey),k.success("API密钥重新生成成功")}catch(e){console.error("重新生成API密钥失败:",e)}},N=e=>{Object.assign(g,e)},S=A(()=>a.value?.isPublished||!1);return J(()=>L()),(e,C)=>{const d=Q,P=W;return l(),c("div",le,[s("div",ie,[s("div",oe,[s("div",null,[s("h1",ue,i(e.$t("ai-agent.backend.publish.title")),1),s("p",ce,i(e.$t("ai-agent.backend.publish.desc")),1)]),s("div",re,[t(S)?(l(),c(D,{key:1},[o(P,{variant:"outline",onClick:j},{default:w(()=>[o(d,{name:"i-lucide-refresh-cw",class:"mr-2 size-4"}),b(" "+i(e.$t("ai-agent.backend.publish.regenerateApiKey")),1)]),_:1}),o(P,{color:"error",variant:"outline",loading:t(u),onClick:B},{default:w(()=>[o(d,{name:"i-lucide-globe-lock",class:"mr-2 size-4"}),b(" "+i(e.$t("ai-agent.backend.publish.unpublish")),1)]),_:1},8,["loading"])],64)):(l(),T(P,{key:0,loading:t(u),onClick:O},{default:w(()=>[o(d,{name:"i-lucide-globe",class:"mr-2 size-4"}),b(" "+i(e.$t("ai-agent.backend.publish.publish")),1)]),_:1},8,["loading"]))])])]),t(x)?(l(),c("div",de,[s("div",pe,[o(d,{name:"i-lucide-loader-2",class:"size-4 animate-spin"}),b(" "+i(e.$t("ai-agent.backend.publish.loading")),1)])])):(l(),c("div",me,[s("div",ve,[(l(!0),c(D,null,X(t(h),p=>(l(),c("button",{key:p.value,class:Y(["flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors",t(f)===p.value?"border-primary text-primary border-b-2":"text-muted-foreground hover:text-foreground"]),onClick:ge=>f.value=p.value},[o(d,{name:p.icon,class:"size-4"},null,8,["name"]),b(" "+i(p.label),1)],10,be))),128))]),s("div",fe,[t(E)?(l(),T(ee(t(E)),{key:0,agent:t(a),onUpdate:N},null,40,["agent"])):Z("",!0)])]))])}}});export{Ce as default};
