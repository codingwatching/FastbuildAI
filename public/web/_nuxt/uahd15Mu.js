import{d as k,e as B,ap as K,ar as R,g as A,au as L,i as M,j as D,c as F,o as T,t as p,m as c,q as e,l as f,_ as I,y as N,x as d,h as l,D as j}from"#entry";import{_ as q}from"./DyTskiS5.js";import E from"./CDSfhndf.js";import{_ as G}from"./12pJH7Js.js";import{_ as H}from"./Bjbrn0__.js";import{_ as J}from"./CEOm-hjj.js";import{_ as O}from"./4yDHJZoY.js";import{u as _}from"./Dx01Lm3C.js";import{a as Q,e as W,f as X}from"./X9J3EvZk.js";import{u as Y}from"./zDgZcZqa.js";import{u as Z}from"./C1xCp5oe.js";import{u as ee}from"./DcxZIiHI.js";import"./DoL5-2Ox.js";import"./DVSiT9pd.js";import"./D_1uxSdv.js";import"./CXk2IlXx.js";import"./DBwQYu6J.js";import"./Ti3HjCpC.js";import"./CyS2mNdj.js";import"./BaKvIqXP.js";import"./B1TeSxwV.js";import"./BstbYvQo.js";import"./DegKy-XA.js";import"./DhlnS5e0.js";import"./DlAUqK2U.js";const se={class:"role-list-container pb-5"},oe={class:"bg-background sticky top-0 z-10 flex flex-wrap gap-4 pb-4"},le={class:"flex items-end gap-2 md:ml-auto"},te={class:"mt-auto flex items-center justify-between gap-3 pt-4"},ae={class:"text-muted text-sm"},re={class:"flex items-center gap-1.5"},Re=k({__name:"list",setup(ie){const u=I,y=q,C=j,{t:o}=B(),w=K(),v=R(),{hasAccessByCodes:g}=Y(),b=A("table"),m=L({name:"",status:void 0}),{paging:r,getLists:n}=Z({fetchFun:Q,params:m}),a=M(()=>({level:o("membership.console-membership.level.table.level"),icon:o("membership.console-membership.level.table.icon"),name:o("membership.console-membership.level.table.name"),description:o("membership.console-membership.level.table.description"),givePower:o("membership.console-membership.level.table.givePower"),accountCount:o("membership.console-membership.level.table.accountCount"),status:o("membership.console-membership.level.table.status"),actions:o("membership.console-membership.level.table.actions")})),x=[{accessorKey:"level",header:()=>l("p",{class:""},`${a.value.level}`),cell:({row:s})=>l("p",{class:""},s.original.level+"级")},{accessorKey:"icon",header:()=>l("p",{class:""},`${a.value.icon}`),cell:({row:s})=>l(C,{src:s.original.icon,alt:s.original.name,ui:{root:"rounded-sm"}})},{accessorKey:"name",header:()=>l("p",{class:""},`${a.value.name}`),cell:({row:s})=>l("p",{class:""},s.original.name)},{accessorKey:"description",header:()=>l("p",{class:""},`${a.value.description}`),cell:({row:s})=>l("p",{class:""},s.original.description)},{accessorKey:"givePower",header:()=>l("p",{class:""},`${a.value.givePower}`),cell:({row:s})=>l("p",{class:""},s.original.givePower)},{accessorKey:"accountCount",header:()=>l("p",{class:""},`${a.value.accountCount}`)},{accessorKey:"status",header:()=>l("p",{class:""},`${a.value.status}`),cell:({row:s})=>l(y,{modelValue:s.original.status,size:"sm","onUpdate:modelValue":t=>{U(s.original.id,t)}})},{id:"actions",header:()=>l("p",{class:""},`${a.value.actions}`),size:40,enableSorting:!1,enableHiding:!1,cell:({row:s})=>l("div",{class:"flex items-center gap-1"},[g(["level:update"])?l(u,{icon:"i-lucide-pen-line",color:"primary",variant:"ghost",size:"xs",label:o("console-common.edit"),onClick:()=>{v.push({path:_("levels:update"),query:{id:s.original.id}})}}):null,g(["level:delete"])?l(u,{icon:"i-lucide-trash",color:"error",variant:"ghost",size:"xs",label:o("console-common.delete"),onClick:()=>{$(s.original.id)}}):null].filter(Boolean))}],$=async s=>{try{await ee({title:o("membership.console-membership.level.deleteTitle"),description:o("membership.console-membership.level.deleteMsg"),color:"error"}),await W(s),n()}catch(t){console.error("删除失败:",t)}},U=async(s,t)=>{try{await X(s,{status:t}),n(),w.success(o("membership.console-membership.level.updateStatusSuccess"))}catch(h){console.error("更新状态失败:",h)}};return D(()=>n()),(s,t)=>{const h=E,S=G,V=H,z=J,P=O;return T(),F("div",se,[p("div",oe,[c(h,{modelValue:e(m).name,"onUpdate:modelValue":t[0]||(t[0]=i=>e(m).name=i),placeholder:e(o)("membership.console-membership.level.nameInput"),class:"w-48",onChange:e(n)},null,8,["modelValue","placeholder","onChange"]),c(S,{modelValue:e(m).status,"onUpdate:modelValue":t[1]||(t[1]=i=>e(m).status=i),placeholder:e(o)("membership.console-membership.level.status"),items:[{label:e(o)("membership.console-membership.level.select.all"),value:void 0},{label:e(o)("membership.console-membership.level.select.active"),value:!0},{label:e(o)("membership.console-membership.level.select.inactive"),value:!1}],class:"w-48",onChange:e(n)},null,8,["modelValue","placeholder","items","onChange"]),p("div",le,[c(V,{codes:["level:create"]},{default:f(()=>[c(e(u),{icon:"i-heroicons-plus",color:"primary",onClick:t[2]||(t[2]=()=>{e(v).push({path:("useRoutePath"in s?s.useRoutePath:e(_))("levels:create")})})},{default:f(()=>[N(d(e(o)("membership.console-membership.level.add")),1)]),_:1})]),_:1})])]),c(z,{loading:e(r).loading,data:e(r).items,columns:x,class:"h-[calc(100vh-13rem)] shrink-0",ref_key:"table",ref:b,selectable:"",ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default"}},null,8,["loading","data"]),p("div",te,[p("div",ae,d(e(b)?.tableApi?.getFilteredSelectedRowModel().rows.length||0)+" / "+d(e(b)?.tableApi?.getFilteredRowModel().rows.length||0)+" "+d(e(o)("console-common.selected"))+". ",1),p("div",re,[c(P,{page:e(r).page,"onUpdate:page":t[3]||(t[3]=i=>e(r).page=i),size:e(r).pageSize,"onUpdate:size":t[4]||(t[4]=i=>e(r).pageSize=i),total:e(r).total,onChange:e(n)},null,8,["page","size","total","onChange"])])])])}}});export{Re as default};
