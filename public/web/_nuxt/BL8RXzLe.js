const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CPcZ54S1.js","./HM4rJu8H.js","./uRcAPhod.js","./YfZ7Zw0-.js","./CH6zLhsh.js","./PUaae8Vl.js","./B2mx0Z2E.js","./DuSMYVIA.js","./MN31c9CG.js","./BR1ou68O.js","./BvGrPIC1.js","./F_w94AAe.js","./Dgbe_zC5.js","./XBYuZpdu.js","./BUbjJ06P.js","./AwTBxaf_.js","./AkfmfxUv.js","./BgHJjJs-.js","./CvQTAktg.js","./BdImEx5p.js","./oFTPHjuc.js","./BcsO9TDZ.js","./DlAUqK2U.js","./BoUSUkpo.js","./CNWUrYsy.js","./DHFmmngs.js","./CR1AS2Ry.js","./CuOaO1Pb.js","./D6yWePie.js","./BHhI-3jl.js","./DVnbt8cp.js","./BKvD-c7Q.js","./g_UzmQET.js","./CgMDXot0.js","./DP8wpnmM.js","./BtIvDPex.js","./CgvJPw28.js","./fQGamG-_.js","./Cb04SOqd.js","./VGKgjfSv.js","./BUyfW8JT.js","./DaWZu8wl.js"])))=>i.map(i=>d[i]);
import{d as le,b as ie,Q as re,ap as ce,s as de,aL as me,g as pe,au as C,aJ as ue,i as ge,c as w,o as i,q as n,l as r,p as e,A as fe,H as _e,k as f,x as he,v as E,_ as be,F as V,B,br as ve,j as u,t as _,C as ye,y as xe,bE as we,R as T,U as L}from"#entry";import{_ as Ee}from"./CWOiVw6z.js";import ke from"./AwTBxaf_.js";import{_ as Ie}from"./BumU5Y7p.js";import{_ as Te}from"./Dgbe_zC5.js";import{_ as Le}from"./DdBswP62.js";import{_ as Ae}from"./BTkcJ0P0.js";import{_ as Ne}from"./BmZ7kpZN.js";import{_ as Ue}from"./Bshy66Rp.js";import{a as A,b as h,E as g}from"./XBYuZpdu.js";import{g as De,h as $e,i as Ce,j as Ve,k as Be,l as Se}from"./BvGrPIC1.js";import{u as Me}from"./DkncK-NE.js";import"./DHFmmngs.js";import"./DuSMYVIA.js";import"./CuOaO1Pb.js";import"./D6yWePie.js";import"./DVnbt8cp.js";import"./CR1AS2Ry.js";import"./Btvd554H.js";import"./B2mx0Z2E.js";import"./B-DdbQ-X.js";import"./V9POJiZu.js";import"./MN31c9CG.js";import"./BstbYvQo.js";import"./3UOIlTK8.js";import"./8trvJunN.js";import"./VGKgjfSv.js";import"./XzHi4Tl0.js";import"./kRIii9yh.js";import"./C6Y-ieo6.js";import"./BcsO9TDZ.js";import"./DlAUqK2U.js";const Pe={class:"extension-manage-container flex h-full flex-col pb-5"},Oe={class:"header bg-background sticky top-0 z-10 pb-6"},Re={class:"space-y-4"},ze={class:"flex w-full flex-wrap justify-between gap-4"},Fe={class:"flex items-end justify-end"},je={class:"flex items-center gap-4"},We={class:"grid h-[calc(100vh-12rem)]"},He={class:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},Xe={class:"flex h-full w-full cursor-pointer flex-col gap-3.5 p-4"},qe={class:"flex justify-between"},Ge={class:"flex w-[calc(100%-76px)] flex-col gap-1"},Je={class:"flex items-center gap-1"},Qe={class:"text-foreground truncate text-[16px] leading-[22px] font-[500]"},Ke={class:"text-muted-foreground line-clamp-2 text-[14px] leading-[20px] font-normal wrap-break-word"},Ye={class:"ml-[12px] h-[64px] w-[64px] flex-none overflow-hidden rounded-[10px]"},Ze={class:"flex items-center gap-2"},ea={class:"flex items-center gap-1 text-xs"},aa={class:"text-nowrap"},sa={class:"bg-background absolute right-3 bottom-3 flex gap-2"},Sa=le({__name:"list",setup(oa){const S=T(()=>L(()=>import("./CPcZ54S1.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]),import.meta.url)),M=T(()=>L(()=>import("./F_w94AAe.js"),__vite__mapDeps([11,1,12,2,3,4,5,6,7,8,9,13,10]),import.meta.url)),P=T(()=>L(()=>import("./BUbjJ06P.js"),__vite__mapDeps([14,15,1,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,7,31,32,33,34,35,36,5,6,8,37,4,38,39,13,10,40,41]),import.meta.url)),{t:o}=ie(),k=re(),c=ce(),O=[{label:o("extensions.manage.tabs.all"),value:"all"},{label:o("extensions.manage.tabs.installed"),value:"installed"},{label:o("extensions.manage.tabs.uninstalled"),value:"uninstalled"}],b=de("all"),p=me({type:void 0}),R=a=>({[g.WEB]:o("extensions.modal.terminalTypes.web"),[g.WEIXIN]:o("extensions.modal.terminalTypes.weixin"),[g.H5]:o("extensions.modal.terminalTypes.h5"),[g.MP]:o("extensions.modal.terminalTypes.mp"),[g.API]:o("extensions.modal.terminalTypes.api")})[a]||o("extensions.manage.unknown"),{paging:l,getLists:d}=Me({fetchFun:De,params:p}),z=pe(()=>l.items.length<l.total),F=()=>{l.loading||(l.page++,d({append:!0}))},j=_e(()=>{l.page=1,d()},500),W=a=>{b.value=String(a);const t=b.value;t==="all"?delete p.isInstalled:p.isInstalled=t==="installed",l.page=1,d()},H=a=>{console.log("handleNavigate",a),window.open(`${we.EXTENSIONS}/${a.identifier}/buildingai-middleware`,"_self")},y=C({}),x=C({}),X=async a=>{if(!y[a.identifier])try{y[a.identifier]=!0,await Be(a.identifier),l.page=1,await d(),c.success(o("console-common.messages.success"))}catch(t){console.error("安装插件失败:",t),c.error(o("console-common.messages.failed"))}finally{y[a.identifier]=!1}},q=async a=>{if(!x[a.identifier])try{x[a.identifier]=!0,await Se(a.identifier),l.page=1,await d(),c.success(o("console-common.messages.success"))}catch(t){console.error("更新插件失败:",t),c.error(o("console-common.messages.failed"))}finally{x[a.identifier]=!1}},{lockFn:G}=ue(async a=>{try{await Ve(a.identifier),l.page=1,await d(),c.success(o("console-common.messages.success"))}catch(t){console.error("卸载插件失败:",t),c.error(o("console-common.messages.failed"))}}),J=async a=>{try{await $e(a.id),l.page=1,await d(),c.success(o("console-common.messages.success"))}catch(t){console.error("启用插件失败:",t),c.error(o("console-common.messages.failed"))}},Q=async a=>{try{await Ce(a.id),l.page=1,await d(),c.success(o("console-common.messages.success"))}catch(t){console.error("禁用插件失败:",t),c.error(o("console-common.messages.failed"))}},N=async(a,t)=>{await k.create(P).open({isEdit:t,id:a.id,initialData:{name:a.name,packName:a.identifier,description:a.description,version:a.version,icon:a.icon,type:a.type,supportTerminal:a.supportTerminal||[],author:a.author||{avatar:"",name:"",homepage:""}}}).result&&(l.page=1,d())},K=a=>{k.create(M).open({isIdentifier:a.isLocal,extensionId:a.id,identifier:a.identifier})},Y=a=>{k.create(S).open({extension:a,identifier:a.identifier})};return ge(()=>d()),(a,t)=>{const U=Ee,D=ke,$=Ie,v=be,Z=ve,I=Te,ee=xe,ae=ye,se=Le,oe=Ae,te=Ne,ne=Ue;return i(),w("div",Pe,[n("div",Oe,[n("div",Re,[n("div",ze,[n("div",Fe,[r(U,{items:O,modelValue:e(b),"onUpdate:modelValue":[t[0]||(t[0]=s=>fe(b)?b.value=s:null),W],class:"block w-auto"},null,8,["modelValue"])]),n("div",je,[r(D,{modelValue:e(p).name,"onUpdate:modelValue":[t[1]||(t[1]=s=>e(p).name=s),e(j)],placeholder:e(o)("extensions.manage.search")},null,8,["modelValue","placeholder","onUpdate:modelValue"]),r($,{modelValue:e(p).type,"onUpdate:modelValue":t[2]||(t[2]=s=>e(p).type=s),items:[{label:e(o)("extensions.manage.filters.allTypes"),value:void 0},{label:e(o)("extensions.modal.extensionTypes.application"),value:e(A).APPLICATION},{label:e(o)("extensions.modal.extensionTypes.function"),value:e(A).FUNCTIONAL}],class:"block w-auto",placeholder:e(o)("extensions.manage.selectType")},null,8,["modelValue","items","placeholder"]),r(v,{icon:"i-lucide-plus",color:"primary",onClick:t[3]||(t[3]=s=>N({},!1))},{default:f(()=>[he(E(e(o)("extensions.manage.add")),1)]),_:1})])])])]),n("div",We,[r(ne,{class:"h-full",shadow:!1},{default:f(()=>[r(te,{loading:e(l).loading,"has-more":e(z),"loading-text":e(o)("extensions.manage.loadingText"),"no-more-text":e(l).page!==1?e(o)("extensions.manage.noMoreText"):" ",onLoadMore:F},{default:f(()=>[n("div",He,[(i(!0),w(V,null,B(e(l).items,s=>(i(),w("div",{key:s.id,class:"bg-background border-muted relative h-[170px] overflow-hidden rounded-[6px] border border-solid transition duration-150 ease-out hover:shadow-[0_6px_8px_0_rgba(28,31,35,6%)]"},[n("div",Xe,[n("div",qe,[n("div",Ge,[n("div",Je,[n("span",Qe,E(s.name),1)]),n("span",Ke,E(s.description||e(o)("extensions.manage.noDescription")),1)]),n("div",Ye,[r(Z,{src:s.icon,alt:s.name,class:"h-full w-full object-cover",loading:"lazy"},null,8,["src","alt"])])]),n("div",Ze,[s.version?(i(),u(I,{key:0,color:"neutral",variant:"soft",label:`v${s.version}`},null,8,["label"])):_("",!0),s.isInstalled?(i(),u(I,{key:1,color:s.status===e(h).ENABLED?"success":"neutral",variant:"soft",label:s.status===e(h).ENABLED?e(o)("extensions.manage.enable"):e(o)("extensions.manage.disable")},null,8,["color","label"])):_("",!0),(i(!0),w(V,null,B(s.supportTerminal,m=>(i(),u(I,{color:m===e(g).WEB?"success":m===e(g).API?"info":"neutral",variant:"soft",label:R(m)},null,8,["color","label"]))),256))]),n("div",ea,[r(ae,{color:"primary",size:"xs",src:s.author?.avatar,ui:{root:"rounded-full bg-primary size-5"}},{default:f(()=>[r(ee,{name:"i-lucide-user",class:"size-3 text-white"})]),_:1},8,["src"]),n("div",aa,E(s.author.name||e(o)("extensions.manage.unknownAuthor")),1)]),n("div",sa,[s.type===e(A).APPLICATION&&s.isInstalled?(i(),u(se,{key:0,text:e(o)("extensions.manage.manage")},{default:f(()=>[r(v,{color:"primary",variant:"ghost",size:"sm",label:e(o)("extensions.manage.manage"),onClick:m=>H(s)},null,8,["label","onClick"])]),_:2},1032,["text"])):_("",!0),s.isInstalled?_("",!0):(i(),u(v,{key:1,color:"primary",variant:"ghost",size:"sm",loading:e(y)[s.identifier],label:a.$t("extensions.manage.install"),onClick:m=>X(s)},null,8,["loading","label","onClick"])),s.hasUpdate?(i(),u(v,{key:2,color:"primary",variant:"ghost",size:"sm",loading:e(x)[s.identifier],label:a.$t("extensions.manage.upgrade"),onClick:m=>q(s)},null,8,["loading","label","onClick"])):_("",!0),s.isInstalled?(i(),u(oe,{key:3,items:[[{label:e(o)("extensions.manage.detail"),icon:"i-lucide-info",onSelect:()=>K(s)},{label:e(o)("extensions.manage.logs"),icon:"i-lucide-file-text",onSelect:()=>Y(s)}],[{label:s.status===e(h).ENABLED?e(o)("extensions.manage.disable"):e(o)("extensions.manage.enable"),icon:s.status===e(h).ENABLED?"i-lucide-power-off":"i-lucide-power",color:s.status===e(h).ENABLED?"warning":"success",onSelect:()=>{s.status===e(h).ENABLED?Q(s):J(s)}}],[s.isLocal?{label:e(o)("console-common.edit"),icon:"i-lucide-pen-line",onSelect:()=>N(s,!0)}:void 0,{label:e(o)("extensions.manage.uninstall"),icon:"i-lucide-trash-2",color:"error",onSelect:()=>{e(G)(s)}}].filter(m=>m!==void 0)],content:{align:"end",side:"bottom",sideOffset:4},ui:{content:"w-32"}},{default:f(()=>[r(v,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost",size:"sm"})]),_:1},8,["items"])):_("",!0)])])]))),128))])]),_:1},8,["loading","has-more","loading-text","no-more-text"])]),_:1})])])}}});export{Sa as default};
