const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CKjxn9BL.js","./Dgvg0_To.js","./T-IgMJKy.js","./CDSfhndf.js","./Brlt-NDg.js","./DoL5-2Ox.js","./BjYsydzc.js","./BodiR9AC.js","./B-p4_8pw.js","./CsY35JUW.js","./DBwQYu6J.js","./DnFVE45b.js","./DegKy-XA.js","./DSCppvl0.js","./7d3iyZ8h.js","./BNMwDuRp.js","./CvZB4bI9.js","./KiG0a5S-.js","./CXk2IlXx.js","./kRIii9yh.js","./B1TeSxwV.js","./C6Y-ieo6.js","./Ti3HjCpC.js","./CyS2mNdj.js","./BaKvIqXP.js","./cwT2REE1.js","./DaC7Nksz.js","./CR9qioUt.js","./BRI4D6WA.js","./DlAUqK2U.js","./DPwLTNIs.js","./B0g9CpkI.js","./CGkf3lDq.js","./3hxyl1z3.js","./DRV5AIQP.js","./xOPeKszj.js","./C1xCp5oe.js","./CIZXtYrT.js","./BzLCLO6P.js"])))=>i.map(i=>d[i]);
import{e as M,r as k,d as T,ap as U,ar as A,au as L,aK as V,j as B,c as _,o as S,t as u,m as p,q as e,_ as N,R as g,E as D,v as $,G as E,U as f,aL as K}from"#entry";import{u as I}from"./Dx01Lm3C.js";import{x as W,y as j,z}from"./DRV5AIQP.js";function F(h=1){const{t:r}=M(),l=[{id:1,title:r("ai-datasets.backend.create.step.one")},{id:2,title:r("ai-datasets.backend.create.step.two")},{id:3,title:r("ai-datasets.backend.create.step.three")}],o=k(h);return{step:o,STEPS:l,nextStep:()=>{o.value<l.length&&(o.value+=1)},changeStep:c=>{const d=o.value+c;d>=1&&d<=l.length&&(o.value=d)}}}const q={class:"create-dataset-container flex h-full flex-col"},G={class:"bg-background sticky top-0 z-10 flex"},H={class:"container mx-auto h-full pb-6"},J={class:"flex h-full min-h-0 w-full"},Q={class:"flex h-full min-h-0 w-full"},X={key:0,class:"flex h-full min-h-0 w-full"},te=T({__name:"index",props:{id:{},datasetsDetail:{}},setup(h){const r=g(()=>f(()=>import("./CKjxn9BL.js"),__vite__mapDeps([0,1]),import.meta.url)),l=g(()=>f(()=>import("./T-IgMJKy.js"),__vite__mapDeps([2,1,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url)),o=g(()=>f(()=>import("./3hxyl1z3.js"),__vite__mapDeps([33,1,27,28,29,34]),import.meta.url)),v=g(()=>f(()=>import("./xOPeKszj.js"),__vite__mapDeps([35,1,32,34,36,37,38]),import.meta.url)),i=h,c=U(),d=A(),{t:C}=M(),{step:m,STEPS:w,nextStep:b,changeStep:y}=F(),t=L({indexingConfig:{documentMode:"normal",parentContextMode:"paragraph",segmentation:{segmentIdentifier:"\\n\\n",maxSegmentLength:1024,segmentOverlap:50},subSegmentation:{segmentIdentifier:"\\n",maxSegmentLength:512},preprocessingRules:{replaceConsecutiveWhitespace:!1,removeUrlsAndEmails:!1},fileIds:[]},name:"",description:"",embeddingModelId:"",retrievalConfig:{retrievalMode:"hybrid",strategy:"weighted_score",topK:3,scoreThreshold:.5,scoreThresholdEnabled:!1,weightConfig:{semanticWeight:.7,keywordWeight:.3},rerankConfig:{enabled:!1,modelId:""}}}),x=k(i.id??""),{lockFn:O}=V(async()=>{try{if(i.id){const{indexingConfig:a}=t,n={indexingConfig:a,datasetId:i.id,embeddingModelId:t.embeddingModelId};await j(n),K(`dataset-detail-${i.id}`)}else{const a=await z(t);x.value=a.id}b()}catch(a){console.log("创建错误 => ",a)}}),P=async()=>{if(!t.name||!t.name.trim()){c.error(C("ai-datasets.backend.settings.nameInput"));return}if(!t.description||!t.description.trim()){c.error(C("ai-datasets.backend.settings.descriptionInput"));return}if(!t.embeddingModelId){c.error(C("ai-datasets.backend.settings.embeddingModelInput"));return}try{const a=await W({name:t.name,description:t.description,embeddingModelId:t.embeddingModelId});d.replace(I("ai-datasets-documents:list",{id:a.id}))}catch(a){console.error("创建空知识库失败",a)}};return B(()=>{if(!i.id&&!i.datasetsDetail?.id)return!1;const a=i.datasetsDetail;Reflect.ownKeys(t).forEach(n=>{a&&Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a?.[n]??t[n])}),t.indexingConfig.fileIds=[]}),(a,n)=>{const R=N;return S(),_("div",q,[u("div",G,[p(R,{class:"absolute top-1/2 -translate-y-[50%]",variant:"link",color:"neutral",label:a.$t("ai-datasets.backend.dataset.title"),"leading-icon":"i-lucide-chevron-left",onClick:n[0]||(n[0]=s=>e(d).replace(i.id?("useRoutePath"in a?a.useRoutePath:e(I))("ai-datasets-documents:list",{id:i.id}):("useRoutePath"in a?a.useRoutePath:e(I))("ai-datasets:list")))},null,8,["label"]),p(e(r),{steps:e(w),activeIndex:e(m)},null,8,["steps","activeIndex"])]),u("div",H,[D(u("div",J,[p(e(l),{fileIds:e(t).indexingConfig.fileIds,"onUpdate:fileIds":n[1]||(n[1]=s=>e(t).indexingConfig.fileIds=s),name:e(t).name,"onUpdate:name":n[2]||(n[2]=s=>e(t).name=s),description:e(t).description,"onUpdate:description":n[3]||(n[3]=s=>e(t).description=s),embeddingModelId:e(t).embeddingModelId,"onUpdate:embeddingModelId":n[4]||(n[4]=s=>e(t).embeddingModelId=s),disabled:!!i.id,onOnStepChange:e(b),onCreateEmpty:P},null,8,["fileIds","name","description","embeddingModelId","disabled","onOnStepChange"])],512),[[E,e(m)===1]]),D(u("div",Q,[p(e(o),{indexingConfig:e(t).indexingConfig,"onUpdate:indexingConfig":n[5]||(n[5]=s=>e(t).indexingConfig=s),retrievalConfig:e(t).retrievalConfig,"onUpdate:retrievalConfig":n[6]||(n[6]=s=>e(t).retrievalConfig=s),disabled:!!i.datasetsDetail?.documentCount,onOnStepChange:e(y),onOnCreate:e(O)},null,8,["indexingConfig","retrievalConfig","disabled","onOnStepChange","onOnCreate"])],512),[[E,e(m)===2]]),e(m)===3?(S(),_("div",X,[p(e(v),{datasetsId:e(x),createData:e(t),isAddDocument:!!i.id,fileIds:e(t).indexingConfig.fileIds},null,8,["datasetsId","createData","isAddDocument","fileIds"])])):$("",!0)])])}}});export{te as default};
