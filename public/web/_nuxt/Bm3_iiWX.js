import{d as N,g,aI as V,b as j,ap as z,aL as O,aJ as D,i as R,j as b,o as r,k as c,c as i,p as e,l as d,y as q,q as o,t as _,C as A,v as a,x as m,_ as G,F as J,B as H}from"#entry";import{_ as K}from"./Bx0Ksjg_.js";import{_ as P}from"./Cif_tCX1.js";import{_ as Q}from"./CXUt0j5Y.js";import{i as W,d as X,h as Y}from"./D9F45f3T.js";import"./Btvd554H.js";import"./3UOIlTK8.js";import"./DuSMYVIA.js";import"./DduSJdeS.js";import"./VGKgjfSv.js";import"./-Eb02sIQ.js";import"./Dk6FGhu1.js";import"./BPKB8n-W.js";import"./MN31c9CG.js";import"./CCcv9mzY.js";import"./BFAo_s2U.js";import"./Cb04SOqd.js";const Z={key:0,class:"flex items-center justify-center",style:{height:"400px"}},ee={key:1,class:"max-h-180"},te={class:"flex justify-between pb-4"},oe={class:"flex items-center gap-4"},ae={class:"text-secondary-foreground flex items-center text-base font-semibold"},se={class:"line-clamp-1"},ne={class:"bg-muted rounded-lg p-4 pb-4"},re={class:"text-muted-foreground text-xs"},ce={class:"grid grid-cols-1 gap-x-6 gap-y-4 py-4 pb-4 md:grid-cols-2"},ie={key:0},de={class:"text-muted-foreground text-sm"},me={class:"max-w-100"},le={class:"text-secondary-foreground mt-1 truncate font-medium"},ue={key:1},pe={class:"text-muted-foreground text-sm"},fe={class:"text-secondary-foreground mt-1 font-medium"},_e={class:"text-muted-foreground text-sm"},ye={class:"text-secondary-foreground mt-1 font-medium"},xe={class:"text-muted-foreground text-sm"},ve={class:"text-secondary-foreground mt-1 font-medium"},he={class:"text-muted-foreground text-sm"},ge={class:"text-secondary-foreground mt-1 font-medium"},De={class:"text-muted-foreground text-sm"},be={key:0,class:"text-error mt-1 text-sm font-medium"},ke={key:1,class:"mt-1 text-sm font-medium"},we={key:0,class:"pb-4"},Se={class:"text-secondary-foreground mb-2 text-base font-medium"},Te={class:"max-h-80 space-y-2 overflow-y-auto"},Be={class:"text-secondary-foreground font-medium"},Ce={class:"text-muted-foreground mt-1 text-sm"},He=N({__name:"mcp-server-detail",props:{id:{},isView:{type:Boolean},isJsonImport:{type:Boolean},isSystemMcp:{type:Boolean}},emits:["close"],setup(k,{emit:w}){const y=k,S=w,l=g(()=>y.id||T.query.id||null),{t:s}=j(),x=z(),T=V(),t=O({reconnecting:!1,formData:{mcpServerId:"",name:"",description:"",icon:"",type:"user",providerName:"",url:"",sortOrder:0,isDisabled:!1,creatorId:"",connectError:"",connectable:!1,tools:[],isShow:!1,isAssociated:!1,communicationType:""}}),{lockFn:v,isLock:B}=D(async()=>{try{let n;y.isSystemMcp?n=await W(l.value):n=await X(l.value),Object.assign(t.formData,n)}catch(n){console.error("获取供应商详情失败:",n)}}),{lockFn:C,isLock:M}=D(async()=>{try{const n=await Y(l.value);n.connectable?(x.success(n.message),v(),t.reconnecting=!0):x.error(n.message)}catch(n){console.error("重新链接失败:",n)}}),I=g(()=>t.formData.communicationType?t.formData.communicationType.includes("-")?t.formData.communicationType.replace("-"," ").toUpperCase():t.formData.communicationType?.toUpperCase():"");return R(async()=>l.value&&await v()),(n,u)=>{const $=q,L=A,h=K,p=P,U=G,F=Q;return r(),b(F,{title:e(s)("ai-mcp.backend.detailTitle"),description:e(s)("ai-mcp.backend.detailTitle"),ui:{content:"max-w-2xl overflow-y-auto h-fit"},onClose:u[1]||(u[1]=f=>S("close",e(t).reconnecting))},{default:c(()=>[e(B)?(r(),i("div",Z,[d($,{name:"i-lucide-loader-2",class:"size-8 animate-spin"})])):(r(),i("div",ee,[o("div",te,[o("div",oe,[d(L,{src:e(t).formData.icon,alt:e(t).formData.name,size:"3xl",ui:{root:"rounded-lg"}},null,8,["src","alt"]),o("div",null,[o("h3",ae,[d(h,{text:e(t).formData.name,delay:0},{default:c(()=>[o("span",se,a(e(t).formData.name),1)]),_:1},8,["text"])]),d(p,{color:e(t).formData.type==="user"?"info":"primary"},{default:c(()=>[m(a(e(t).formData.type==="user"?e(s)("ai-mcp.frontend.detail.custom"):e(s)("ai-mcp.frontend.detail.system")),1)]),_:1},8,["color"])])]),!e(t).formData.connectable&&e(t).formData.type==="user"?(r(),b(U,{key:0,class:"h-fit",loading:e(M),icon:"tabler:reload",ui:{leadingIcon:"size-4"},variant:"soft",size:"md",color:"error",onClick:u[0]||(u[0]=f=>e(C)())},{default:c(()=>[m(a(e(s)("ai-mcp.backend.detail.reconnect")),1)]),_:1},8,["loading"])):_("",!0)]),o("div",ne,[o("p",re,a(e(t).formData.description||e(s)("ai-mcp.frontend.detail.noDescription")),1)]),o("div",ce,[e(t).formData.type==="user"?(r(),i("div",ie,[o("div",de,a(e(s)("ai-mcp.frontend.detail.url")),1),d(h,{text:e(t).formData.url,ui:{content:"max-w-100 !whitespace-pre-wrap break-all leading-relaxed h-fit p-2"},"delay-duration":0},{content:c(()=>[o("div",me,a(e(t).formData.url),1)]),default:c(()=>[o("div",le,a(e(t).formData.url),1)]),_:1},8,["text"])])):_("",!0),y.isSystemMcp?_("",!0):(r(),i("div",ue,[o("div",pe,a(e(s)("ai-mcp.frontend.detail.status")),1),o("div",fe,[d(p,{color:e(t).formData.isDisabled?"warning":"success"},{default:c(()=>[m(a(e(t).formData.isDisabled?e(s)("ai-mcp.frontend.detail.disabled"):e(s)("ai-mcp.frontend.detail.enabled")),1)]),_:1},8,["color"])])])),o("div",null,[o("div",_e,a(e(s)("ai-mcp.frontend.detail.sortOrder")),1),o("div",ye,a(e(t).formData.sortOrder),1)]),o("div",null,[o("div",xe,a(e(s)("ai-mcp.backend.detail.connectStatus")),1),o("div",ve,[d(p,{color:e(t).formData.connectable?"success":"error"},{default:c(()=>[m(a(e(t).formData.connectable?e(s)("ai-mcp.backend.detail.connectSuccess"):e(s)("ai-mcp.backend.detail.connectFailed")),1)]),_:1},8,["color"])])]),o("div",null,[o("div",he,a(e(s)("ai-mcp.backend.detail.communicationType")),1),o("div",ge,[d(p,{color:"neutral",variant:"soft"},{default:c(()=>[m(a(e(I)),1)]),_:1})])]),o("div",null,[o("div",De,a(e(s)("ai-mcp.backend.detail.connectError")),1),e(t).formData.connectError?(r(),i("div",be,a(e(t).formData.connectError),1)):(r(),i("div",ke,"-"))])]),e(t).formData.tools&&e(t).formData.tools.length>0?(r(),i("div",we,[o("h4",Se,a(e(s)("ai-mcp.backend.detail.tools")),1),o("div",Te,[(r(!0),i(J,null,H(e(t).formData.tools,(f,E)=>(r(),i("div",{key:E,class:"border-muted rounded-lg border p-4"},[o("div",Be,a(f.name),1),o("div",Ce,a(f.description),1)]))),128))])])):_("",!0)]))]),_:1},8,["title","description"])}}});export{He as default};
