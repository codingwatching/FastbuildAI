const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CYBb01SL.js","./n4aLOYdS.js","./DUJH4dqr.js","./cd55qm53.js","./DWy_CFG9.js","./td2xDKru.js","./RPflLnqr.js","./TrJvDfxI.js","./jsPNKUA0.js","./Bzv9SrOl.js","./bvMLy1sv.js","./D9sX2Qi6.js","./CAQVAH0V.js","./Deu6qIfg.js","./D_3bTjYR.js","./BpHgfaGD.js","./2uNW2Gs5.js","./DxD6Ynfo.js","./CuVAPZQ8.js","./zlMhJk0P.js","./CZX-O16F.js","./CtosDvS0.js","./kRIii9yh.js","./D4e4FYoF.js","./CMKSl-Ng.js","./BhB8DUPm.js","./shdu-Ndv.js","./Iv8N83fp.js","./CBP5wIdr.js","./DeCyaT7k.js","./BstbYvQo.js","./DvKR6pUC.js","./BKdtdX-7.js","./C6Y-ieo6.js","./BCcN9pii.js","./psimjGaX.js","./Be9qZ8Md.js","./BkF8DltG.js","./MCK2d4XT.js","./EK7Wbu3-.js","./BtLy_Oaq.js","./C_EXknkZ.js","./FTderXKt.js","./DaWZu8wl.js"])))=>i.map(i=>d[i]);
import{d as w,i as x,aM as C,av as D,at as R,n as B,l as I,aN as F,q as L,c as b,o as u,x as m,f as S,t as _,w as $,B as E,z as k,g as t,_ as T,W as z,X as M,bP as N,bQ as P}from"#entry";import{g as V}from"./C_EXknkZ.js";const j={class:"user-edit-container"},q={class:"bg-background sticky top-0 z-10 mb-4 flex w-full items-center justify-baseline pb-2"},G={class:"text-base font-medium"},O={class:"ml-4 text-xl font-bold"},Q={key:0,class:"flex justify-center py-12"},K=w({__name:"edit",setup(W){const g=z(()=>M(()=>import("./CYBb01SL.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43]),import.meta.url)),{t:o}=x(),h=C(),a=D(),n=R(),r=B(()=>h.query.id),p=I({}),{lockFn:f,isLock:v}=F(async()=>{if(!r.value){n.error(o("user.backend.messages.missingUserId")),a.back();return}try{const{id:e,createdAt:s,updatedAt:i,lastLoginAt:l,role:d,...c}=await N(r.value);c.phone||(c.phoneAreaCode=V()),p.value={...c,roleId:d?.id||void 0}}catch(e){console.error("Get user detail failed:",e),n.error(o("user.backend.messages.getUserDetailFailed")),a.back()}}),y=async e=>{try{const{username:s,password:i,isRoot:l,totalRechargeAmount:d,level:c,levelEndTime:X,...U}=e;await P(r.value,U),n.success(o("user.backend.messages.updateSuccess")),setTimeout(()=>a.back(),1e3)}catch(s){console.error("Update user failed:",s),n.error(o("user.backend.messages.updateFailed"))}},A=()=>{a.back()};return L(()=>f()),(e,s)=>{const i=E,l=T;return u(),b("div",j,[m("div",q,[_(l,{color:"neutral",variant:"soft",onClick:s[0]||(s[0]=d=>t(a).back())},{default:$(()=>[_(i,{name:"i-lucide-arrow-left",class:"size-5 cursor-pointer"}),m("span",G,k(e.$t("console-common.back")),1)]),_:1}),m("h1",O,k(e.$t("user.backend.editTitle")),1)]),t(v)?(u(),b("div",Q,[_(i,{name:"i-lucide-loader-2",class:"text-primary-500 h-8 w-8 animate-spin"})])):(u(),S(t(g),{key:1,"is-edit":!0,id:t(r),"initial-data":t(p),onRefresh:t(f),onSubmitSuccess:y,onCancel:A},null,8,["id","initial-data","onRefresh"]))])}}});export{K as default};
