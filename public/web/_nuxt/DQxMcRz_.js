import q from"./CDSfhndf.js";import{_ as B}from"./Brlt-NDg.js";import z from"./BjYsydzc.js";import{_ as F}from"./ilPiIi3f.js";import{d as R,e as C,ap as N,au as S,aK as T,k as D,o as I,l as n,m as a,t as v,q as o,x as d,_ as j,y as f}from"#entry";import{_ as A}from"./Ds48qA85.js";import{_ as K}from"./BYm23QKU.js";import{E as L}from"./XBYuZpdu.js";import{a as M,b as Z}from"./BdGqAD-s.js";import{c as O,a as _}from"./BUyfW8JT.js";import"./DoL5-2Ox.js";import"./CjOovgR0.js";import"./DXP7Kkdt.js";import"./BRI4D6WA.js";import"./DlAUqK2U.js";import"./DGUAW_1C.js";import"./DDJ79SjH.js";import"./Ti3HjCpC.js";import"./DegKy-XA.js";import"./B1TeSxwV.js";import"./RmzZBBRE.js";import"./C4jlvBh2.js";import"./C-XPfH0G.js";import"./7d3iyZ8h.js";import"./DaWZu8wl.js";const W={class:"text-xs"},G={class:"flex justify-end gap-4 pt-8"},ye=R({__name:"extension-edit",props:{isEdit:{type:Boolean,default:!1},id:{default:null},initialData:{default:()=>({})}},emits:["close"],setup(g,{emit:y}){const c=y,l=g,{t}=C(),m=N(),e=S({name:"",icon:"",packName:"",description:"",version:"",type:1,alias:"",supportTerminal:[],author:{avatar:"",name:"",homepage:""},...l.initialData}),b=O({name:_().required(t("extensions.develop.form.nameRequired")),packName:_().required(t("extensions.develop.form.keyRequired")).matches(/^[a-zA-Z][a-zA-Z0-9_-]*$/,t("extensions.develop.form.keyFormat")),description:_().required(t("extensions.develop.form.descriptionRequired"))}),V=()=>{Object.keys(e).forEach(i=>{const s=i;typeof e[s]=="string"&&(e[s]="")}),e.type=1,e.supportTerminal=[L.WEB],m.info(t("extensions.develop.messages.formReset"))},{isLock:k,lockFn:$}=T(async()=>{try{const i={name:e.name,identifier:e.packName,description:e.description,version:e.version,icon:e.icon,author:e.author||{avatar:"",name:"",homepage:""},type:e.type,alias:e.alias,status:1,supportTerminal:e.supportTerminal.map(s=>Number(s))};return l.isEdit&&l.id?(await M(l.id.toString(),i),m.success(t("extensions.develop.messages.updateSuccess"))):(await Z(i),m.success(t("extensions.develop.messages.createSuccess"))),c("close",!0),!0}catch(i){return console.error("Failed to submit form:",i),m.error(t("extensions.develop.messages.submitError")),!1}});return(i,s)=>{const x=q,p=B,E=z,h=F,u=j,w=A,U=K;return I(),D(U,{title:i.$t("extensions.modal.editExtension"),description:i.$t("extensions.modal.addExtensionDescription"),ui:{content:"max-w-xl"},onClose:s[5]||(s[5]=r=>c("close",!1))},{default:n(()=>[a(w,{ref:"formRef",state:o(e),schema:o(b),class:"w-full space-y-2",onSubmit:o($)},{default:n(()=>[a(p,{label:o(t)("extensions.develop.form.name"),required:"",name:"name"},{default:n(()=>[a(x,{modelValue:o(e).name,"onUpdate:modelValue":s[0]||(s[0]=r=>o(e).name=r),variant:"subtle",readonly:"",placeholder:o(t)("extensions.develop.form.nameInput"),size:"lg",ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(p,{label:"显示名称",name:"alias"},{default:n(()=>[a(x,{modelValue:o(e).alias,"onUpdate:modelValue":s[1]||(s[1]=r=>o(e).alias=r),placeholder:"请输入显示名称",size:"lg",ui:{root:"w-full"}},null,8,["modelValue"])]),_:1}),a(p,{label:o(t)("extensions.develop.form.description"),required:"",name:"description"},{default:n(()=>[a(E,{modelValue:o(e).description,"onUpdate:modelValue":s[2]||(s[2]=r=>o(e).description=r),placeholder:o(t)("extensions.develop.form.descriptionInput"),readonly:"",size:"lg",rows:2,ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(p,{label:o(t)("extensions.develop.form.icon"),required:"",name:"icon"},{help:n(()=>[v("span",W,d(o(t)("extensions.develop.form.iconRecommendation")),1)]),default:n(()=>[a(h,{showReplaceButton:!1,showRemoveButton:!1,modelValue:o(e).icon,"onUpdate:modelValue":s[3]||(s[3]=r=>o(e).icon=r),class:"size-20",text:o(t)("extensions.develop.form.addIcon"),icon:"i-lucide-upload",accept:".jpg,.png,.jpeg,.gif",maxCount:1,single:!0},null,8,["modelValue","text"])]),_:1},8,["label"]),v("div",G,[a(u,{color:"neutral",variant:"outline",size:"lg",onClick:s[4]||(s[4]=r=>c("close",!1))},{default:n(()=>[f(d(o(t)("console-common.cancel")),1)]),_:1}),a(u,{color:"neutral",size:"lg",onClick:V},{default:n(()=>[f(d(o(t)("console-common.reset")),1)]),_:1}),a(u,{color:"primary",size:"lg",loading:o(k),type:"submit"},{default:n(()=>[f(d(l.isEdit?o(t)("console-common.update"):o(t)("console-common.create")),1)]),_:1},8,["loading"])])]),_:1},8,["state","schema","onSubmit"])]),_:1},8,["title","description"])}}});export{ye as default};
