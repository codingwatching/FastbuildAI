const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CJ8kTszm.js","./Dgvg0_To.js","./ilPiIi3f.js","./CDSfhndf.js","./CjOovgR0.js","./DXP7Kkdt.js","./BRI4D6WA.js","./DlAUqK2U.js","./DyTskiS5.js","./DoL5-2Ox.js","./DVSiT9pd.js","./D_1uxSdv.js","./Brlt-NDg.js","./BWJXWQJA.js","./BD5zOh0K.js","./DBwQYu6J.js","./DegKy-XA.js","./Ti3HjCpC.js","./Dc6e1ewN.js","./CXk2IlXx.js","./kRIii9yh.js","./BaKvIqXP.js","./DaC7Nksz.js","./B1TeSxwV.js","./CGkf3lDq.js","./C9inLFuJ.js","./12pJH7Js.js","./CyS2mNdj.js","./BstbYvQo.js","./BzbI-krH.js","./KiG0a5S-.js","./C6Y-ieo6.js","./cwT2REE1.js","./DnFVE45b.js","./CvZB4bI9.js","./CR9qioUt.js","./C-XPfH0G.js","./7d3iyZ8h.js","./Ds48qA85.js","./C_EXknkZ.js","./BUyfW8JT.js","./DaWZu8wl.js"])))=>i.map(i=>d[i]);
import{d as U,e as x,aJ as C,ar as D,ap as R,i as w,r as I,aK as B,j as F,c as b,o as u,t as m,k as L,m as p,l as S,z as $,x as k,q as t,_ as j,R as z,U as E,bN as N,bO as T}from"#entry";import{g as V}from"./C_EXknkZ.js";const q={class:"user-edit-container"},G={class:"bg-background sticky top-0 z-10 mb-4 flex w-full items-center justify-baseline pb-2"},M={class:"text-base font-medium"},O={class:"ml-4 text-xl font-bold"},P={key:0,class:"flex justify-center py-12"},Q=U({__name:"edit",setup(J){const g=z(()=>E(()=>import("./CJ8kTszm.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41]),import.meta.url)),{t:n}=x(),h=C(),a=D(),r=R(),i=w(()=>h.query.id),_=I({}),{lockFn:f,isLock:y}=B(async()=>{if(!i.value){r.error(n("user.backend.messages.missingUserId")),a.back();return}try{const{id:e,createdAt:s,updatedAt:c,lastLoginAt:d,role:l,...o}=await N(i.value);o.phone||(o.phoneAreaCode=V()),_.value={...o,roleId:l?.id||void 0}}catch(e){console.error("Get user detail failed:",e),r.error(n("user.backend.messages.getUserDetailFailed")),a.back()}}),v=async e=>{try{const{username:s,password:c,isRoot:d,totalRechargeAmount:l,...o}=e;await T(i.value,o),r.success(n("user.backend.messages.updateSuccess")),setTimeout(()=>a.back(),1e3)}catch(s){console.error("Update user failed:",s),r.error(n("user.backend.messages.updateFailed"))}},A=()=>{a.back()};return F(()=>f()),(e,s)=>{const c=$,d=j;return u(),b("div",q,[m("div",G,[p(d,{color:"neutral",variant:"soft",onClick:s[0]||(s[0]=l=>t(a).back())},{default:S(()=>[p(c,{name:"i-lucide-arrow-left",class:"size-5 cursor-pointer"}),m("span",M,k(e.$t("console-common.back")),1)]),_:1}),m("h1",O,k(e.$t("user.backend.editTitle")),1)]),t(y)?(u(),b("div",P,[p(c,{name:"i-lucide-loader-2",class:"text-primary-500 h-8 w-8 animate-spin"})])):(u(),L(t(g),{key:1,"is-edit":!0,id:t(i),"initial-data":t(_),onRefresh:t(f),onSubmitSuccess:v,onCancel:A},null,8,["id","initial-data","onRefresh"]))])}}});export{Q as default};
