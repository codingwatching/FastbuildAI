const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DEFpk3vO.js","./n4aLOYdS.js","./CCoSr_X_.js","./DxD6Ynfo.js","./psimjGaX.js","./CuVAPZQ8.js","./B3rWqoNg.js","./EK7Wbu3-.js","./DBiaUVBh.js","./0Benagh_.js","./BTN3Ax-V.js","./BKdtdX-7.js","./CtosDvS0.js","./kRIii9yh.js","./BhB8DUPm.js","./C6Y-ieo6.js","./zlMhJk0P.js","./DeCyaT7k.js","./D4e4FYoF.js","./BCcN9pii.js","./CMKSl-Ng.js","./Cuqwcq71.js","./CjasYwqF.js","./CAQVAH0V.js","./DBEJUH-Z.js","./Deu6qIfg.js","./D9sX2Qi6.js","./BlyoSzaa.js","./Dr7LWi5u.js","./o4ws_w_T.js","./B_l_nphw.js","./BMSQkwth.js","./DaWZu8wl.js","./Bzv9SrOl.js","./B8dIIAdq.js","./BkF8DltG.js","./jsPNKUA0.js","./D19QCKnC.js","./LSmoYDCw.js","./B3XNqw4u.js","./BVraOlsu.js","./BxwUS5gW.js","./MCK2d4XT.js","./C0aZ0x4t.js","./Bni8bPEl.js"])))=>i.map(i=>d[i]);
import{d as ae,at as se,i as ne,k as le,V as ie,a2 as re,s as B,h as k,n as I,q as ce,c as f,o as m,x as l,f as h,y as de,t as i,g as t,w as r,z as c,_ as me,A as x,D as pe,G as ue,B as _e,F as ge,E as fe,W as P,X as T}from"#entry";import{_ as he}from"./Cuqwcq71.js";import{_ as be}from"./DBiaUVBh.js";import ve from"./cd55qm53.js";import{_ as ye}from"./Da7dG-H2.js";import{_ as ke}from"./B3rWqoNg.js";import{_ as xe}from"./B5gsc-Ax.js";import{_ as Ce}from"./DNb4RPhn.js";import{_ as we}from"./o4ws_w_T.js";import{_ as De}from"./BTN3Ax-V.js";import{_ as Se}from"./tVksIQiG.js";import{_ as Ae}from"./BkF8DltG.js";import{_ as Ve}from"./BgeYBRhp.js";import{c as Ue,d as $e,e as ze}from"./C0aZ0x4t.js";import{u as Be}from"./BlyoSzaa.js";import{u as Ie}from"./ZDOPDbaX.js";import{u as Pe}from"./oxig-ZyS.js";import"./CjasYwqF.js";import"./CAQVAH0V.js";import"./DBEJUH-Z.js";import"./CuVAPZQ8.js";import"./CMKSl-Ng.js";import"./BCcN9pii.js";import"./CtosDvS0.js";import"./Deu6qIfg.js";import"./D9sX2Qi6.js";import"./DvKR6pUC.js";import"./BKdtdX-7.js";import"./kRIii9yh.js";import"./DxD6Ynfo.js";import"./BhB8DUPm.js";import"./C6Y-ieo6.js";import"./zlMhJk0P.js";import"./DeCyaT7k.js";import"./D4e4FYoF.js";import"./psimjGaX.js";import"./Be9qZ8Md.js";import"./MCK2d4XT.js";import"./EK7Wbu3-.js";import"./jsPNKUA0.js";import"./Bzv9SrOl.js";import"./o0-e7Rye.js";const Te={class:"conversation-list-container pb-5"},Re={class:"bg-background sticky top-0 z-10 flex flex-wrap gap-4 pb-2"},Ke={class:"flex items-center gap-2 md:ml-auto"},Ee={class:"flex items-center gap-2"},Ne={class:"text-muted-foreground text-sm"},Le={class:"flex items-center gap-2"},Fe={class:"flex items-center gap-2"},Me={class:"text-primary"},je={class:"text-success"},Oe={class:"mt-2 grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},Ge={key:2,class:"flex h-[calc(100vh-13rem)] items-center justify-center"},qe={class:"flex items-center gap-3"},He={class:"text-accent-foreground"},We={key:3,class:"flex h-[calc(100vh-13rem)] flex-col items-center justify-center"},Xe={class:"text-secondary-foreground mb-2 text-lg font-medium"},Je={class:"text-accent-foreground"},Qe={key:4,class:"bg-background sticky bottom-0 z-10 flex items-center justify-between gap-3 py-4"},Ye={class:"text-muted text-sm"},Ze={class:"flex items-center gap-1.5"},jt=ae({__name:"list",setup(et){const R=P(()=>T(()=>import("./DEFpk3vO.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]),import.meta.url)),K=P(()=>T(()=>import("./Dr7LWi5u.js"),__vite__mapDeps([28,1,8,29,30,31,32,33,34,35,36,37,38,39,16,5,14,40,41,42,7,43,44]),import.meta.url)),b=he,E=be,{hasAccessByCodes:N}=Be(),C=se(),{t:n}=ne(),w=le("table"),L=ie(),p=re({keyword:"",modelId:"",startDate:"",endDate:""}),_=B(1),F=[{value:1,icon:"i-lucide-list"},{value:2,icon:"i-tabler-layout-grid"}],d=B(new Set),{paging:s,getLists:g}=Ie({fetchFun:Ue,params:p}),D=(e,o)=>{if(typeof o=="boolean"){const u=e.id;o?d.value.add(u):d.value.delete(u)}},M=[{id:"select",header:({table:e})=>k(b,{modelValue:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),"onUpdate:modelValue":o=>{e.toggleAllPageRowsSelected(!!o),S(o)},"aria-label":"Select all"}),cell:({row:e})=>k(b,{modelValue:e.getIsSelected(),"onUpdate:modelValue":o=>{e.toggleSelected(!!o),D(e.original,o)},"aria-label":"Select row"})},{accessorKey:"title",header:n("ai-chat.backend.list.title")},{accessorKey:"userName",header:n("ai-chat.backend.list.userName")},{accessorKey:"messageCount",header:n("ai-chat.backend.list.messageCount")},{accessorKey:"totalTokens",header:n("ai-chat.backend.list.totalTokens")},{accessorKey:"totalPower",header:n("ai-chat.backend.list.totalPower")},{accessorKey:"updatedAt",header:n("console-common.updateAt"),cell:({row:e})=>{const o=e.getValue("updatedAt");return k(E,{datetime:o,mode:"datetime"})}},{accessorKey:"action",header:n("console-common.operation"),size:40,enableSorting:!1,enableHiding:!1}];function j(e){return[{label:n("order.backend.recharge.list.viewDetails"),icon:"i-lucide-eye",color:"info",onClick:()=>{v(e.original.id)}},N(["ai-conversations:ai_conversation_delete"])?{label:n("console-common.delete"),icon:"i-lucide-trash-2",color:"error",onSelect(){V(e.original)}}:null].filter(Boolean)}const S=e=>{const o=e===!0;w.value?.tableApi.toggleAllPageRowsSelected(!!e),o?s.items.forEach(u=>{d.value.add(u.id)}):d.value.clear()},A=async e=>{try{await Pe({title:n("ai-chat.backend.delete.title"),description:n("ai-chat.backend.delete.description"),color:"error",cancelText:n("console-common.cancel"),confirmText:n("console-common.confirm")}),Array.isArray(e)?(await $e(e),C.success(n("common.message.deleteBatchSuccess"))):(await ze(e),C.success(n("common.message.deleteSuccess"))),d.value.clear(),g()}catch(o){console.error("Delete failed:",o)}},V=e=>{A(e.id)},O=()=>{const e=Array.from(d.value);e.length!==0&&A(e)},G=e=>{L.create(K).open({conversationId:e})},v=e=>{G(e)},q=I(()=>s.items.length>0&&s.items.every(e=>d.value.has(e.id))),H=I(()=>{const e=s.items.filter(o=>d.value.has(o.id)).length;return e>0&&e<s.items.length}),W=e=>{v(e.original.id)};return ce(()=>g()),(e,o)=>{const u=ve,X=ye,J=ke,U=me,Q=xe,Y=Ce,y=_e,$=ue,Z=we,ee=De,te=Se,z=Ae,oe=Ve;return m(),f("div",Te,[l("div",Re,[i(u,{modelValue:t(p).keyword,"onUpdate:modelValue":o[0]||(o[0]=a=>t(p).keyword=a),placeholder:e.$t("ai-chat.backend.search.placeholder"),onChange:t(g)},null,8,["modelValue","placeholder","onChange"]),i(X,{start:t(p).startDate,"onUpdate:start":o[1]||(o[1]=a=>t(p).startDate=a),end:t(p).endDate,"onUpdate:end":o[2]||(o[2]=a=>t(p).endDate=a),ui:{root:"w-auto sm:w-xs"},onChange:t(g)},null,8,["start","end","onChange"]),l("div",Ke,[l("div",Ee,[i(t(b),{"model-value":t(q)?!0:t(H)?"indeterminate":!1,"onUpdate:modelValue":S},{label:r(()=>[l("span",Ne,c(t(d).size)+" / "+c(t(s).items.length)+" "+c(t(n)("console-common.selected")),1)]),_:1},8,["model-value"])]),i(Q,{codes:["ai_conversation_delete"]},{default:r(()=>[i(U,{color:"error",variant:"subtle",label:e.$t("console-common.batchDelete"),icon:"i-heroicons-trash",disabled:t(d).size===0,onClick:O},{trailing:r(()=>[i(J,null,{default:r(()=>[x(c(t(d).size),1)]),_:1})]),_:1},8,["label","disabled"])]),_:1}),i(Y,{modelValue:t(_),"onUpdate:modelValue":o[3]||(o[3]=a=>pe(_)?_.value=a:null),items:F,size:"xs",ui:{root:"gap-0",indicator:"bg-background dark:bg-primary",leadingIcon:"bg-black dark:bg-white"}},null,8,["modelValue"])])]),!t(s).loading&&t(s).items.length>0&&t(_)===1?(m(),h(z,{key:0,class:"h-[calc(100vh-13rem)] pt-2",shadow:!1},{default:r(()=>[i(te,{ref_key:"table",ref:w,data:t(s).items,columns:M,ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default cursor-pointer",tr:"[&:has(>td[colspan])]:hidden"},onSelect:W},{"title-cell":r(({row:a})=>[l("div",Le,[i(y,{name:"i-lucide-message-circle",class:"text-primary size-5"}),x(" "+c(a.original.title||"new Chat"),1)])]),"userName-cell":r(({row:a})=>[l("div",Fe,[a.original.user?.avatar?(m(),h($,{key:0,src:a.original.user?.avatar},null,8,["src"])):(m(),h($,{key:1,icon:"i-heroicons-user",name:a.original.user?.username},null,8,["name"])),l("span",null,c(a.original.user?.nickname),1)])]),"messageCount-cell":r(({row:a})=>[i(Z,{color:"primary",variant:"subtle"},{default:r(()=>[x(c(a.original.messageCount),1)]),_:2},1024)]),"totalTokens-cell":r(({row:a})=>[l("span",Me,c(a.original.totalTokens),1)]),"totalPower-cell":r(({row:a})=>[l("span",je,c(a.original.totalPower),1)]),"action-cell":r(({row:a})=>[i(ee,{items:j(a)},{default:r(()=>[i(U,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost","aria-label":"Actions"})]),_:1},8,["items"])]),_:1},8,["data"])]),_:1})):!t(s).loading&&t(s).items.length>0&&t(_)===2?(m(),h(z,{key:1,class:"h-[calc(100vh-13rem)]",shadow:!1},{default:r(()=>[l("div",Oe,[(m(!0),f(ge,null,fe(t(s).items,a=>(m(),h(t(R),{key:a.id,conversation:a,selected:t(d).has(a.id),onSelect:D,onDelete:V,onViewDetail:v},null,8,["conversation","selected"]))),128))])]),_:1})):t(s).loading?(m(),f("div",Ge,[l("div",qe,[i(y,{name:"i-lucide-loader-2",class:"text-primary-500 h-6 w-6 animate-spin"}),l("span",He,c(e.$t("common.loading")),1)])])):(m(),f("div",We,[i(y,{name:"i-lucide-message-circle",class:"text-muted mb-4 h-16 w-16"}),l("h3",Xe,c(e.$t("ai-chat.backend.empty.title")),1),l("p",Je,c(e.$t("ai-chat.backend.empty.description")),1)])),t(s).total>0?(m(),f("div",Qe,[l("div",Ye,c(t(d).size)+" "+c(e.$t("console-common.selected")),1),l("div",Ze,[i(oe,{page:t(s).page,"onUpdate:page":o[4]||(o[4]=a=>t(s).page=a),size:t(s).pageSize,"onUpdate:size":o[5]||(o[5]=a=>t(s).pageSize=a),total:t(s).total,onChange:t(g)},null,8,["page","size","total","onChange"])])])):de("",!0)])}}});export{jt as default};
