import{d as z,e as L,ap as T,au as j,aK as y,i as k,j as q,k as x,o as u,l as i,c as E,q as e,t as l,m as n,z as I,x as f,y as h,_ as S}from"#entry";import K from"./CDSfhndf.js";import{_ as G}from"./Brlt-NDg.js";import{_ as H}from"./Ds48qA85.js";import{_ as O}from"./BYm23QKU.js";import{e as P,f as R,g as A}from"./DkAujwQK.js";import{c as J,a as Q}from"./BUyfW8JT.js";import"./DoL5-2Ox.js";import"./DGUAW_1C.js";import"./DDJ79SjH.js";import"./Ti3HjCpC.js";import"./DegKy-XA.js";import"./B1TeSxwV.js";import"./RmzZBBRE.js";import"./C4jlvBh2.js";import"./C-XPfH0G.js";import"./7d3iyZ8h.js";import"./DaWZu8wl.js";const W={key:0,class:"flex items-center justify-center py-12"},X={class:"flex flex-col items-center gap-3"},Y={class:"text-muted-foreground text-sm"},Z={class:"space-y-4"},ee={class:"flex justify-end gap-3 pt-6"},xe=z({__name:"edit",props:{id:{}},emits:["close"],setup(b,{emit:v}){const{t:o}=L(),_=T(),a=b,d=v,s=j({terminal:"web",name:"",configs:{backgroundColor:"#ffffff",backgroundDarkColor:"",backgroundImage:"",backgroundType:"solid",pageHeight:1080},content:[]}),$=J({name:Q().required(o("decorate.micropage.edit.pageNameRequired")).max(32,o("decorate.micropage.edit.pageNameMaxLength"))}),{lockFn:w,isLock:C}=y(async()=>{try{const c=await P(a.id);Object.keys(s).forEach(t=>{const r=t,m=c[r];m!==void 0&&(s[r]=m)})}catch(c){console.error("获取微页面详情失败:",c)}}),{lockFn:D,isLock:F}=y(async()=>{try{a.id?(await R(a.id,s),_.success(o("console-common.messages.success"))):(await A(s),_.success(o("console-common.messages.success"))),d("close",!0)}catch(c){console.error("提交失败:",c)}}),M=k(()=>a.id?o("decorate.micropage.edit.modalTitleEdit"):o("decorate.micropage.edit.modalTitleCreate")),N=k(()=>a.id?o("decorate.micropage.edit.modalDescriptionEdit"):o("decorate.micropage.edit.modalDescriptionCreate"));return q(async()=>a.id&&await w()),(c,t)=>{const r=I,m=K,U=G,g=S,B=H,V=O;return u(),x(V,{title:e(M),description:e(N),ui:{content:"max-w-md"},onClose:t[2]||(t[2]=p=>d("close",!1))},{default:i(()=>[e(C)?(u(),E("div",W,[l("div",X,[n(r,{name:"i-lucide-loader-2",class:"text-primary size-8 animate-spin"}),l("p",Y,f(e(o)("common.loading")),1)])])):(u(),x(B,{key:1,state:e(s),schema:e($),class:"space-y-6",onSubmit:e(D)},{default:i(()=>[l("div",Z,[n(U,{label:e(o)("decorate.micropage.edit.pageName"),name:"name",required:""},{default:i(()=>[n(m,{modelValue:e(s).name,"onUpdate:modelValue":t[0]||(t[0]=p=>e(s).name=p),placeholder:e(o)("decorate.micropage.edit.pageNamePlaceholder"),maxlength:"32","show-count":"",size:"lg",ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),l("div",ee,[n(g,{type:"button",variant:"outline",size:"lg",onClick:t[1]||(t[1]=p=>d("close",!1))},{default:i(()=>[h(f(e(o)("console-common.cancel")),1)]),_:1}),n(g,{type:"submit",loading:e(F),size:"lg",icon:"i-lucide-save"},{default:i(()=>[h(f(a.id?e(o)("console-common.update"):e(o)("console-common.create")),1)]),_:1},8,["loading"])])]),_:1},8,["state","schema","onSubmit"]))]),_:1},8,["title","description"])}}});export{xe as default};
