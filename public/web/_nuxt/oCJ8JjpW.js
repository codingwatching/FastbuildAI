const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DvBB9umw.js","./CDSfhndf.js","./Dgvg0_To.js","./Brlt-NDg.js","./DoL5-2Ox.js","./BWJXWQJA.js","./BD5zOh0K.js","./DBwQYu6J.js","./DegKy-XA.js","./Ti3HjCpC.js","./Dc6e1ewN.js","./CXk2IlXx.js","./DVSiT9pd.js","./kRIii9yh.js","./BaKvIqXP.js","./DaC7Nksz.js","./D_1uxSdv.js","./B1TeSxwV.js","./CvZB4bI9.js","./KiG0a5S-.js","./C6Y-ieo6.js","./CyS2mNdj.js","./cwT2REE1.js","./DnFVE45b.js","./BjYsydzc.js","./Ds48qA85.js","./BYm23QKU.js","./DGUAW_1C.js","./DDJ79SjH.js","./RmzZBBRE.js","./C4jlvBh2.js","./C-XPfH0G.js","./7d3iyZ8h.js","./pWePb4LA.js","./Tmc8NqSi.js","./BUyfW8JT.js","./DaWZu8wl.js","./Dx01Lm3C.js"])))=>i.map(i=>d[i]);
import{d as F,e as O,ap as q,g as Q,Q as G,aN as H,s as k,i as J,h as g,j as W,c as X,o as Y,t as m,m as l,bB as Z,q as o,l as u,y as x,x as V,_ as ee,R as te,U as oe}from"#entry";import{_ as ae}from"./DJ9SNVgt.js";import{_ as se}from"./BixMXl5t.js";import le from"./CDSfhndf.js";import{_ as ne}from"./12pJH7Js.js";import{_ as ce}from"./DyTskiS5.js";import{_ as re}from"./6WwfWHXT.js";import{_ as ie}from"./CEOm-hjj.js";import{_ as me}from"./4yDHJZoY.js";import{a as de,d as pe,u as ue,b as _e,c as fe,e as ge}from"./pWePb4LA.js";import{b as he}from"./Tmc8NqSi.js";import{u as be}from"./C1xCp5oe.js";import"./CgMDXot0.js";import"./DVSiT9pd.js";import"./CZsOHrUj.js";import"./DegKy-XA.js";import"./DaC7Nksz.js";import"./cwT2REE1.js";import"./CXk2IlXx.js";import"./D_1uxSdv.js";import"./DoL5-2Ox.js";import"./DBwQYu6J.js";import"./Ti3HjCpC.js";import"./CyS2mNdj.js";import"./BaKvIqXP.js";import"./B1TeSxwV.js";import"./BstbYvQo.js";import"./KiG0a5S-.js";import"./kRIii9yh.js";import"./C6Y-ieo6.js";import"./DnFVE45b.js";import"./DSCppvl0.js";import"./7d3iyZ8h.js";import"./DhlnS5e0.js";import"./DlAUqK2U.js";const ye={class:"flex h-full flex-col gap-4"},Se={class:"flex items-center justify-between gap-4"},ve={class:"flex flex-1 items-center gap-2"},ke={class:"flex items-center gap-2"},xe={class:"flex-1 overflow-y-auto"},Ve={class:"bg-background flex items-center justify-end gap-3 py-4"},Ue={class:"flex items-center gap-1.5"},rt=F({__name:"list",setup(we){const U=te(()=>oe(()=>import("./DvBB9umw.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37]),import.meta.url)),{t:a}=O(),_=q(),h=Q("table"),w=G(),b=ae,A=se,d=H({name:"",templateId:"all"}),n=k([]),y=k([]),{paging:r,getLists:c}=be({fetchFun:de,params:d}),C=J(()=>[{id:"select",accessorKey:"select",header:({table:e})=>g(b,{modelValue:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),"onUpdate:modelValue":t=>{e.toggleAllPageRowsSelected(!!t),$(t)},"aria-label":"Select all"}),cell:({row:e})=>g(b,{modelValue:e.getIsSelected(),"onUpdate:modelValue":t=>{e.toggleSelected(!!t),D(e,t)},"aria-label":"Select row"})},{accessorKey:"name",header:a("ai-secret.backend.list.form.name")},{accessorKey:"template",header:a("ai-secret.backend.list.form.keyType"),cell:({row:e})=>e.original.template.name},{accessorKey:"remark",header:a("ai-secret.backend.list.form.remark")},{accessorKey:"status",header:a("console-common.status")},{accessorKey:"createdAt",header:a("console-common.createAt"),cell:({row:e})=>{const t=e.getValue("createdAt");return g(A,{datetime:t,mode:"datetime"})}},{id:"action",accessorKey:"action",header:a("console-common.operation")}]),I=e=>[{label:a("console-common.edit"),icon:"i-lucide-edit",onClick:()=>{S(e.original.id)}},{label:a("console-common.delete"),icon:"i-lucide-trash",color:"error",onSelect(){R(e.original.id)}}],S=e=>{w.create(U).open({id:e,onSubmit:(i,p)=>{P(i,p)}})},K=()=>{S()},R=async e=>{await pe(e),_.success(a("console-common.deleteSuccess")),c()},T=async e=>{if(!e.original.id){console.error("行数据缺少 ID");return}try{await ue(e.original.id,{status:e.original.status}),_.success(e.original.status?a("console-common.enableSuccess"):a("console-common.disableSuccess")),c()}catch(t){console.error("更新状态失败:",t)}},D=(e,t)=>{if(typeof t=="boolean"){const i=e.original.id;t?n.value.push(i):n.value=n.value.filter(p=>p!==i),console.log(n.value)}},$=e=>{typeof e=="boolean"&&(e?n.value=r.items.map(t=>t.id):n.value=[])},B=async()=>{try{await _e(n.value),n.value=[],h.value?.tableApi.toggleAllPageRowsSelected(!1),_.success(a("console-common.batchDeleteSuccess")),c()}catch(e){console.error("批量删除失败:",e)}},P=async(e,t)=>{t?await fe(t,e):await ge(e),_.success(a("ai-secret.backend.list.edit.submitSuccess")),c()},L=async()=>{try{const e=await he();y.value=e}catch(e){console.error("加载模板列表失败:",e)}},z=()=>{c()};return W(()=>{L(),c()}),(e,t)=>{const i=le,p=ne,f=ee,E=ce,M=re,N=ie,j=me;return Y(),X("div",ye,[m("div",Se,[m("div",ve,[l(i,{modelValue:o(d).name,"onUpdate:modelValue":t[0]||(t[0]=s=>o(d).name=s),placeholder:o(a)("ai-secret.backend.list.placeholder"),onKeyup:Z(o(c),["enter"])},null,8,["modelValue","placeholder","onKeyup"]),l(p,{modelValue:o(d).templateId,"onUpdate:modelValue":[t[1]||(t[1]=s=>o(d).templateId=s),z],items:[{label:o(a)("console-common.all"),value:"all"},...o(y).map(s=>({label:s.name,value:s.id}))],"label-key":"label","value-key":"value",placeholder:o(a)("ai-secret.backend.list.form.keyType"),class:"w-48"},null,8,["modelValue","items","placeholder"])]),m("div",ke,[l(f,{icon:"i-tabler-trash",color:"error",variant:"outline",onClick:B},{default:u(()=>[x(V(o(a)("console-common.batchDelete")),1)]),_:1}),l(f,{color:"primary",icon:"i-lucide-plus",onClick:K},{default:u(()=>[x(V(o(a)("ai-secret.backend.list.add")),1)]),_:1})])]),m("div",xe,[l(N,{ref_key:"table",ref:h,class:"h-full",sticky:"",columns:o(C),data:o(r).items,ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default",tr:"[&:has(>td[colspan])]:hidden"}},{"status-cell":u(({row:s})=>[l(E,{"model-value":!!s.original.status,"onUpdate:modelValue":v=>s.original.status=v?1:0,onChange:v=>T(s)},null,8,["model-value","onUpdate:modelValue","onChange"])]),"action-cell":u(({row:s})=>[l(M,{items:I(s)},{default:u(()=>[l(f,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost"})]),_:1},8,["items"])]),_:1},8,["columns","data"])]),m("div",Ve,[m("div",Ue,[l(j,{page:o(r).page,"onUpdate:page":t[2]||(t[2]=s=>o(r).page=s),size:o(r).pageSize,"onUpdate:size":t[3]||(t[3]=s=>o(r).pageSize=s),total:o(r).total,onChange:o(c)},null,8,["page","size","total","onChange"])])])])}}});export{rt as default};
