const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./vtLSlxYk.js","./BixMXl5t.js","./Dgvg0_To.js","./CEOm-hjj.js","./BYm23QKU.js","./DGUAW_1C.js","./DDJ79SjH.js","./Ti3HjCpC.js","./DegKy-XA.js","./B1TeSxwV.js","./RmzZBBRE.js","./C4jlvBh2.js","./C-XPfH0G.js","./7d3iyZ8h.js","./CbphcY1g.js","./DJ9SNVgt.js","./CgMDXot0.js","./DVSiT9pd.js","./CZsOHrUj.js","./DaC7Nksz.js","./cwT2REE1.js","./CXk2IlXx.js","./D_1uxSdv.js","./DoL5-2Ox.js","./B3Cet3zC.js","./CthPp3Zu.js","./Be9Wwotq.js","./CDSfhndf.js","./Brlt-NDg.js","./BjYsydzc.js","./Ds48qA85.js","./BUyfW8JT.js","./DaWZu8wl.js"])))=>i.map(i=>d[i]);
import{d as T,e as F,Q as K,g as O,au as N,i as j,j as H,c as q,o as G,t as h,m as r,q as o,l as i,_ as Q,y as w,x as g,h as a,R as C,U as x}from"#entry";import{_ as J}from"./DJ9SNVgt.js";import{_ as W}from"./6WwfWHXT.js";import{_ as X}from"./BixMXl5t.js";import Y from"./CDSfhndf.js";import{_ as Z}from"./DSCppvl0.js";import{_ as ee}from"./Bjbrn0__.js";import{_ as oe}from"./B-p4_8pw.js";import{_ as te}from"./CEOm-hjj.js";import{_ as se}from"./4yDHJZoY.js";import{e as le,f as ae,g as re}from"./CthPp3Zu.js";import{u as ne}from"./zDgZcZqa.js";import{u as ie}from"./C1xCp5oe.js";import{u as ce}from"./DcxZIiHI.js";import"./CgMDXot0.js";import"./DVSiT9pd.js";import"./CZsOHrUj.js";import"./DegKy-XA.js";import"./DaC7Nksz.js";import"./cwT2REE1.js";import"./CXk2IlXx.js";import"./D_1uxSdv.js";import"./DoL5-2Ox.js";import"./KiG0a5S-.js";import"./kRIii9yh.js";import"./DBwQYu6J.js";import"./B1TeSxwV.js";import"./C6Y-ieo6.js";import"./Ti3HjCpC.js";import"./CyS2mNdj.js";import"./BaKvIqXP.js";import"./DnFVE45b.js";import"./7d3iyZ8h.js";import"./DhlnS5e0.js";import"./DlAUqK2U.js";const de={class:"role-list-container pb-5"},me={class:"bg-background sticky top-0 z-10 flex flex-wrap gap-4 pb-4"},pe={class:"flex items-end gap-2 md:ml-auto"},ue={class:"mt-auto flex items-center justify-between gap-3 pt-4"},ge={class:"text-muted text-sm"},_e={class:"flex items-center gap-1.5"},Ye=T({__name:"list",setup(fe){const k=C(()=>x(()=>import("./vtLSlxYk.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url)),U=C(()=>x(()=>import("./CbphcY1g.js"),__vite__mapDeps([14,2,15,16,17,18,8,19,20,21,22,23,4,5,6,7,9,10,11,12,13,24,25]),import.meta.url)),$=C(()=>x(()=>import("./Be9Wwotq.js"),__vite__mapDeps([26,2,27,28,23,29,30,4,5,6,7,8,9,10,11,12,13,25,31,32]),import.meta.url)),A=J,c=Q,I=W,D=X,{t:l}=F(),{hasAccessByCodes:b}=ne(),y=K(),n=O("table"),_=N({name:"",description:""}),{paging:d,getLists:m}=ie({fetchFun:le,params:_}),p=j(()=>({select:l("console-common.select"),name:l("system-perms.role.name"),description:l("system-perms.role.describe"),status:l("console-common.status"),createdAt:l("console-common.createAt"),accountCount:l("system-perms.role.usersCount"),actions:l("console-common.operation")})),M=[{id:"select",header:({table:e})=>a(A,{modelValue:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),"onUpdate:modelValue":t=>e.toggleAllPageRowsSelected(!!t),ariaLabel:"Select all"}),cell:({row:e})=>a(A,{modelValue:e.getIsSelected(),"onUpdate:modelValue":t=>e.toggleSelected(!!t),ariaLabel:"Select row"})},{accessorKey:"name",header:()=>a("p",{class:""},`${p.value.name}`),cell:({row:e})=>a("div",{class:"flex items-center gap-3"},[a("div",void 0,[a("p",{class:""},`@${e.original.name}`)])])},{accessorKey:"description",header:()=>a("p",{class:""},`${p.value.description}`),cell:({row:e})=>{const t=e.getValue("description");return a("div",{class:"max-w-xs truncate"},t)}},{accessorKey:"users",header:()=>a("p",{class:""},`${p.value.accountCount}`),cell:({row:e})=>{const t=e.getValue("users");return a("div",{class:"max-w-xs truncate"},t.length)}},{accessorKey:"createdAt",header:({column:e})=>{const t=e.getIsSorted();return a(c,{color:"neutral",variant:"ghost",label:p.value.createdAt,icon:t?t==="asc"?"i-lucide-arrow-up-narrow-wide":"i-lucide-arrow-down-wide-narrow":"i-lucide-arrow-up-down",class:"-mx-2.5",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc")})},cell:({row:e})=>{const t=e.getValue("createdAt");return a(D,{datetime:t,mode:"datetime"})}},{id:"actions",header:()=>a("p",{class:""},`${p.value.actions}`),size:40,enableSorting:!1,enableHiding:!1,cell:({row:e})=>a("div",{class:"flex items-center gap-1"},[b(["role:update"])?a(c,{icon:"i-lucide-pen-line",color:"primary",variant:"ghost",size:"xs",label:l("console-common.edit"),onClick:()=>{R(e.original.id||"")}}):null,b(["role:permissions"])?a(c,{icon:"i-lucide-shield-check",color:"primary",variant:"ghost",size:"xs",label:l("system-perms.role.permissions"),onClick:()=>{P(e.original.id||"")}}):null,b(["role:delete"])?a(c,{icon:"i-lucide-trash",color:"error",variant:"ghost",size:"xs",label:l("console-common.delete"),onClick:()=>{S(e.original.id)}}):null].filter(Boolean))}],R=async e=>{await y.create($).open({id:e??null}).result&&m()},P=async e=>{await y.create(U).open({id:e}).result&&m()},z=(e,t)=>{y.create(k).open({users:e,roleName:t})},S=async e=>{try{await ce({title:l("system-perms.role.deleteTitle"),description:l("system-perms.role.deleteMsg"),color:"error"}),Array.isArray(e)?await ae({ids:e}):await re(e),m()}catch(t){console.error("删除失败:",t)}};return H(()=>m()),(e,t)=>{const f=Y,v=Z,V=ee,B=oe,E=te,L=se;return G(),q("div",de,[h("div",me,[r(f,{modelValue:o(_).name,"onUpdate:modelValue":t[0]||(t[0]=s=>o(_).name=s),placeholder:o(l)("system-perms.role.nameInput"),onChange:o(m)},null,8,["modelValue","placeholder","onChange"]),r(f,{modelValue:o(_).description,"onUpdate:modelValue":t[1]||(t[1]=s=>o(_).description=s),placeholder:o(l)("system-perms.role.descriptionInput"),ui:{root:"max-w-xs w-full"},onChange:o(m)},null,8,["modelValue","placeholder","onChange"]),h("div",pe,[r(V,{codes:["role:delete"]},{default:i(()=>[r(o(c),{color:"error",variant:"subtle",label:o(l)("console-common.batchDelete"),icon:"i-heroicons-trash",disabled:!o(n)?.tableApi?.getFilteredSelectedRowModel().rows.length,onClick:t[2]||(t[2]=s=>S(o(n)?.tableApi?.getFilteredSelectedRowModel().rows.map(u=>u.original.id)))},{trailing:i(()=>[r(v,null,{default:i(()=>[w(g(o(n)?.tableApi?.getFilteredSelectedRowModel().rows.length),1)]),_:1})]),_:1},8,["label","disabled"])]),_:1}),r(o(I),{items:o(n)?.tableApi?.getAllColumns().filter(s=>s.getCanHide()).map(s=>({label:o(p)[s?.id]||s.columnDef.header,type:"checkbox",checked:s.getIsVisible(),onUpdateChecked(u){o(n)?.tableApi?.getColumn(s.id)?.toggleVisibility(!!u)},onSelect(u){u?.preventDefault()}})),content:{align:"end"}},{default:i(()=>[r(o(c),{label:o(l)("console-common.showColumns"),color:"neutral",variant:"outline","trailing-icon":"i-lucide-chevron-down"},null,8,["label"])]),_:1},8,["items"]),r(V,{codes:["role:create"]},{default:i(()=>[r(o(c),{icon:"i-heroicons-plus",color:"primary",onClick:t[3]||(t[3]=()=>R(null))},{default:i(()=>[w(g(o(l)("system-perms.role.add")),1)]),_:1})]),_:1})])]),r(E,{loading:o(d).loading,data:o(d).items,columns:M,class:"h-[calc(100vh-13rem)] shrink-0",ref_key:"table",ref:n,selectable:"",ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default"}},{"users-cell":i(({row:s})=>[r(B,{class:"cursor-pointer",color:"primary",onClick:u=>z(s.original.users,s.original.name)},{default:i(()=>[w(g(s.original.users.length),1)]),_:2},1032,["onClick"])]),_:1},8,["loading","data"]),h("div",ue,[h("div",ge,g(o(n)?.tableApi?.getFilteredSelectedRowModel().rows.length||0)+" / "+g(o(n)?.tableApi?.getFilteredRowModel().rows.length||0)+" "+g(o(l)("console-common.selected"))+". ",1),h("div",_e,[r(L,{page:o(d).page,"onUpdate:page":t[4]||(t[4]=s=>o(d).page=s),size:o(d).pageSize,"onUpdate:size":t[5]||(t[5]=s=>o(d).pageSize=s),total:o(d).total,onChange:o(m)},null,8,["page","size","total","onChange"])])])])}}});export{Ye as default};
