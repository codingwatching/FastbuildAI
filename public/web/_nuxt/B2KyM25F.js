import Z from"./CDSfhndf.js";import{_ as ee}from"./Brlt-NDg.js";import{d as te,e as le,br as se,s as O,w as oe,a$ as ae,b0 as ne,aJ as ie,i as A,k as g,o as s,l as d,t,m as c,c as r,v as z,T as ce,q as e,_ as re,y as de,z as ue,x as f,F as _,C as x,p as R,A as q,r as me,aU as fe,h as M,aL as B,an as L,b8 as pe,M as he}from"#entry";import{_ as _e}from"./6WwfWHXT.js";import{_ as xe}from"./DwzRPK54.js";import{_ as ve}from"./CR9qioUt.js";import{_ as ge}from"./tYG64TNz.js";import{g as ye,h as be,i as Ce}from"./DPwLTNIs.js";import{g as ke}from"./eeyg4-1U.js";import{u as we}from"./t1d_OU1Q.js";import{u as I}from"./DcxZIiHI.js";import{d as Se}from"./C-XPfH0G.js";import{_ as ze}from"./DlAUqK2U.js";const $e={class:"relative h-full flex-1"},De={key:0,class:"flex h-full min-h-0 w-[240px] flex-col"},Ue={class:"border-border/50 flex gap-2 border-b px-1 py-3"},Ve={class:"h-full flex-1 overflow-hidden"},Te={key:0,class:"text-muted-foreground flex h-full flex-col items-center justify-center text-center text-sm"},Ae={class:"mb-2"},Me={class:"text-xs"},Be={class:"flex flex-col gap-4 space-y-1 py-4 pr-4 pl-2"},Le={class:"text-muted-foreground px-2 py-1 text-xs font-medium"},Ne={class:"flex flex-col gap-1"},Pe={class:"block flex-1 truncate text-left"},Ee={key:0,class:"flex flex-col gap-4 py-4"},Fe={class:"px-2 py-1"},je={class:"flex flex-col gap-1"},Ke={key:0,class:"absolute top-2 left-2 z-50 flex items-center gap-2"},Re={class:"group relative hidden sm:block"},qe={class:"block flex-1 truncate text-left text-sm"},Ie={class:"block flex-1 truncate text-left text-sm"},Oe={key:0,class:"text-muted-foreground flex h-full flex-col items-center justify-center text-center text-sm"},Ge={class:"mb-2"},Je={class:"text-xs"},Qe={class:"flex flex-col gap-4 space-y-1 py-4 pr-4 pl-2"},He={class:"text-muted-foreground px-2 py-1 text-xs font-medium"},We={class:"flex flex-col gap-1"},Xe={class:"block flex-1 truncate text-left"},Ye={key:0,class:"flex flex-col gap-4 py-4"},Ze={class:"px-2 py-1"},et={class:"flex flex-col gap-1"},tt=te({inheritAttrs:!1,__name:"chats-chats",async setup(b){let C,$;const{t:l}=le(),p=we(),N=se("(max-width: 768px)"),v=O(!1);oe(N,i=>{i?p.chatSidebarVisible=!1:(v.value=!1,p.chatSidebarVisible=!0)},{immediate:!1});const{data:k,pending:w}=([C,$]=ae(()=>ne("chats",()=>ye({page:1,pageSize:50}),{lazy:!1})),C=await C,$(),C),P=ie(),h=A(()=>P.name==="chat-id"?P.params.id:""),G=Z,J=ee,y=A(()=>k.value?.items?.length?ke(k.value.items,"updatedAt",l):[]),D=A(()=>!k.value?.items||!h.value?null:k.value.items.find(i=>i.id===h.value)||null);async function Q(i){const o=me(i.title);try{const u=fe({setup(){return()=>M("div",{class:"py-2"},[M(J,{label:l("common.chat.chatTitleLabel"),size:"lg",required:!0,error:o.value.trim()?"":l("common.chat.chatTitleRequired")},{default:()=>M(G,{modelValue:o.value,"onUpdate:modelValue":m=>{o.value=m},placeholder:l("common.chat.chatTitlePlaceholder"),maxlength:50,class:"w-full",onKeyup:m=>{m.key==="Enter"&&o.value.trim()}})})])}});await I({title:l("common.chat.editChatTitle"),content:u,confirmText:l("common.save"),cancelText:l("common.cancel"),color:"primary",ui:{content:"!w-sm"}}),o.value.trim()&&o.value!==i.title&&(await be(i.id,{title:o.value}),B("chats"),B(`chat-detail-${i.id}`))}catch(u){console.log("User cancelled edit operation:",u)}}async function E(i){try{await I({color:"error",title:l("common.chat.confirmDelete"),content:l("common.chat.confirmDeleteMessage"),confirmText:l("common.chat.confirmDeleteAction"),cancelText:l("common.cancel"),ui:{content:"!w-sm"}})&&(await Ce(i.id),await B("chats")),L("/")}catch(o){console.log("User cancelled delete operation or delete failed:",o)}}function U(i){L(`/chat/${i.id}`)}function F(){L("/")}const H=()=>{N.value?(v.value=!0,p.chatSidebarVisible=!1):(v.value=!1,p.chatSidebarVisible=!0)};function W(i,o){(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),U(o))}const j=i=>[{label:l("common.edit"),color:"primary",icon:"i-lucide-pencil",onSelect:()=>Q(i)},{label:l("common.delete"),color:"error",icon:"i-lucide-trash",onSelect:()=>E(i)}];return Se({o:()=>v.value=!v.value}),(i,o)=>{const u=ue,m=re,V=_e,S=xe,K=ve,X=ge,Y=pe;return s(),g(Y,null,{default:d(()=>[t("div",$e,[c(ce,{name:"sidebar"},{default:d(()=>[e(p).chatSidebarVisible?(s(),r("div",De,[t("div",Ue,[c(m,{ui:{base:"w-full"},color:"primary",variant:"soft",onClick:F},{default:d(()=>[c(u,{name:"i-lucide-sparkles",class:"mr-2 size-4"}),de(" "+f(e(l)("common.chat.newChat")),1)]),_:1}),c(m,{color:"neutral",variant:"ghost",class:"p-2",onClick:o[0]||(o[0]=a=>e(p).chatSidebarVisible=!1)},{default:d(()=>[c(u,{name:"i-lucide-history",class:"size-5"})]),_:1})]),t("div",Ve,[!e(y).length&&!e(w)?(s(),r("div",Te,[t("div",Ae,[c(u,{name:"i-lucide-message-circle",size:"lg",class:"text-muted-foreground"})]),t("p",null,f(e(l)("common.chat.noChats")),1),t("p",Me,f(e(l)("common.chat.noChatsSubtitle")),1)])):(s(),g(K,{key:1,class:"grid h-full"},{default:d(()=>[t("div",Be,[(s(!0),r(_,null,x(e(y),a=>(s(),r("div",{key:a.key,class:"flex flex-col gap-2"},[t("div",Le,f(a.label),1),t("div",Ne,[(s(!0),r(_,null,x(a.items,n=>(s(),r("div",{key:n.id,class:"group relative"},[c(m,{label:n.title,ui:{base:"flex justify-between w-full gap-2 cursor-pointer pr-10 relative w-full"},variant:n.id===e(h)?"soft":"ghost",color:n.id===e(h)?"primary":"neutral",onClick:T=>U(n),onKeydown:T=>W(T,n)},{default:d(()=>[t("span",Pe,f(n.title||e(l)("common.chat.newChat")),1)]),_:2},1032,["label","variant","color","onClick","onKeydown"]),c(V,{items:[j(n)],ui:{content:"w-3",group:"flex flex-col gap-1 p-2",itemLeadingIcon:"size-4"},content:{side:"right",align:"start"}},{default:d(()=>[c(u,{name:"i-lucide-ellipsis",size:14,class:q(["absolute top-1/2 right-3 z-10 h-8 -translate-y-1/2 cursor-pointer px-2.5 py-1.5 opacity-0 transition-opacity group-hover:opacity-100",{"opacity-100":n.id===e(h)}]),onClick:o[1]||(o[1]=R(()=>{},["stop"]))},null,8,["class"])]),_:2},1032,["items"])]))),128))])]))),128)),!e(y).length&&e(w)?(s(),r("div",Ee,[(s(),r(_,null,x(3,a=>t("div",{key:`group-${a}`,class:"flex flex-col gap-2"},[t("div",Fe,[c(S,{class:"h-4 w-16"})]),t("div",je,[(s(!0),r(_,null,x(a===1?3:a===2?2:1,n=>(s(),g(S,{key:`item-${a}-${n}`,class:"h-10 w-full rounded-md"}))),128))])])),64))])):z("",!0)])]),_:1}))])])):z("",!0)]),_:1}),e(p).chatSidebarVisible?z("",!0):(s(),r("div",Ke,[c(m,{color:"neutral",variant:"ghost",size:"lg",class:"p-2",onClick:H},{default:d(()=>[c(u,{name:"i-lucide-history",class:"size-5"})]),_:1}),o[4]||(o[4]=t("div",{class:"text-muted-foreground mx-1 hidden sm:block"},"/",-1)),t("div",Re,[e(h)?(s(),g(V,{key:1,items:[{label:e(l)("common.delete"),color:"error",icon:"i-lucide-trash",onSelect:()=>{const a=e(D);a&&E(a)}},{label:e(l)("common.chat.newChat"),color:"primary",icon:"i-lucide-sparkles",onSelect:()=>F()}],ui:{group:"flex flex-col gap-1 p-2",itemLeadingIcon:"size-4"},content:{side:"bottom",align:"center"}},{default:d(()=>[c(m,{label:e(D)?.title||e(l)("common.chat.currentChat"),variant:"ghost",color:"neutral",size:"sm",class:"px-3 py-2"},{default:d(()=>[t("span",Ie,f(e(D)?.title||e(l)("common.chat.currentChat")),1),c(u,{name:"i-lucide-chevron-down",class:"size-5"})]),_:1},8,["label"])]),_:1},8,["items"])):(s(),g(m,{key:0,variant:"ghost",color:"neutral",size:"sm",class:"px-3 py-2"},{default:d(()=>[t("span",qe,f(e(l)("common.chat.newChat")),1)]),_:1}))])])),c(X,{open:v.value,"onUpdate:open":o[3]||(o[3]=a=>v.value=a),side:"left",ui:{content:"!w-fit flex-0 max-w-fit"}},{content:d(()=>[!e(y).length&&!e(w)?(s(),r("div",Oe,[t("div",Ge,[c(u,{name:"i-lucide-message-circle",size:"lg",class:"text-gray-400"})]),t("p",null,f(e(l)("common.chat.noChats")),1),t("p",Je,f(e(l)("common.chat.noChatsSubtitle")),1)])):(s(),g(K,{key:1,class:"h-full"},{default:d(()=>[t("div",Qe,[(s(!0),r(_,null,x(e(y),a=>(s(),r("div",{key:a.key,class:"flex flex-col gap-2"},[t("div",He,f(a.label),1),t("div",We,[(s(!0),r(_,null,x(a.items,n=>(s(),r("div",{key:n.id,class:"group relative"},[c(m,{label:n.title,ui:{base:"flex justify-between w-full gap-2 cursor-pointer pr-10 relative w-full"},variant:n.id===e(h)?"soft":"ghost",color:n.id===e(h)?"primary":"neutral",onClick:T=>U(n)},{default:d(()=>[t("span",Xe,f(n.title||e(l)("common.chat.newChat")),1)]),_:2},1032,["label","variant","color","onClick"]),c(V,{items:[j(n)],ui:{content:"w-3",group:"flex flex-col gap-1 p-2",itemLeadingIcon:"size-4"},content:{side:"right",align:"start"}},{default:d(()=>[c(u,{name:"i-lucide-ellipsis",size:14,class:q(["absolute top-1/2 right-3 z-10 h-8 -translate-y-1/2 cursor-pointer px-2.5 py-1.5 opacity-0 transition-opacity group-hover:opacity-100",{"opacity-100":n.id===e(h)}]),onClick:o[2]||(o[2]=R(()=>{},["stop"]))},null,8,["class"])]),_:2},1032,["items"])]))),128))])]))),128)),!e(y).length&&e(w)?(s(),r("div",Ye,[(s(),r(_,null,x(3,a=>t("div",{key:`group-${a}`,class:"flex flex-col gap-2"},[t("div",Ze,[c(S,{class:"h-4 w-16"})]),t("div",et,[(s(!0),r(_,null,x(a===1?3:a===2?2:1,n=>(s(),g(S,{key:`item-${a}-${n}`,class:"h-10 w-full rounded-md"}))),128))])])),64))])):z("",!0)])]),_:1}))]),_:1},8,["open"])])]),_:1})}}}),ht=ze(tt,[["__scopeId","data-v-25e7822b"]]),_t=he("chat",()=>{const b=O(null);return{pendingConversation:b,setPendingConversation:p=>{b.value=p},clearPendingConversation:()=>{b.value=null},getPendingConversation:()=>b.value}});export{ht as _,_t as u};
