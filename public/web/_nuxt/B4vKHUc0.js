import{d as N,e as j,ap as D,au as G,r as I,i as M,aK as v,j as T,c as u,o as m,k as q,q as e,m as o,z as A,t as a,x as l,l as n,D as K,_ as O,y as p,B as R}from"#entry";import{_ as H}from"./Brlt-NDg.js";import J from"./CDSfhndf.js";import{_ as Q}from"./Ds48qA85.js";import{o as W,p as X}from"./BdGqAD-s.js";import{c as Y,a as Z}from"./BUyfW8JT.js";import"./DoL5-2Ox.js";import"./DaWZu8wl.js";const ee={class:"extension-profiles-container pb-8"},te={key:0,class:"flex h-60 items-center justify-center"},se={key:1,class:"space-y-4"},oe={class:"text-lg font-semibold"},ae={class:"bg-muted space-y-4 rounded-lg p-4"},le={class:"text-sm font-medium"},ne={class:"text-muted-foreground text-sm"},re={key:0,class:"flex flex-1 items-center justify-between gap-4"},ie={class:"font-mono text-sm"},ce={key:1,class:"flex flex-1 flex-col items-start gap-4"},fe={class:"flex gap-3"},me={class:"space-y-4"},pe={class:"text-lg font-semibold"},de={class:"space-y-1"},_e={href:"https://www.buildingai.cc",target:"_blank",class:"text-primary hover:underline"},ue={class:"flex gap-3 pt-4"},Ie=N({__name:"index",setup(xe){const{t}=j(),V=D(),s=G({platformSecret:"",platformInfo:{}}),x=I(!1),i=I(""),F=Y({platformSecret:Z()}),b={root:"flex items-center gap-4",label:"min-w-20 flex-shrink-0"},C=M(()=>s.platformInfo&&Object.keys(s.platformInfo).length>0),{isLock:c,lockFn:g}=v(async()=>{try{const r=await W();s.platformInfo=r.platformInfo||{},s.platformSecret=r.platformSecret||"",x.value=!1,i.value=""}catch(r){console.error("Get platform info failed:",r)}}),y=async r=>{await X({platformSecret:r}),V.success(t("extensions.profiles.setSecretSuccess")),await g()},{isLock:k,lockFn:U}=v(async()=>{try{await y(s.platformSecret)}catch(r){console.error("Failed to set platform secret:",r)}}),$=()=>{i.value="",x.value=!0},z=()=>{x.value=!1,i.value=""},{isLock:h,lockFn:B}=v(async()=>{try{await y(i.value)}catch(r){console.error("Failed to save secret:",r)}});return T(()=>g()),(r,f)=>{const E=A,P=K,d=H,_=O,w=J,L=Q;return m(),u("div",ee,[e(c)?(m(),u("div",te,[o(E,{name:"i-ph-spinner-gap-bold",class:"text-primary size-8 animate-spin"})])):e(C)?(m(),u("div",se,[a("h3",oe,l(e(t)("extensions.profiles.platformInfo")),1),a("div",ae,[o(d,{label:e(t)("extensions.profiles.platformIcon"),ui:b},{default:n(()=>[o(P,{src:e(s).platformInfo?.websiteIcon,class:"size-10"},null,8,["src"])]),_:1},8,["label"]),o(d,{label:e(t)("extensions.profiles.platformName"),ui:b},{default:n(()=>[a("div",le,l(e(s).platformInfo?.websiteName),1)]),_:1},8,["label"]),o(d,{label:e(t)("extensions.profiles.appCount"),ui:b},{default:n(()=>[a("div",ne,l(e(s).platformInfo?.appCount),1)]),_:1},8,["label"]),o(d,{label:e(t)("extensions.profiles.platformSecret"),ui:{root:"flex items-baseline gap-4",label:"min-w-20 flex-shrink-0"}},{default:n(()=>[e(x)?(m(),u("div",ce,[o(w,{modelValue:e(i),"onUpdate:modelValue":f[0]||(f[0]=S=>R(i)?i.value=S:null),placeholder:e(t)("extensions.profiles.platformSecretPlaceholder"),class:"w-90 flex-1"},null,8,["modelValue","placeholder"]),a("div",fe,[o(_,{color:"primary",loading:e(h),disabled:e(c),onClick:e(B)},{default:n(()=>[p(l(e(t)("extensions.profiles.saveSecret")),1)]),_:1},8,["loading","disabled","onClick"]),o(_,{variant:"outline",disabled:e(h)||e(c),onClick:z},{default:n(()=>[p(l(e(t)("extensions.profiles.cancelEdit")),1)]),_:1},8,["disabled"])])])):(m(),u("div",re,[a("div",ie,l(e(s).platformSecret||e(t)("extensions.profiles.emptySecret")),1),o(_,{variant:"outline",disabled:e(h)||e(c),onClick:$},{default:n(()=>[p(l(e(s).platformSecret?e(t)("extensions.profiles.editSecret"):e(t)("extensions.profiles.setSecret")),1)]),_:1},8,["disabled"])]))]),_:1},8,["label"])])])):(m(),q(L,{key:2,schema:e(F),state:e(s),class:"space-y-6",onSubmit:e(U)},{default:n(()=>[a("div",me,[a("h3",pe,l(e(t)("extensions.profiles.platformSecret")),1),o(d,{label:e(t)("extensions.profiles.platformSecret"),name:"platformSecret",error:e(s).platformSecret&&!e(s).platformInfo?e(t)("extensions.profiles.secretError"):!1},{help:n(()=>[a("div",de,[a("div",null,[p(l(e(t)("extensions.profiles.help"))+" ",1),a("a",_e,l(e(t)("extensions.profiles.howToGetSecret")),1)])])]),default:n(()=>[o(w,{modelValue:e(s).platformSecret,"onUpdate:modelValue":f[1]||(f[1]=S=>e(s).platformSecret=S),placeholder:e(t)("extensions.profiles.platformSecretPlaceholder"),size:"lg",class:"w-sm"},null,8,["modelValue","placeholder"])]),_:1},8,["label","error"])]),a("div",ue,[o(_,{color:"primary",size:"lg",type:"submit",loading:e(k),disabled:e(c)},{default:n(()=>[p(l(e(t)("console-common.save")),1)]),_:1},8,["loading","disabled"]),o(_,{variant:"outline",size:"lg",disabled:e(k)||e(c),onClick:f[2]||(f[2]=S=>e(s).platformSecret="")},{default:n(()=>[p(l(e(t)("console-common.reset")),1)]),_:1},8,["disabled"])])]),_:1},8,["schema","state","onSubmit"]))])}}});export{Ie as default};
