import Z from"./cd55qm53.js";import{_ as ee}from"./D_3bTjYR.js";import{d as te,i as le,bu as se,s as q,p as oe,b2 as ae,b3 as ne,aM as ie,n as A,f as g,o as s,w as d,x as t,t as c,c as r,y as z,T as ce,g as e,_ as re,A as de,B as ue,z as f,F as _,E as x,v as O,C as R,l as me,aX as fe,h as B,aO as M,ar as N,bb as pe,O as he}from"#entry";import{_ as _e}from"./BTN3Ax-V.js";import{_ as xe}from"./CWpJD8K1.js";import{_ as ve}from"./BkF8DltG.js";import{_ as ge}from"./l1ozQanh.js";import{g as ye,h as be,i as Ce}from"./C457VaE0.js";import{g as we}from"./eeyg4-1U.js";import{u as ke}from"./fhkze2Jn.js";import{u as I}from"./oxig-ZyS.js";import{d as Se}from"./MCK2d4XT.js";import{_ as ze}from"./Bzv9SrOl.js";const $e={class:"relative h-full flex-1"},De={key:0,class:"flex h-full min-h-0 w-[240px] flex-col"},Ve={class:"border-border/50 flex gap-2 border-b px-1 py-3"},Te={class:"h-full flex-1 overflow-hidden"},Ue={key:0,class:"text-muted-foreground flex h-full flex-col items-center justify-center text-center text-sm"},Ae={class:"mb-2"},Be={class:"text-xs"},Me={class:"flex flex-col gap-4 space-y-1 py-4 pr-4 pl-2"},Ne={class:"text-muted-foreground px-2 py-1 text-xs font-medium"},Pe={class:"flex flex-col gap-1"},Ee={class:"block flex-1 truncate text-left"},Le={key:0,class:"flex flex-col gap-4 py-4"},Fe={class:"px-2 py-1"},je={class:"flex flex-col gap-1"},Ke={key:0,class:"absolute top-2 left-2 z-50 flex items-center gap-2"},Oe={class:"group relative hidden sm:block"},Re={class:"block flex-1 truncate text-left text-sm"},Ie={class:"block flex-1 truncate text-left text-sm"},qe={key:0,class:"text-muted-foreground flex h-full flex-col items-center justify-center text-center text-sm"},Ge={class:"mb-2"},Qe={class:"text-xs"},Xe={class:"flex flex-col gap-4 space-y-1 py-4 pr-4 pl-2"},He={class:"text-muted-foreground px-2 py-1 text-xs font-medium"},Je={class:"flex flex-col gap-1"},We={class:"block flex-1 truncate text-left"},Ye={key:0,class:"flex flex-col gap-4 py-4"},Ze={class:"px-2 py-1"},et={class:"flex flex-col gap-1"},tt=te({inheritAttrs:!1,__name:"chats-chats",async setup(b){let C,$;const{t:l}=le(),p=ke(),P=se("(max-width: 768px)"),v=q(!1);oe(P,i=>{i?p.chatSidebarVisible=!1:(v.value=!1,p.chatSidebarVisible=!0)},{immediate:!1});const{data:w,pending:k}=([C,$]=ae(()=>ne("chats",()=>ye({page:1,pageSize:50}),{lazy:!1})),C=await C,$(),C),E=ie(),h=A(()=>E.name==="chat-id"?E.params.id:""),G=Z,Q=ee,y=A(()=>w.value?.items?.length?we(w.value.items,"updatedAt",l):[]),D=A(()=>!w.value?.items||!h.value?null:w.value.items.find(i=>i.id===h.value)||null);async function X(i){const o=me(i.title);try{const u=fe({setup(){return()=>B("div",{class:"py-2"},[B(Q,{label:l("common.chat.chatTitleLabel"),size:"lg",required:!0,error:o.value.trim()?"":l("common.chat.chatTitleRequired")},{default:()=>B(G,{modelValue:o.value,"onUpdate:modelValue":m=>{o.value=m},placeholder:l("common.chat.chatTitlePlaceholder"),maxlength:50,class:"w-full",onKeyup:m=>{m.key==="Enter"&&o.value.trim()}})})])}});await I({title:l("common.chat.editChatTitle"),content:u,confirmText:l("common.save"),cancelText:l("common.cancel"),color:"primary",ui:{content:"!w-sm"}}),o.value.trim()&&o.value!==i.title&&(await be(i.id,{title:o.value}),M("chats"),M(`chat-detail-${i.id}`))}catch(u){console.log("User cancelled edit operation:",u)}}async function L(i){try{await I({color:"error",title:l("common.chat.confirmDelete"),content:l("common.chat.confirmDeleteMessage"),confirmText:l("common.chat.confirmDeleteAction"),cancelText:l("common.cancel"),ui:{content:"!w-sm"}})&&(await Ce(i.id),await M("chats")),N("/")}catch(o){console.log("User cancelled delete operation or delete failed:",o)}}function V(i){N(`/chat/${i.id}`)}function F(){N("/")}const H=()=>{P.value?(v.value=!0,p.chatSidebarVisible=!1):(v.value=!1,p.chatSidebarVisible=!0)};function J(i,o){(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),V(o))}const j=i=>[{label:l("common.edit"),color:"primary",icon:"i-lucide-pencil",onSelect:()=>X(i)},{label:l("common.delete"),color:"error",icon:"i-lucide-trash",onSelect:()=>L(i)}];return Se({o:()=>v.value=!v.value}),(i,o)=>{const u=ue,m=re,T=_e,S=xe,K=ve,W=ge,Y=pe;return s(),g(Y,null,{default:d(()=>[t("div",$e,[c(ce,{name:"sidebar"},{default:d(()=>[e(p).chatSidebarVisible?(s(),r("div",De,[t("div",Ve,[c(m,{ui:{base:"w-full"},color:"primary",variant:"soft",onClick:F},{default:d(()=>[c(u,{name:"i-lucide-sparkles",class:"mr-2 size-4"}),de(" "+f(e(l)("common.chat.newChat")),1)]),_:1}),c(m,{color:"neutral",variant:"ghost",class:"p-2",onClick:o[0]||(o[0]=a=>e(p).chatSidebarVisible=!1)},{default:d(()=>[c(u,{name:"i-lucide-history",class:"size-5"})]),_:1})]),t("div",Te,[!e(y).length&&!e(k)?(s(),r("div",Ue,[t("div",Ae,[c(u,{name:"i-lucide-message-circle",size:"lg",class:"text-muted-foreground"})]),t("p",null,f(e(l)("common.chat.noChats")),1),t("p",Be,f(e(l)("common.chat.noChatsSubtitle")),1)])):(s(),g(K,{key:1,class:"grid h-full"},{default:d(()=>[t("div",Me,[(s(!0),r(_,null,x(e(y),a=>(s(),r("div",{key:a.key,class:"flex flex-col gap-2"},[t("div",Ne,f(a.label),1),t("div",Pe,[(s(!0),r(_,null,x(a.items,n=>(s(),r("div",{key:n.id,class:"group relative"},[c(m,{label:n.title,ui:{base:"flex justify-between w-full gap-2 cursor-pointer pr-10 relative w-full"},variant:n.id===e(h)?"soft":"ghost",color:n.id===e(h)?"primary":"neutral",onClick:U=>V(n),onKeydown:U=>J(U,n)},{default:d(()=>[t("span",Ee,f(n.title||e(l)("common.chat.newChat")),1)]),_:2},1032,["label","variant","color","onClick","onKeydown"]),c(T,{items:[j(n)],ui:{content:"w-3",group:"flex flex-col gap-1 p-2",itemLeadingIcon:"size-4"},content:{side:"right",align:"start"}},{default:d(()=>[c(u,{name:"i-lucide-ellipsis",size:14,class:R(["absolute top-1/2 right-3 z-10 h-8 -translate-y-1/2 cursor-pointer px-2.5 py-1.5 opacity-0 transition-opacity group-hover:opacity-100",{"opacity-100":n.id===e(h)}]),onClick:o[1]||(o[1]=O(()=>{},["stop"]))},null,8,["class"])]),_:2},1032,["items"])]))),128))])]))),128)),!e(y).length&&e(k)?(s(),r("div",Le,[(s(),r(_,null,x(3,a=>t("div",{key:`group-${a}`,class:"flex flex-col gap-2"},[t("div",Fe,[c(S,{class:"h-4 w-16"})]),t("div",je,[(s(!0),r(_,null,x(a===1?3:a===2?2:1,n=>(s(),g(S,{key:`item-${a}-${n}`,class:"h-10 w-full rounded-md"}))),128))])])),64))])):z("",!0)])]),_:1}))])])):z("",!0)]),_:1}),e(p).chatSidebarVisible?z("",!0):(s(),r("div",Ke,[c(m,{color:"neutral",variant:"ghost",size:"lg",class:"p-2",onClick:H},{default:d(()=>[c(u,{name:"i-lucide-history",class:"size-5"})]),_:1}),o[4]||(o[4]=t("div",{class:"text-muted-foreground mx-1 hidden sm:block"},"/",-1)),t("div",Oe,[e(h)?(s(),g(T,{key:1,items:[{label:e(l)("common.delete"),color:"error",icon:"i-lucide-trash",onSelect:()=>{const a=e(D);a&&L(a)}},{label:e(l)("common.chat.newChat"),color:"primary",icon:"i-lucide-sparkles",onSelect:()=>F()}],ui:{group:"flex flex-col gap-1 p-2",itemLeadingIcon:"size-4"},content:{side:"bottom",align:"center"}},{default:d(()=>[c(m,{label:e(D)?.title||e(l)("common.chat.currentChat"),variant:"ghost",color:"neutral",size:"sm",class:"px-3 py-2"},{default:d(()=>[t("span",Ie,f(e(D)?.title||e(l)("common.chat.currentChat")),1),c(u,{name:"i-lucide-chevron-down",class:"size-5"})]),_:1},8,["label"])]),_:1},8,["items"])):(s(),g(m,{key:0,variant:"ghost",color:"neutral",size:"sm",class:"px-3 py-2"},{default:d(()=>[t("span",Re,f(e(l)("common.chat.newChat")),1)]),_:1}))])])),c(W,{open:v.value,"onUpdate:open":o[3]||(o[3]=a=>v.value=a),side:"left",ui:{content:"!w-fit flex-0 max-w-fit"}},{content:d(()=>[!e(y).length&&!e(k)?(s(),r("div",qe,[t("div",Ge,[c(u,{name:"i-lucide-message-circle",size:"lg",class:"text-gray-400"})]),t("p",null,f(e(l)("common.chat.noChats")),1),t("p",Qe,f(e(l)("common.chat.noChatsSubtitle")),1)])):(s(),g(K,{key:1,class:"h-full"},{default:d(()=>[t("div",Xe,[(s(!0),r(_,null,x(e(y),a=>(s(),r("div",{key:a.key,class:"flex flex-col gap-2"},[t("div",He,f(a.label),1),t("div",Je,[(s(!0),r(_,null,x(a.items,n=>(s(),r("div",{key:n.id,class:"group relative"},[c(m,{label:n.title,ui:{base:"flex justify-between w-full gap-2 cursor-pointer pr-10 relative w-full"},variant:n.id===e(h)?"soft":"ghost",color:n.id===e(h)?"primary":"neutral",onClick:U=>V(n)},{default:d(()=>[t("span",We,f(n.title||e(l)("common.chat.newChat")),1)]),_:2},1032,["label","variant","color","onClick"]),c(T,{items:[j(n)],ui:{content:"w-3",group:"flex flex-col gap-1 p-2",itemLeadingIcon:"size-4"},content:{side:"right",align:"start"}},{default:d(()=>[c(u,{name:"i-lucide-ellipsis",size:14,class:R(["absolute top-1/2 right-3 z-10 h-8 -translate-y-1/2 cursor-pointer px-2.5 py-1.5 opacity-0 transition-opacity group-hover:opacity-100",{"opacity-100":n.id===e(h)}]),onClick:o[2]||(o[2]=O(()=>{},["stop"]))},null,8,["class"])]),_:2},1032,["items"])]))),128))])]))),128)),!e(y).length&&e(k)?(s(),r("div",Ye,[(s(),r(_,null,x(3,a=>t("div",{key:`group-${a}`,class:"flex flex-col gap-2"},[t("div",Ze,[c(S,{class:"h-4 w-16"})]),t("div",et,[(s(!0),r(_,null,x(a===1?3:a===2?2:1,n=>(s(),g(S,{key:`item-${a}-${n}`,class:"h-10 w-full rounded-md"}))),128))])])),64))])):z("",!0)])]),_:1}))]),_:1},8,["open"])])]),_:1})}}}),ht=ze(tt,[["__scopeId","data-v-25e7822b"]]),_t=he("chat",()=>{const b=q(null);return{pendingConversation:b,setPendingConversation:p=>{b.value=p},clearPendingConversation:()=>{b.value=null},getPendingConversation:()=>b.value}});export{ht as _,_t as u};
