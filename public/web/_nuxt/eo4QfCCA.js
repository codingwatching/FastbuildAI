import{u as J,_ as K}from"./DW5lQfw1.js";import{_ as H}from"./dprA9M0_.js";import{_ as W}from"./Cl7IAbFu.js";import{d as X,a_ as Y,i as Z,n as C,s as u,b2 as ee,q as te,c as S,x as s,t as I,C as F,g as e,y as d,z as a,w as N,D as j,F as oe,E as se,f as b,G as ie,b3 as re,o as l,_ as ne,v as ae,A as T,j as le,at as ce,aO as pe,ar as me}from"#entry";import{_ as ue}from"./DWe_-2t3.js";import{d as de,e as fe,f as _e}from"./C457VaE0.js";import{u as he}from"./fhkze2Jn.js";import"./cd55qm53.js";import"./D_3bTjYR.js";import"./D9sX2Qi6.js";import"./BTN3Ax-V.js";import"./BKdtdX-7.js";import"./CtosDvS0.js";import"./kRIii9yh.js";import"./DxD6Ynfo.js";import"./BhB8DUPm.js";import"./C6Y-ieo6.js";import"./zlMhJk0P.js";import"./DeCyaT7k.js";import"./D4e4FYoF.js";import"./BCcN9pii.js";import"./CMKSl-Ng.js";import"./CuVAPZQ8.js";import"./psimjGaX.js";import"./B3rWqoNg.js";import"./EK7Wbu3-.js";import"./CWpJD8K1.js";import"./BkF8DltG.js";import"./jsPNKUA0.js";import"./Bzv9SrOl.js";import"./l1ozQanh.js";import"./B3XNqw4u.js";import"./BVraOlsu.js";import"./BxwUS5gW.js";import"./eeyg4-1U.js";import"./oxig-ZyS.js";import"./MCK2d4XT.js";import"./o4ws_w_T.js";import"./CCoSr_X_.js";import"./Cub7JM7Q.js";import"./Be9qZ8Md.js";import"./B0g9CpkI.js";import"./DNb4RPhn.js";import"./DBEJUH-Z.js";import"./Dgxt_juz.js";import"./Y499mysc.js";import"./RPflLnqr.js";import"./TrJvDfxI.js";import"./4jjeIyfe.js";import"./shdu-Ndv.js";import"./DWy_CFG9.js";import"./td2xDKru.js";import"./BEK00iAE.js";const ge={class:"ai-chat dark:bg-muted/50 flex h-full min-h-0 items-center justify-center pl-0"},ye={class:"bg-background flex h-full min-h-0 flex-1 flex-col items-center justify-center rounded-lg"},ve={class:"flex h-full w-full max-w-[800px] flex-col items-center justify-center"},xe={class:"mb-8 text-center"},Ce={class:"mb-2 flex items-center justify-center text-2xl font-bold"},Se={class:"text-accent-foreground text-sm"},Ie={class:"w-full px-4"},be={key:0,class:"my-4 flex w-full flex-wrap justify-center gap-3"},we={class:"mr-1"},ke={class:"w-full p-2 text-center text-xs text-gray-400"},Me={class:"flex flex-col items-center justify-center gap-1"},Ve={class:"flex items-center justify-center gap-2"},Ue=["href"],Ae={key:0},Ne={class:"space-x-1"},je=["href"],Lt=X({__name:"index",async setup(ze){let f,z;const r=Y(),{t:$}=Z(),w=he(),D=J(),p=C(()=>w.selectedModel?.id||""),k=u(""),i=u([]),_=u(!1),c=u(),h=u(),g=u([]),{data:y}=([f,z]=ee(()=>re("chat-config",()=>fe())),f=await f,z(),f),E=C(()=>y.value?.suggestionsEnabled??!0),Q=C(()=>y.value?.suggestions||[]),M=C(()=>y.value?.welcomeInfo||{});function P(t){g.value=t}function V(){try{const t=JSON.parse(localStorage.getItem("mcpIds")||"[]");return Array.isArray(t)?t:[]}catch{return[]}}function L(t){t.length?localStorage.setItem("mcpIds",JSON.stringify(t)):localStorage.removeItem("mcpIds")}const q=async()=>{try{const t=await de();if(!t)return;c.value=t,h.value=t.id,_.value=V().includes(h.value||"")}catch(t){console.error("Failed to fetch quick menu:",t)}};async function B(t){try{if(!p.value&&le().isLogin){ce().warning($("ai-chat.frontend.selectModel"));return}const o=await _e({title:""});D.setPendingConversation({id:o.id,modelId:p.value,title:t,files:g.value.length>0?g.value:void 0}),pe("chats"),await me({path:`/chat/${o.id}`})}catch(o){console.error("Failed to create conversation:",o)}}const G=()=>{if(!h.value)return;Array.isArray(i.value)||(i.value=[]);const t=V(),o=h.value,U=t.includes(o),v=i.value.includes(o);if(!U&&!v)t.push(o),v||i.value.push(o),L(t);else{const A=t.filter(m=>m!==o),x=i.value.filter(m=>m!==o);L(A),i.value=x}_.value=V().includes(o)};return te(()=>{q()}),(t,o)=>{const U=K,v=H,A=W,x=ie,m=ne,O=ue;return l(),S("div",ge,[s("div",{class:F(["border-border/50 h-full flex-none border-r pl-0",{"border-none":!e(w).chatSidebarVisible}])},[I(U)],2),s("div",ye,[s("div",ve,[s("div",xe,[s("h1",Ce,a(e(M).title),1),s("p",Se,a(e(M).description),1)]),s("div",Ie,[I(O,{class:"[view-transition-name:chat-prompt]",modelValue:e(k),"onUpdate:modelValue":o[2]||(o[2]=n=>j(k)?k.value=n:null),"file-list":e(g),rows:2,needAuth:!0,attachmentSizeLimit:e(y)?.attachmentSizeLimit,onSubmit:B,"onUpdate:fileList":P},{"panel-left":N(()=>[I(v,{modelValue:e(p),"onUpdate:modelValue":o[0]||(o[0]=n=>j(p)?p.value=n:null),modelId:e(p)||"",supportedModelTypes:["llm"],"show-billingRule":!0,"open-local-storage":!0,placeholder:"选择AI模型开始对话",onChange:e(w).setSelectedModel},null,8,["modelValue","modelId","onChange"]),I(A,{modelValue:e(i),"onUpdate:modelValue":o[1]||(o[1]=n=>j(i)?i.value=n:null),mcpIds:e(i)||[],placeholder:"选择MCP..."},null,8,["modelValue","mcpIds"]),e(c)?(l(),b(m,{key:0,color:e(_)?"primary":"neutral",variant:"ghost",icon:e(c)?.icon?"":"tabler:tool",ui:{leadingIcon:"size-4"},class:F({"bg-primary/10":e(_)}),onClick:ae(G,["stop"])},{default:N(()=>[e(c)?.icon?(l(),b(x,{key:0,src:e(c)?.icon,ui:{root:"size-4 rounded-md"}},null,8,["src"])):d("",!0),T(" "+a(e(c)?.alias||e(c)?.name),1)]),_:1},8,["color","icon","class"])):d("",!0)]),_:1},8,["modelValue","file-list","attachmentSizeLimit"])]),e(E)?(l(),S("div",be,[(l(!0),S(oe,null,se(e(Q),(n,R)=>(l(),b(m,{key:R,variant:"outline",color:"neutral",size:"md",onClick:Le=>B(n.text)},{default:N(()=>[s("span",we,a(n.icon),1),T(" "+a(n.text),1)]),_:2},1032,["onClick"]))),128))])):d("",!0)]),s("div",ke,[s("div",Me,[s("span",null,a(e(M).footer),1),s("div",Ve,[s("a",{href:e(r).siteConfig?.copyright.url,target:"_blank",rel:"noopener noreferrer",class:"hover:text-primary flex items-center justify-center gap-1 transition-colors"},[e(r).siteConfig?.copyright.iconUrl?(l(),b(x,{key:0,src:e(r).siteConfig?.copyright.iconUrl,ui:{root:"size-4 rounded-md"}},null,8,["src"])):d("",!0),s("span",null,a(e(r).siteConfig?.copyright.displayName),1)],8,Ue),e(r).siteConfig?.copyright.displayName||e(r).siteConfig?.copyright.iconUrl?(l(),S("span",Ae,"|")):d("",!0),s("span",Ne,[s("span",null,a(e(r).siteConfig?.copyright.copyrightText),1),s("a",{class:"text-primary font-bold",href:e(r).siteConfig?.copyright.copyrightUrl,target:"_blank"},a(e(r).siteConfig?.copyright.copyrightBrand),9,je)])])])])])])}}});export{Lt as default};
