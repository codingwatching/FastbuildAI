const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./HrIRDE0k.js","./cd55qm53.js","./n4aLOYdS.js","./o4ws_w_T.js","./D19QCKnC.js","./LSmoYDCw.js","./B3XNqw4u.js","./zlMhJk0P.js","./CuVAPZQ8.js","./BhB8DUPm.js","./BVraOlsu.js","./BxwUS5gW.js","./MCK2d4XT.js","./EK7Wbu3-.js","./BZx839BO.js","./oxig-ZyS.js","./B2OLE8Xm.js","./DBiaUVBh.js","./BcdoDlDI.js","./shdu-Ndv.js","./Be9qZ8Md.js","./BKdtdX-7.js","./CtosDvS0.js","./kRIii9yh.js","./DxD6Ynfo.js","./C6Y-ieo6.js","./DeCyaT7k.js","./D4e4FYoF.js","./BCcN9pii.js","./CMKSl-Ng.js","./psimjGaX.js","./CxvgZo8z.js","./DbJXFYrx.js","./bvMLy1sv.js","./D9sX2Qi6.js","./CAQVAH0V.js","./Deu6qIfg.js","./D_3bTjYR.js","./4jjeIyfe.js","./D5TWRm5k.js","./DUJH4dqr.js","./DWy_CFG9.js","./td2xDKru.js","./RPflLnqr.js","./TrJvDfxI.js","./jsPNKUA0.js","./Bzv9SrOl.js","./meHCBXcx.js","./UqhBTNL6.js","./BQXu7A78.js","./BtLy_Oaq.js","./FTderXKt.js","./DaWZu8wl.js","./BQPuzhnW.js","./DD9epg4Y.js","./CaG9fOMa.js","./D0njpKrm.js","./DNb4RPhn.js","./DBEJUH-Z.js","./BEK00iAE.js"])))=>i.map(i=>d[i]);
import{d as H,V as J,s as x,p as W,aW as oe,f as U,o as c,w as C,r as se,t as l,_ as K,c as k,y as z,B as Q,g as o,z as $,x as n,D as q,F as Y,E as Z,A as le,W as D,X as S,at as ne,i as ie,a2 as re,q as ce,v as N}from"#entry";import ee from"./cd55qm53.js";import{_ as de}from"./shdu-Ndv.js";import{_ as ue}from"./Be9qZ8Md.js";import{a as me}from"./BZx839BO.js";import{_ as pe}from"./CBP5wIdr.js";import{_ as ge}from"./B8dIIAdq.js";import{_ as fe}from"./BkF8DltG.js";import{u as X,v as _e,w as he,x as ve,y as ye}from"./meHCBXcx.js";import{u as be}from"./oxig-ZyS.js";import"./BKdtdX-7.js";import"./CtosDvS0.js";import"./kRIii9yh.js";import"./DxD6Ynfo.js";import"./BhB8DUPm.js";import"./C6Y-ieo6.js";import"./zlMhJk0P.js";import"./DeCyaT7k.js";import"./D4e4FYoF.js";import"./BCcN9pii.js";import"./CMKSl-Ng.js";import"./CuVAPZQ8.js";import"./psimjGaX.js";import"./CAQVAH0V.js";import"./BstbYvQo.js";import"./jsPNKUA0.js";import"./Bzv9SrOl.js";const we={key:0,class:"text-sm"},ke={key:1,class:"text-dimmed flex-none text-sm"},$e={class:"flex flex-col gap-2 p-2"},xe={key:0,class:"flex flex-col gap-1"},Te={key:1,class:"flex h-30 flex-col items-center justify-center gap-2"},Ve={class:"text-muted text-sm"},Ie=H({__name:"tag-select",props:{modelValue:{default:()=>[]},type:{default:"app"}},emits:["update:modelValue","change","close"],setup(G,{emit:P}){const M=D(()=>S(()=>import("./HrIRDE0k.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url)),T=P,E=G,p=oe(E,"modelValue",T),R=J(),g=x([]),i=x([]),t=x(""),r=x(!1),_=async()=>{const a=await me({type:E.type});g.value=a,L()},V=a=>{i.value.includes(a)?i.value=i.value.filter(u=>u.id!==a.id):i.value.push(a),p.value=i.value.map(u=>u.id),T("change",a)},d=async()=>{await R.create(M).open({type:E.type}).result,await _()},L=()=>{if(!g.value?.length){i.value=[];return}i.value=g.value.filter(a=>p.value?.includes(a.id))},B=()=>{p.value=[],i.value=[],T("change",[])};return W(()=>p.value,()=>{L()},{deep:!1}),W(r,a=>{a?_():T("close")}),(a,u)=>{const I=Q,A=K,O=ee,j=de,F=ue;return c(),U(F,{open:o(r),"onUpdate:open":u[1]||(u[1]=f=>q(r)?r.value=f:null),content:{align:"center",side:"bottom",sideOffset:8}},{content:C(()=>[n("div",$e,[l(O,{modelValue:o(t),"onUpdate:modelValue":u[0]||(u[0]=f=>q(t)?t.value=f:null),placeholder:a.$t("common.search"),clearable:"",icon:"i-lucide-search",variant:"soft",color:"neutral",ui:{root:"w-full",base:"w-full",trailing:"pr-1"}},null,8,["modelValue","placeholder"]),n("div",null,[o(g).length>0?(c(),k("div",xe,[(c(!0),k(Y,null,Z(o(g),f=>(c(),U(A,{key:f.id,color:"neutral",variant:"ghost",ui:{base:"justify-between"},onClick:e=>V(f)},{default:C(()=>[le($(f.name)+" ",1),o(p).includes(f.id)?(c(),U(I,{key:0,name:"i-lucide-check",class:"size-4"})):z("",!0)]),_:2},1032,["onClick"]))),128))])):z("",!0),o(g).length===0?(c(),k("div",Te,[l(I,{name:"i-lucide-tags",class:"size-5"}),n("span",Ve,$(a.$t("common.tag.noTags")),1)])):z("",!0)]),l(j,{type:"dashed"}),n("div",null,[l(A,{label:a.$t("common.tag.manageTags"),color:"neutral",variant:"ghost",icon:"i-lucide-tags",ui:{base:"w-full"},onClick:d},null,8,["label"])])])]),default:C(()=>[se(a.$slots,"trigger",{},()=>[l(A,{color:"neutral",variant:"outline",ui:{base:"gap-2"}},{default:C(()=>[l(I,{name:"i-lucide-tag",class:"size-4"}),o(p).length>0?(c(),k("span",we,$(o(p).length)+$(a.$t("common.tag.tags")),1)):(c(),k("span",ke,$(a.$t("common.tag.allTags")),1)),o(p).length>0?(c(),U(A,{key:2,color:"neutral",variant:"soft",icon:"i-lucide-x",size:"xs",onClick:B})):z("",!0),l(I,{name:"i-lucide-chevron-down",class:"text-dimmed size-4 shrink-0"})]),_:1})])]),_:3},8,["open"])}}}),Ae={class:"flex w-full flex-col items-center justify-center"},De={class:"bg-background sticky top-0 z-10 flex w-full flex-wrap justify-between gap-4 pb-2"},Se={class:"flex items-center gap-4"},Ce={class:"grid grid-cols-1 gap-6 pt-2 pb-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},Ee={class:"group-hover:text-primary text-foreground mb-3 flex items-center gap-3"},Ue={class:"border-default flex size-10 flex-none items-center justify-center rounded-lg border border-dashed"},Re={class:"truncate text-sm font-medium"},Le={class:"text-muted-foreground mb-6 pr-8 text-xs"},ze={class:"line-clamp-2 overflow-hidden"},Pe={class:"flex items-center gap-2"},ut=H({__name:"list",setup(G){const P=D(()=>S(()=>import("./B2OLE8Xm.js"),__vite__mapDeps([16,2,3,17,18,1,19,20,21,22,23,24,9,25,7,26,27,28,29,8,30,14,31]),import.meta.url)),M=D(()=>S(()=>import("./DbJXFYrx.js"),__vite__mapDeps([32,33,2,34,35,36,37,1,38,39,4,5,6,7,8,9,10,11,12,13,40,41,42,43,44,45,46,47,48]),import.meta.url)),T=D(()=>S(()=>import("./BQXu7A78.js"),__vite__mapDeps([49,2,37,34,40,1,41,42,43,44,45,46,38,50,4,5,6,7,8,9,10,11,12,13,47,51,52,31]),import.meta.url)),E=D(()=>S(()=>import("./BQPuzhnW.js"),__vite__mapDeps([53,2,1,3,54,11,6,7,8,9,55,47,46]),import.meta.url)),p=D(()=>S(()=>import("./D0njpKrm.js"),__vite__mapDeps([56,57,2,22,8,28,29,58,3,40,1,41,42,43,44,45,46,37,34,4,5,6,7,9,10,11,12,13,47,59]),import.meta.url)),R=ne(),{t:g}=ie(),i=J(),t=re({keyword:"",page:1,pageSize:15,tagIds:[],isPublic:void 0}),r=x(!1),_=x(!0),V=x([]),d=async()=>{if(!r.value){r.value=!0,t.page=1;try{const e=await X(t);V.value=e.items||[],_.value=e.totalPages>t.page}catch(e){console.error("获取数据失败:",e),_.value=!1}finally{r.value=!1}}},L=async()=>{if(!(r.value||!_.value)){r.value=!0,t.page!==void 0&&t.page++;try{const e=await X(t);e.items&&e.items.length>0?(V.value.push(...e.items),_.value=e.totalPages>(t.page||0)):_.value=!1}catch(e){t.page!==void 0&&t.page--,console.error("加载更多数据失败:",e)}finally{r.value=!1}}},B=async e=>{try{await be({title:g("console-common.delete"),description:g("ai-agent.backend.desc.delete"),color:"error"}),await _e(e.id);const s=t.page;t.page=1,t.pageSize=V.value.length,await d(),t.page=s,t.pageSize=15,R.success(g("common.message.deleteSuccess"))}catch(s){console.error("删除失败:",s)}},a=async(e=null)=>{await i.create(T).open({id:e}).result&&(t.page=1,t.pageSize=15,await d())},u=async()=>{const e=i.create(E);await e.open().result&&(t.page=1,t.pageSize=15,await d()),e.open()},I=e=>{a(e.id)},A=()=>{a(null)},O=async e=>{try{const s=await he(e.id,"yaml"),h=new Blob([s],{type:"text/yaml;charset=utf-8"}),v=URL.createObjectURL(h),m=document.createElement("a");m.href=v,m.download=`${e.name||"agent"}.yaml`,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(v),R.success("DSL 文件导出成功！")}catch(s){console.error("导出 DSL 失败:",s)}},j=async()=>{await i.create(p).open().result&&(t.page=1,t.pageSize=15,await d())},F=async(e,s)=>{const h=e.tags?.map(w=>w.id)??[],v=s,m=v.filter(w=>!h.includes(w)),b=h.filter(w=>!v.includes(w));m.length===0&&b.length===0||(m.length>0&&await ve(e.id,m),b.length>0&&await ye(e.id,b),await d())},f=async()=>{i.create(M).open()};return ce(()=>d()),(e,s)=>{const h=ee,v=Ie,m=pe,b=K,w=Q,te=ge,ae=fe;return c(),k("div",Ae,[n("div",De,[n("div",Se,[l(h,{modelValue:o(t).keyword,"onUpdate:modelValue":s[0]||(s[0]=y=>o(t).keyword=y),placeholder:e.$t("ai-agent.backend.search.placeholder"),class:"w-80",onChange:d},null,8,["modelValue","placeholder"]),l(v,{modelValue:o(t).tagIds,"onUpdate:modelValue":s[1]||(s[1]=y=>o(t).tagIds=y),onChange:d},null,8,["modelValue"]),l(m,{modelValue:o(t).isPublic,"onUpdate:modelValue":s[2]||(s[2]=y=>o(t).isPublic=y),items:[{label:e.$t("ai-agent.backend.search.allStatus"),value:void 0},{label:e.$t("ai-agent.backend.configuration.public"),value:!0},{label:e.$t("ai-agent.backend.configuration.private"),value:!1}],placeholder:e.$t("ai-agent.backend.search.filterByStatus"),"label-key":"label","value-key":"value",class:"w-48",onChange:d},null,8,["modelValue","items","placeholder"])]),n("div",null,[l(b,{color:"primary",variant:"ghost",icon:"i-lucide-package",label:e.$t("decorate.openDecorateSettings"),onClick:N(f,["stop"])},null,8,["label"])])]),l(ae,{class:"h-[calc(100vh-9rem)] min-h-0 w-full"},{default:C(()=>[l(te,{loading:o(r),"has-more":o(_),threshold:200,"loading-text":e.$t("common.loading"),"no-more-text":o(t).page!==1?e.$t("common.noMoreData"):" ",onLoadMore:L},{default:C(()=>[n("div",Ce,[n("div",{class:"group border-default relative cursor-pointer rounded-lg border border-dashed p-4 transition-all duration-200 hover:shadow-lg",onClick:A},[n("div",Ee,[n("div",Ue,[l(w,{name:"i-lucide-plus",class:"h-6 w-6"})]),n("h3",Re,$(e.$t("ai-agent.backend.create.title")),1)]),n("div",Le,[n("p",ze,$(e.$t("ai-agent.backend.create.desc")),1)]),n("div",Pe,[l(b,{color:"primary",variant:"ghost",class:"w-full",icon:"i-lucide-package",size:"sm",label:e.$t("ai-agent.backend.create.fromTemplate"),onClick:N(u,["stop"])},null,8,["label"]),l(b,{color:"neutral",variant:"ghost",class:"w-full",icon:"i-lucide-file-up",size:"sm",label:e.$t("ai-agent.backend.dslImport.import"),onClick:N(j,["stop"])},null,8,["label"])])]),(c(!0),k(Y,null,Z(o(V),y=>(c(),U(o(P),{key:y.id,agent:y,onDelete:B,onEdit:I,onExportDsl:O,onUpdateTags:F},null,8,["agent"]))),128))])]),_:1},8,["loading","has-more","loading-text","no-more-text"])]),_:1})])}}});export{ut as default};
