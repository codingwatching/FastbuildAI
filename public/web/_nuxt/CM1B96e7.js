const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./En0G5gNW.js","./AwTBxaf_.js","./HM4rJu8H.js","./AkfmfxUv.js","./BgHJjJs-.js","./B2VzfMOZ.js","./BD4UGzOt.js","./Btvd554H.js","./DuSMYVIA.js","./B2mx0Z2E.js","./cExZJgpp.js","./DHFmmngs.js","./CR1AS2Ry.js","./kRIii9yh.js","./V9POJiZu.js","./D6yWePie.js","./BHhI-3jl.js","./MN31c9CG.js","./u6i9rpSr.js","./XzHi4Tl0.js","./C6Y-ieo6.js","./B-DdbQ-X.js","./CuOaO1Pb.js","./3UOIlTK8.js","./BoUSUkpo.js","./DP8wpnmM.js","./BtIvDPex.js","./CgvJPw28.js","./PUaae8Vl.js","./fQGamG-_.js","./CH6zLhsh.js","./Cb04SOqd.js","./VGKgjfSv.js","./pWePb4LA.js","./Tmc8NqSi.js","./BUyfW8JT.js","./DaWZu8wl.js","./Dx01Lm3C.js"])))=>i.map(i=>d[i]);
import{d as F,b as O,ap as q,e as Q,Q as G,aL as H,s as k,g as J,h as g,i as W,c as X,o as Y,q as m,l,bB as Z,p as o,k as u,x,v as V,_ as ee,R as te,U as oe}from"#entry";import{_ as ae}from"./g_UzmQET.js";import{_ as se}from"./uRcAPhod.js";import le from"./AwTBxaf_.js";import{_ as ne}from"./BumU5Y7p.js";import{_ as ce}from"./D-eRyimW.js";import{_ as re}from"./BTkcJ0P0.js";import{_ as ie}from"./CMkfKxKG.js";import{_ as me}from"./BfmGtGB6.js";import{a as de,d as pe,u as ue,b as _e,c as fe,e as ge}from"./pWePb4LA.js";import{b as be}from"./Tmc8NqSi.js";import{u as he}from"./DkncK-NE.js";import"./CgMDXot0.js";import"./CR1AS2Ry.js";import"./DVnbt8cp.js";import"./DuSMYVIA.js";import"./D6yWePie.js";import"./CuOaO1Pb.js";import"./DHFmmngs.js";import"./BHhI-3jl.js";import"./BgHJjJs-.js";import"./Btvd554H.js";import"./B2mx0Z2E.js";import"./B-DdbQ-X.js";import"./V9POJiZu.js";import"./MN31c9CG.js";import"./BstbYvQo.js";import"./XzHi4Tl0.js";import"./kRIii9yh.js";import"./C6Y-ieo6.js";import"./3UOIlTK8.js";import"./8trvJunN.js";import"./VGKgjfSv.js";import"./DlAUqK2U.js";const ye={class:"flex h-full flex-col gap-4"},ve={class:"flex items-center justify-between gap-4"},Se={class:"flex flex-1 items-center gap-2"},ke={class:"flex items-center gap-2"},xe={class:"flex-1 overflow-y-auto"},Ve={class:"bg-background flex items-center justify-end gap-3 py-4"},Ue={class:"flex items-center gap-1.5"},ct=F({__name:"list",setup(we){const U=te(()=>oe(()=>import("./En0G5gNW.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37]),import.meta.url)),{t:a}=O(),_=q(),b=Q("table"),w=G(),h=ae,A=se,d=H({name:"",templateId:"all"}),n=k([]),y=k([]),{paging:r,getLists:c}=he({fetchFun:de,params:d}),C=J(()=>[{id:"select",accessorKey:"select",header:({table:e})=>g(h,{modelValue:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),"onUpdate:modelValue":t=>{e.toggleAllPageRowsSelected(!!t),$(t)},"aria-label":"Select all"}),cell:({row:e})=>g(h,{modelValue:e.getIsSelected(),"onUpdate:modelValue":t=>{e.toggleSelected(!!t),D(e,t)},"aria-label":"Select row"})},{accessorKey:"name",header:a("ai-secret.backend.list.form.name")},{accessorKey:"template",header:a("ai-secret.backend.list.form.keyType"),cell:({row:e})=>e.original.template.name},{accessorKey:"remark",header:a("ai-secret.backend.list.form.remark")},{accessorKey:"status",header:a("console-common.status")},{accessorKey:"createdAt",header:a("console-common.createAt"),cell:({row:e})=>{const t=e.getValue("createdAt");return g(A,{datetime:t,mode:"datetime"})}},{id:"action",accessorKey:"action",header:a("console-common.operation")}]),I=e=>[{label:a("console-common.edit"),icon:"i-lucide-edit",onClick:()=>{v(e.original.id)}},{label:a("console-common.delete"),icon:"i-lucide-trash",color:"error",onSelect(){R(e.original.id)}}],v=e=>{w.create(U).open({id:e,onSubmit:(i,p)=>{L(i,p)}})},K=()=>{v()},R=async e=>{await pe(e),_.success(a("console-common.deleteSuccess")),c()},T=async e=>{if(!e.original.id){console.error("行数据缺少 ID");return}try{await ue(e.original.id,{status:e.original.status}),_.success(e.original.status?a("console-common.enableSuccess"):a("console-common.disableSuccess")),c()}catch(t){console.error("更新状态失败:",t)}},D=(e,t)=>{if(typeof t=="boolean"){const i=e.original.id;t?n.value.push(i):n.value=n.value.filter(p=>p!==i),console.log(n.value)}},$=e=>{typeof e=="boolean"&&(e?n.value=r.items.map(t=>t.id):n.value=[])},B=async()=>{try{await _e(n.value),n.value=[],b.value?.tableApi.toggleAllPageRowsSelected(!1),_.success(a("console-common.batchDeleteSuccess")),c()}catch(e){console.error("批量删除失败:",e)}},L=async(e,t)=>{t?await fe(t,e):await ge(e),_.success(a("ai-secret.backend.list.edit.submitSuccess")),c()},P=async()=>{try{const e=await be();y.value=e}catch(e){console.error("加载模板列表失败:",e)}},z=()=>{c()};return W(()=>{P(),c()}),(e,t)=>{const i=le,p=ne,f=ee,E=ce,M=re,N=ie,j=me;return Y(),X("div",ye,[m("div",ve,[m("div",Se,[l(i,{modelValue:o(d).name,"onUpdate:modelValue":t[0]||(t[0]=s=>o(d).name=s),placeholder:o(a)("ai-secret.backend.list.placeholder"),onKeyup:Z(o(c),["enter"])},null,8,["modelValue","placeholder","onKeyup"]),l(p,{modelValue:o(d).templateId,"onUpdate:modelValue":[t[1]||(t[1]=s=>o(d).templateId=s),z],items:[{label:o(a)("console-common.all"),value:"all"},...o(y).map(s=>({label:s.name,value:s.id}))],"label-key":"label","value-key":"value",placeholder:o(a)("ai-secret.backend.list.form.keyType"),class:"w-48"},null,8,["modelValue","items","placeholder"])]),m("div",ke,[l(f,{icon:"i-tabler-trash",color:"error",variant:"outline",onClick:B},{default:u(()=>[x(V(o(a)("console-common.batchDelete")),1)]),_:1}),l(f,{color:"primary",icon:"i-lucide-plus",onClick:K},{default:u(()=>[x(V(o(a)("ai-secret.backend.list.add")),1)]),_:1})])]),m("div",xe,[l(N,{ref_key:"table",ref:b,class:"h-full",sticky:"",columns:o(C),data:o(r).items,ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default",tr:"[&:has(>td[colspan])]:hidden"}},{"status-cell":u(({row:s})=>[l(E,{"model-value":!!s.original.status,"onUpdate:modelValue":S=>s.original.status=S?1:0,onChange:S=>T(s)},null,8,["model-value","onUpdate:modelValue","onChange"])]),"action-cell":u(({row:s})=>[l(M,{items:I(s)},{default:u(()=>[l(f,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost"})]),_:1},8,["items"])]),_:1},8,["columns","data"])]),m("div",Ve,[m("div",Ue,[l(j,{page:o(r).page,"onUpdate:page":t[2]||(t[2]=s=>o(r).page=s),size:o(r).pageSize,"onUpdate:size":t[3]||(t[3]=s=>o(r).pageSize=s),total:o(r).total,onChange:o(c)},null,8,["page","size","total","onChange"])])])])}}});export{ct as default};
