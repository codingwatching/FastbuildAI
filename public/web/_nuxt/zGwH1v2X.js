const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BNh1Yf2o.js","./C4ofdRUp.js","./DBiaUVBh.js","./DD9epg4Y.js","./BxwUS5gW.js","./B3XNqw4u.js","./zlMhJk0P.js","./CuVAPZQ8.js","./BhB8DUPm.js","./CaG9fOMa.js","./TQ7Pmmae.js","./uCSZdLLJ.js","./o4ws_w_T.js","./C_Nw1JQK.js","./aRxLHUSx.js","./cd55qm53.js","./D_3bTjYR.js","./D9sX2Qi6.js","./DUJH4dqr.js","./DWy_CFG9.js","./td2xDKru.js","./RPflLnqr.js","./TrJvDfxI.js","./jsPNKUA0.js","./Bzv9SrOl.js","./4jjeIyfe.js","./B_IAV05G.js","./CtosDvS0.js","./CAQVAH0V.js","./BCcN9pii.js","./CMKSl-Ng.js","./Deu6qIfg.js","./DBEJUH-Z.js","./CDB5Iuhz.js","./Cuqwcq71.js","./CjasYwqF.js","./BtLy_Oaq.js","./D19QCKnC.js","./LSmoYDCw.js","./BVraOlsu.js","./MCK2d4XT.js","./EK7Wbu3-.js","./FTderXKt.js","./DaWZu8wl.js","./DQCVCxm_.js","./BgW9doE6.js","./BkF8DltG.js","./Be9qZ8Md.js","./BKdtdX-7.js","./kRIii9yh.js","./DxD6Ynfo.js","./C6Y-ieo6.js","./DeCyaT7k.js","./D4e4FYoF.js","./psimjGaX.js","./B0g9CpkI.js","./BTyuOgdq.js"])))=>i.map(i=>d[i]);
import{d as ue,i as pe,V as ge,at as fe,l as _e,n as M,s as he,aQ as be,p as ve,a2 as O,aN as xe,q as ye,c as h,o as r,x as o,t as n,g as e,D as we,K as Ee,w as p,A as ke,z as c,_ as Ie,B as Ce,F as R,E as F,f as g,y as f,G as $e,bI as De,W as C,X as $}from"#entry";import{_ as Le}from"./DNb4RPhn.js";import Ae from"./cd55qm53.js";import{_ as Te}from"./CBP5wIdr.js";import{_ as Ue}from"./CCoSr_X_.js";import{_ as Ve}from"./o4ws_w_T.js";import{_ as ze}from"./BTN3Ax-V.js";import{_ as Be}from"./B8dIIAdq.js";import{_ as Ne}from"./BkF8DltG.js";import{a as u,E as b,b as j}from"./C_Nw1JQK.js";import{c as Se,k as Pe,l as Me,m as Oe,n as Re,o as Fe}from"./TQ7Pmmae.js";import{u as je}from"./ZDOPDbaX.js";import"./CtosDvS0.js";import"./CuVAPZQ8.js";import"./BCcN9pii.js";import"./CMKSl-Ng.js";import"./DBEJUH-Z.js";import"./CAQVAH0V.js";import"./DxD6Ynfo.js";import"./zlMhJk0P.js";import"./DeCyaT7k.js";import"./D4e4FYoF.js";import"./BhB8DUPm.js";import"./BstbYvQo.js";import"./psimjGaX.js";import"./B3rWqoNg.js";import"./EK7Wbu3-.js";import"./BKdtdX-7.js";import"./kRIii9yh.js";import"./C6Y-ieo6.js";import"./jsPNKUA0.js";import"./Bzv9SrOl.js";const We={class:"extension-manage-container flex h-full flex-col pb-5"},Xe={class:"header bg-background sticky top-0 z-10 pb-6"},Ge={class:"space-y-4"},qe={class:"flex w-full flex-wrap justify-between gap-4"},He={class:"flex items-end justify-end"},Ke={class:"flex items-center gap-4"},Qe={key:0,class:"relative grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},Je={class:"z-10 h-[170px] rounded-lg border border-dashed p-4"},Ye={class:"flex flex-col"},Ze={class:"text-muted-foreground pb-2 pl-2 text-xs font-bold"},ea={class:"absolute top-0 right-0 bottom-0 left-0 flex h-[calc(100vh-12rem)] items-center justify-center"},aa={class:"text-muted-foreground text-sm font-medium"},sa={key:1,class:"grid h-[calc(100vh-12rem)]"},ta={class:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},oa={class:"h-[170px] rounded-lg border border-dashed p-4"},la={class:"flex flex-col"},ia={class:"text-muted-foreground pb-2 pl-2 text-xs font-bold"},na={class:"flex h-full w-full cursor-pointer flex-col p-4"},ra={class:"flex justify-between"},ca={class:"flex w-[calc(100%-76px)] flex-col gap-1"},da={class:"flex items-center gap-1"},ma={class:"text-foreground truncate text-[16px] leading-[22px] font-[500]"},ua={class:"text-muted-foreground line-clamp-1 text-[14px] leading-[20px] font-normal wrap-break-word"},pa={class:"mt-1.5 flex items-center gap-2"},ga={class:"ml-[12px] h-[64px] w-[64px] flex-none overflow-hidden rounded-[10px]"},fa={class:"mt-auto flex items-center justify-between"},_a={class:"flex items-center gap-1 text-xs"},ha={class:"text-nowrap"},ba={class:"bg-background flex items-center gap-2"},va={key:0,class:"text-error flex items-center gap-1"},xa={class:"text-xs leading-none"},es=ue({__name:"list",setup(ya){const W=C(()=>$(()=>import("./BNh1Yf2o.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]),import.meta.url)),X=C(()=>$(()=>import("./uCSZdLLJ.js"),__vite__mapDeps([11,1,12,2,3,4,5,6,7,8,9,13,10]),import.meta.url)),G=C(()=>$(()=>import("./aRxLHUSx.js"),__vite__mapDeps([14,15,1,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,7,33,34,35,36,37,38,5,6,8,39,4,40,41,13,10,42,43]),import.meta.url)),q=C(()=>$(()=>import("./DQCVCxm_.js"),__vite__mapDeps([44,1,12,45,15,46,23,24,47,48,27,49,50,8,51,6,52,53,29,30,7,54,55,37,38,5,39,4,40,41,10]),import.meta.url)),H=C(()=>$(()=>import("./BTyuOgdq.js"),__vite__mapDeps([56,1,37,38,5,6,7,8,39,4,40,41,10]),import.meta.url)),{t}=pe(),y=ge(),w=fe(),E=_e({total:0,installed:0,uninstalled:0}),K=M(()=>[{label:`${t("extensions.manage.tabs.all")} (${E.value.total})`,value:"all"},{label:`${t("extensions.manage.tabs.installed")} (${E.value.installed})`,value:"installed"},{label:`${t("extensions.manage.tabs.uninstalled")} (${E.value.uninstalled})`,value:"uninstalled"}]),k=he("all"),_=be({type:void 0}),Q=s=>({[b.WEB]:t("extensions.modal.terminalTypes.web"),[b.WEIXIN]:t("extensions.modal.terminalTypes.weixin"),[b.H5]:t("extensions.modal.terminalTypes.h5"),[b.MP]:t("extensions.modal.terminalTypes.mp"),[b.API]:t("extensions.modal.terminalTypes.api")})[s]||t("extensions.manage.unknown"),{paging:i,getLists:m}=je({fetchFun:Se,params:_});ve(()=>i.extend,s=>{s?.statistics?E.value=s.statistics:E.value={total:0,installed:0,uninstalled:0}},{deep:!0});const J=M(()=>i.items.length<i.total),Y=()=>{i.loading||(i.page++,m({append:!0}))},U=Ee(()=>{i.page=1,m()},500),Z=s=>{k.value=String(s);const l=k.value;l==="all"?delete _.isInstalled:_.isInstalled=l==="installed",i.page=1,m()},ee=s=>{window.open(`${De.EXTENSION}/${s.identifier}/buildingai-middleware`,"_blank")},D=O({}),I=O({}),ae=async s=>{if(!D[s.identifier])try{D[s.identifier]=!0,await Re(s.identifier),i.page=1,await m(),w.success(t("console-common.messages.success"))}catch(l){console.error("安装插件失败:",l)}finally{D[s.identifier]=!1}},se=s=>{y.create(H).open({extension:s,onConfirmUpgrade:()=>{te(s)}})},te=async s=>{if(!I[s.identifier])try{I[s.identifier]=!0,await Fe(s.identifier),i.page=1,await m(),w.success(t("console-common.messages.success"))}catch(l){console.error("更新插件失败:",l)}finally{I[s.identifier]=!1}},{lockFn:oe}=xe(async s=>{try{await Oe(s.identifier),i.page=1,await m(),w.success(t("console-common.messages.success"))}catch(l){console.error("卸载插件失败:",l)}}),V=async s=>{try{await Pe(s.id),i.page=1,await m(),w.success(t("console-common.messages.success"))}catch(l){console.error("启用插件失败:",l)}},le=async s=>{try{await Me(s.id),i.page=1,await m(),w.success(t("console-common.messages.success"))}catch(l){console.error("禁用插件失败:",l)}},ie=s=>{y.create(q).open({extension:s})},L=async(s,l)=>{await y.create(G).open({isEdit:l,id:s.id,initialData:{name:s.name,packName:s.identifier,description:s.description,version:s.version,icon:s.icon,type:s.type,supportTerminal:s.supportTerminal||[],author:s.author||{avatar:"",name:"",homepage:""}}}).result&&(i.page=1,m())},z=()=>{window.open("https://buildingai.cc/plugin")},ne=s=>{y.create(X).open({isIdentifier:s.isLocal,extensionId:s.id,identifier:s.identifier})},re=s=>{y.create(W).open({extension:s,identifier:s.identifier})};return ye(()=>m()),(s,l)=>{const B=Le,N=Ae,S=Te,v=Ie,x=Ce,A=Ue,T=Ve,P=$e,ce=ze,de=Be,me=Ne;return r(),h("div",We,[o("div",Xe,[o("div",Ge,[o("div",qe,[o("div",He,[n(B,{items:e(K),modelValue:e(k),"onUpdate:modelValue":[l[0]||(l[0]=a=>we(k)?k.value=a:null),Z],class:"block w-auto"},null,8,["items","modelValue"])]),o("div",Ke,[n(N,{modelValue:e(_).name,"onUpdate:modelValue":[l[1]||(l[1]=a=>e(_).name=a),e(U)],placeholder:e(t)("extensions.manage.search")},null,8,["modelValue","placeholder","onUpdate:modelValue"]),n(S,{modelValue:e(_).status,"onUpdate:modelValue":[l[2]||(l[2]=a=>e(_).status=a),e(U)],items:[{label:e(t)("extensions.manage.status.all"),value:void 0},{label:e(t)("extensions.manage.status.enabled"),value:e(u).ENABLED},{label:e(t)("extensions.manage.status.disabled"),value:e(u).DISABLED}],class:"block w-auto",placeholder:e(t)("extensions.manage.status.all")},null,8,["modelValue","items","placeholder","onUpdate:modelValue"]),n(v,{icon:"i-lucide-plus",color:"primary",onClick:l[3]||(l[3]=a=>L({},!1))},{default:p(()=>[ke(c(e(t)("extensions.manage.add")),1)]),_:1})])])])]),!e(i).loading&&e(i).items.length===0?(r(),h("div",Qe,[o("div",Je,[o("div",Ye,[o("h3",Ze,c(e(t)("extensions.manage.add")),1),o("div",{class:"text-primary hover:bg-primary-50 flex cursor-pointer items-center rounded-lg px-2 py-2 text-sm",onClick:l[4]||(l[4]=a=>L({},!1))},[n(x,{name:"i-lucide-file-plus-2",class:"mr-2 size-4"}),o("span",null,c(e(t)("extensions.manage.add")),1)]),o("div",{class:"text-primary hover:bg-primary-50 flex cursor-pointer items-center rounded-lg px-2 py-2 text-sm",onClick:z},[n(x,{name:"i-lucide-external-link",class:"mr-2 size-4"}),o("span",null,c(e(t)("extensions.manage.store")),1)])])]),o("div",ea,[o("span",aa,c(e(t)("extensions.manage.empty.description")),1)])])):(r(),h("div",sa,[n(me,{class:"h-full",shadow:!1},{default:p(()=>[n(de,{loading:e(i).loading,"has-more":e(J),"loading-text":e(t)("extensions.manage.loadingText"),"no-more-text":e(i).page!==1?e(t)("extensions.manage.noMoreText"):" ",onLoadMore:Y},{default:p(()=>[o("div",ta,[o("div",oa,[o("div",la,[o("h3",ia,c(e(t)("extensions.manage.add")),1),o("div",{class:"text-primary hover:bg-primary-50 dark:hover:bg-primary/15 flex cursor-pointer items-center rounded-lg px-2 py-2 text-sm",onClick:l[5]||(l[5]=a=>L({},!1))},[n(x,{name:"i-lucide-file-plus-2",class:"mr-2 size-4"}),o("span",null,c(e(t)("extensions.manage.add")),1)]),o("div",{class:"text-primary hover:bg-primary-50 dark:hover:bg-primary/15 flex cursor-pointer items-center rounded-lg px-2 py-2 text-sm",onClick:z},[n(x,{name:"i-lucide-external-link",class:"mr-2 size-4"}),o("span",null,c(e(t)("extensions.manage.store")),1)])])]),(r(!0),h(R,null,F(e(i).items,a=>(r(),h("div",{key:a.id,class:"bg-background border-muted relative h-[170px] overflow-hidden rounded-[6px] border border-solid transition duration-150 ease-out hover:shadow-[0_6px_8px_0_rgba(28,31,35,6%)]"},[o("div",na,[o("div",ra,[o("div",ca,[o("div",da,[n(A,{text:a.name},{default:p(()=>[o("span",ma,c(a.name),1)]),_:2},1032,["text"])]),o("span",ua,c(a.description||e(t)("extensions.manage.noDescription")),1),o("div",pa,[a.version?(r(),g(T,{key:0,color:"neutral",variant:"soft",label:`v${a.version}`},null,8,["label"])):f("",!0),a.isInstalled?(r(),g(T,{key:1,color:a.status===e(u).ENABLED?"success":"neutral",variant:"soft",label:a.status===e(u).ENABLED?e(t)("extensions.manage.enable"):e(t)("extensions.manage.disable")},null,8,["color","label"])):f("",!0),(r(!0),h(R,null,F(a.supportTerminal,d=>(r(),g(T,{color:d===e(b).WEB?"success":d===e(b).API?"info":"neutral",variant:"soft",label:Q(d)},null,8,["color","label"]))),256))])]),o("div",ga,[n(P,{src:a.icon,alt:a.name,icon:"i-lucide-puzzle",ui:{root:`size-full rounded-md ${a.icon?"":"bg-primary"}`,icon:"size-7 text-white"}},null,8,["src","alt","ui"])])]),o("div",fa,[o("div",_a,[n(P,{color:"primary",size:"xs",src:a.author?.avatar,ui:{root:"rounded-full bg-primary size-5"}},{default:p(()=>[n(x,{name:"i-lucide-user",class:"size-3 text-white"})]),_:1},8,["src"]),o("div",ha,c(a.author.name||e(t)("extensions.manage.unknownAuthor")),1)]),o("div",ba,[a.isCompatible?f("",!0):(r(),h("div",va,[n(x,{name:"i-lucide-circle-alert",class:"size-3.5 cursor-pointer"}),o("span",xa,c(s.$t("extensions.manage.incompatible")),1)])),a.type===e(j).APPLICATION&&a.isInstalled&&a.status===e(u).ENABLED&&a.isCompatible?(r(),g(A,{key:1,text:e(t)("extensions.manage.manage")},{default:p(()=>[n(v,{color:"primary",icon:"i-lucide-settings",variant:"soft",size:"sm",label:e(t)("extensions.manage.manage"),onClick:d=>ee(a)},null,8,["label","onClick"])]),_:2},1032,["text"])):f("",!0),a.type===e(j).APPLICATION&&a.isInstalled&&a.status===e(u).DISABLED&&a.isCompatible?(r(),g(A,{key:2,text:e(t)("extensions.manage.enable")},{default:p(()=>[n(v,{color:"primary",icon:"i-lucide-power",variant:"soft",size:"sm",label:e(t)("extensions.manage.enable"),onClick:d=>V(a)},null,8,["label","onClick"])]),_:2},1032,["text"])):f("",!0),!a.isInstalled&&a.isCompatible?(r(),g(v,{key:3,color:"primary",variant:"solid",icon:"i-lucide-download",size:"sm",loading:e(D)[a.identifier],label:s.$t("extensions.manage.install"),onClick:d=>ae(a)},null,8,["loading","label","onClick"])):f("",!0),a.hasUpdate?(r(),g(v,{key:4,color:"info",variant:"subtle",icon:"i-lucide-circle-fading-arrow-up",size:"sm",label:s.$t("extensions.manage.upgrade"),loading:e(I)[a.identifier],disabled:e(I)[a.identifier],onClick:d=>se(a)},null,8,["label","loading","disabled","onClick"])):f("",!0),a.isInstalled?(r(),g(ce,{key:5,items:[[{label:e(t)("extensions.manage.detail"),icon:"i-lucide-info",onSelect:()=>ne(a)},a.isLocal?void 0:{label:e(t)("extensions.manage.logs"),icon:"i-lucide-file-text",onSelect:()=>re(a)},{label:e(t)("extensions.manage.featureConfig"),icon:"i-lucide-settings",onSelect:()=>ie(a)}].filter(d=>d!==void 0),[{label:a.status===e(u).ENABLED?e(t)("extensions.manage.disable"):e(t)("extensions.manage.enable"),icon:a.status===e(u).ENABLED?"i-lucide-power-off":"i-lucide-power",color:a.status===e(u).ENABLED?"warning":"success",disabled:!a.isCompatible,onSelect:()=>{a.status===e(u).ENABLED?le(a):V(a)}}],[a.isLocal?{label:e(t)("console-common.edit"),icon:"i-lucide-pen-line",onSelect:()=>L(a,!0)}:void 0,{label:e(t)("extensions.manage.uninstall"),icon:"i-lucide-trash-2",color:"error",onSelect:()=>{e(oe)(a)}}].filter(d=>d!==void 0)],content:{align:"end",side:"bottom",sideOffset:4},ui:{content:"w-32",itemLeadingIcon:"size-4"}},{default:p(()=>[n(v,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost",size:"sm"})]),_:1},8,["items"])):f("",!0)])])])]))),128))])]),_:1},8,["loading","has-more","loading-text","no-more-text"])]),_:1})]))])}}});export{es as default};
