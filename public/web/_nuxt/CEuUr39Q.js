import{u as O,_ as K}from"./B2KyM25F.js";import{_ as X}from"./BodiR9AC.js";import{_ as H}from"./W9TPlG27.js";import{d as W,aX as Y,e as Z,i as C,s as p,a$ as ee,j as te,c as S,t as s,m as w,A as $,q as e,v as d,x as l,l as N,B as j,F as oe,C as se,k as I,D as ne,b0 as ie,o as a,_ as ae,p as re,y as F,f as le,ap as ce,aL as me,an as ue}from"#entry";import{_ as pe}from"./DH5Wu3SI.js";import{d as de,e as fe,f as _e}from"./DPwLTNIs.js";import{u as he}from"./t1d_OU1Q.js";import"./CDSfhndf.js";import"./Brlt-NDg.js";import"./DoL5-2Ox.js";import"./6WwfWHXT.js";import"./KiG0a5S-.js";import"./CXk2IlXx.js";import"./kRIii9yh.js";import"./DBwQYu6J.js";import"./B1TeSxwV.js";import"./C6Y-ieo6.js";import"./Ti3HjCpC.js";import"./CyS2mNdj.js";import"./BaKvIqXP.js";import"./cwT2REE1.js";import"./DaC7Nksz.js";import"./DegKy-XA.js";import"./DnFVE45b.js";import"./DSCppvl0.js";import"./7d3iyZ8h.js";import"./DwzRPK54.js";import"./CR9qioUt.js";import"./BRI4D6WA.js";import"./DlAUqK2U.js";import"./tYG64TNz.js";import"./DDJ79SjH.js";import"./RmzZBBRE.js";import"./C4jlvBh2.js";import"./eeyg4-1U.js";import"./DcxZIiHI.js";import"./C-XPfH0G.js";import"./B-p4_8pw.js";import"./CsY35JUW.js";import"./BNMwDuRp.js";import"./CvZB4bI9.js";import"./B0g9CpkI.js";import"./DNVymXxO.js";import"./CZsOHrUj.js";import"./BE3cI0a5.js";import"./DxdFW9IF.js";import"./CjOovgR0.js";import"./DXP7Kkdt.js";import"./BjYsydzc.js";import"./CGkf3lDq.js";const ge={class:"ai-chat dark:bg-muted/50 flex h-full min-h-0 items-center justify-center pl-0"},ve={class:"bg-background flex h-full min-h-0 flex-1 flex-col items-center justify-center rounded-lg"},ye={class:"flex h-full w-full max-w-[800px] flex-col items-center justify-center"},xe={class:"mb-8 text-center"},Ce={class:"mb-2 flex items-center justify-center text-2xl font-bold"},Se={class:"text-accent-foreground text-sm"},we={class:"w-full px-4"},Ie={key:0,class:"my-4 flex w-full flex-wrap justify-center gap-3"},be={class:"mr-1"},ke={class:"w-full p-2 text-center text-xs text-gray-400"},Me={class:"flex flex-col items-center justify-center gap-1"},Ve={class:"flex items-center justify-center gap-2"},Ae=["href"],Ue={key:0},At=W({__name:"index",async setup(Ne){let f,L;const c=Y(),{t:D}=Z(),b=he(),P=O(),m=C(()=>b.selectedModel?.id||""),k=p(""),n=p([]),_=p(!1),r=p(),h=p(),g=p([]),{data:v}=([f,L]=ee(()=>ie("chat-config",()=>fe())),f=await f,L(),f),Q=C(()=>v.value?.suggestionsEnabled??!0),T=C(()=>v.value?.suggestions||[]),M=C(()=>v.value?.welcomeInfo||{});function E(t){g.value=t}function V(){try{const t=JSON.parse(localStorage.getItem("mcpIds")||"[]");return Array.isArray(t)?t:[]}catch{return[]}}function z(t){t.length?localStorage.setItem("mcpIds",JSON.stringify(t)):localStorage.removeItem("mcpIds")}const q=async()=>{try{const t=await de();if(!t)return;r.value=t,h.value=t.id,_.value=V().includes(h.value||"")}catch(t){console.error("Failed to fetch quick menu:",t)}};async function B(t){try{if(!m.value&&le().isLogin){ce().warning(D("ai-chat.frontend.selectModel"));return}const o=await _e({title:""});P.setPendingConversation({id:o.id,modelId:m.value,title:t,files:g.value.length>0?g.value:void 0}),me("chats"),await ue({path:`/chat/${o.id}`})}catch(o){console.error("Failed to create conversation:",o)}}const R=()=>{if(!h.value)return;Array.isArray(n.value)||(n.value=[]);const t=V(),o=h.value,A=t.includes(o),y=n.value.includes(o);if(!A&&!y)t.push(o),y||n.value.push(o),z(t);else{const U=t.filter(u=>u!==o),x=n.value.filter(u=>u!==o);z(U),n.value=x}_.value=V().includes(o)};return te(()=>{q()}),(t,o)=>{const A=K,y=X,U=H,x=ne,u=ae,G=pe;return a(),S("div",ge,[s("div",{class:$(["border-border/50 h-full flex-none border-r pl-0",{"border-none":!e(b).chatSidebarVisible}])},[w(A)],2),s("div",ve,[s("div",ye,[s("div",xe,[s("h1",Ce,l(e(M).title),1),s("p",Se,l(e(M).description),1)]),s("div",we,[w(G,{class:"[view-transition-name:chat-prompt]",modelValue:e(k),"onUpdate:modelValue":o[2]||(o[2]=i=>j(k)?k.value=i:null),"file-list":e(g),rows:2,needAuth:!0,attachmentSizeLimit:e(v)?.attachmentSizeLimit,onSubmit:B,"onUpdate:fileList":E},{"panel-left":N(()=>[w(y,{modelValue:e(m),"onUpdate:modelValue":o[0]||(o[0]=i=>j(m)?m.value=i:null),modelId:e(m)||"",supportedModelTypes:["llm"],"show-billingRule":!0,"open-local-storage":!0,placeholder:"选择AI模型开始对话",onChange:e(b).setSelectedModel},null,8,["modelValue","modelId","onChange"]),w(U,{modelValue:e(n),"onUpdate:modelValue":o[1]||(o[1]=i=>j(n)?n.value=i:null),mcpIds:e(n)||[],placeholder:"选择MCP..."},null,8,["modelValue","mcpIds"]),e(r)?(a(),I(u,{key:0,color:e(_)?"primary":"neutral",variant:"ghost",icon:e(r)?.icon?"":"tabler:tool",ui:{leadingIcon:"size-4"},class:$({"bg-primary/10":e(_)}),onClick:re(R,["stop"])},{default:N(()=>[e(r)?.icon?(a(),I(x,{key:0,src:e(r)?.icon,ui:{root:"size-4 rounded-md"}},null,8,["src"])):d("",!0),F(" "+l(e(r)?.alias||e(r)?.name),1)]),_:1},8,["color","icon","class"])):d("",!0)]),_:1},8,["modelValue","file-list","attachmentSizeLimit"])]),e(Q)?(a(),S("div",Ie,[(a(!0),S(oe,null,se(e(T),(i,J)=>(a(),I(u,{key:J,variant:"outline",color:"neutral",size:"md",onClick:je=>B(i.text)},{default:N(()=>[s("span",be,l(i.icon),1),F(" "+l(i.text),1)]),_:2},1032,["onClick"]))),128))])):d("",!0)]),s("div",ke,[s("div",Me,[s("span",null,l(e(M).footer),1),s("div",Ve,[s("a",{href:e(c).siteConfig?.copyright.url,target:"_blank",rel:"noopener noreferrer",class:"hover:text-primary flex items-center justify-center gap-1 transition-colors"},[e(c).siteConfig?.copyright.iconUrl?(a(),I(x,{key:0,src:e(c).siteConfig?.copyright.iconUrl,ui:{root:"size-4 rounded-md"}},null,8,["src"])):d("",!0),s("span",null,l(e(c).siteConfig?.copyright.displayName),1)],8,Ae),e(c).siteConfig?.copyright.displayName||e(c).siteConfig?.copyright.iconUrl?(a(),S("span",Ue,"|")):d("",!0),o[3]||(o[3]=s("span",{class:"space-x-1"},[s("span",null,"Powered by"),s("a",{class:"text-primary font-bold",href:"https://www.buildingai.cc",target:"_blank"}," BuildingAI ")],-1))])])])])])}}});export{At as default};
