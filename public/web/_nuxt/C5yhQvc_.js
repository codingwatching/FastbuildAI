const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BFGDVaiv.js","./Dgvg0_To.js","./CDSfhndf.js","./Brlt-NDg.js","./DoL5-2Ox.js","./12pJH7Js.js","./CXk2IlXx.js","./DVSiT9pd.js","./DBwQYu6J.js","./Ti3HjCpC.js","./CyS2mNdj.js","./BaKvIqXP.js","./B1TeSxwV.js","./BstbYvQo.js","./DegKy-XA.js","./B9WRuNgu.js","./CsY35JUW.js","./DnFVE45b.js","./DSCppvl0.js","./7d3iyZ8h.js","./CvZB4bI9.js","./KiG0a5S-.js","./kRIii9yh.js","./C6Y-ieo6.js","./cwT2REE1.js","./DaC7Nksz.js","./q_YSI2Sf.js","./BD5zOh0K.js","./Dc6e1ewN.js","./D_1uxSdv.js","./B3Cet3zC.js","./DyTskiS5.js","./Ds48qA85.js","./BYm23QKU.js","./DGUAW_1C.js","./DDJ79SjH.js","./RmzZBBRE.js","./C4jlvBh2.js","./C-XPfH0G.js","./DqtoUjEm.js","./BUyfW8JT.js","./DaWZu8wl.js","./UqhBTNL6.js"])))=>i.map(i=>d[i]);
import{d as N,ap as F,e as O,aJ as j,ar as G,Q as J,g as Q,s as $,i as _,aK as W,w as X,j as Y,c as Z,o as ee,t as I,m as d,l as u,y as V,x as D,q as l,_ as oe,h as s,z as te,R as se,U as ae,aI as le}from"#entry";import{_ as ne}from"./DJ9SNVgt.js";import{_ as re}from"./6WwfWHXT.js";import{_ as ce}from"./B-p4_8pw.js";import{_ as ie}from"./BixMXl5t.js";import{_ as de}from"./DSCppvl0.js";import{_ as me}from"./Bjbrn0__.js";import{_ as ue}from"./CEOm-hjj.js";import{a as pe,b as ge,c as fe}from"./DqtoUjEm.js";import{u as he}from"./zDgZcZqa.js";import{u as be}from"./DcxZIiHI.js";import"./CgMDXot0.js";import"./DVSiT9pd.js";import"./CZsOHrUj.js";import"./DegKy-XA.js";import"./DaC7Nksz.js";import"./cwT2REE1.js";import"./CXk2IlXx.js";import"./D_1uxSdv.js";import"./DoL5-2Ox.js";import"./KiG0a5S-.js";import"./kRIii9yh.js";import"./DBwQYu6J.js";import"./B1TeSxwV.js";import"./C6Y-ieo6.js";import"./Ti3HjCpC.js";import"./CyS2mNdj.js";import"./BaKvIqXP.js";import"./DnFVE45b.js";import"./7d3iyZ8h.js";const ye={class:"menu-list-container pb-5"},_e={class:"bg-background sticky top-0 z-10 flex flex-wrap gap-4 pb-4"},ve={class:"flex items-end gap-2 md:ml-auto"},Ye=N({__name:"list",setup(xe){const E=se(()=>ae(()=>import("./BFGDVaiv.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42]),import.meta.url)),v=ne,c=oe,x=re,w=te,C=ce,P=ie,S=F(),{t}=O(),g=j(),U=G(),{hasAccessByCodes:f}=he(),K=J(),i=Q("table"),A=$([]),B=$({}),k=_(()=>i.value?.tableApi&&i.value.tableApi.getSelectedRowModel()?.flatRows?.length||0),H=()=>i.value?.tableApi?i.value.tableApi.getSelectedRowModel()?.flatRows?.map(o=>o.original.id)||[]:[],h=_({get(){return Number(g.query.sourceType)||1},set(e){U.replace({path:g.path,query:{...g.query,sourceType:e}})}}),n=_(()=>({select:t("console-common.select"),name:t("system-perms.menu.name"),path:t("system-perms.menu.path"),icon:t("system-perms.menu.icon"),type:t("system-perms.menu.type"),sort:t("console-common.sort"),permissionCode:t("system-perms.menu.permissionCode"),isHidden:t("system-perms.menu.hidden"),createdAt:t("console-common.createAt"),actions:t("console-common.operation")})),z=[{id:"expander",header:({table:e})=>s(c,{variant:"ghost",color:"neutral",icon:e.getExpandedDepth()?"i-lucide-minus-square":"i-lucide-plus-square",size:"xs",onClick:o=>{o.stopPropagation(),e.toggleAllRowsExpanded(!e.getExpandedDepth())}}),enableHiding:!1,cell:({row:e})=>e.getCanExpand()?s(c,{variant:"ghost",color:"neutral",icon:e.getIsExpanded()?"i-lucide-minus":"i-lucide-plus",size:"xs",onClick:o=>{o.stopPropagation(),e.toggleExpanded()}}):null},{id:"select",header:({table:e})=>s(v,{modelValue:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),"onUpdate:modelValue":o=>{e.toggleAllPageRowsSelected(!!o)},ariaLabel:"Select all"}),cell:({row:e})=>s(v,{modelValue:e.getIsSelected(),"onUpdate:modelValue":o=>{e.toggleSelected(!!o)},ariaLabel:"Select row"})},{accessorKey:"name",header:()=>s("p",{class:""},`${n.value.name}`),cell:({row:e})=>{const o=e.depth,r=[];return o>0&&r.push(s("div",{style:{width:`${o*16}px`},class:"flex-none"}),s(w,{name:"i-lucide-corner-down-right",class:"text-gray-400 flex-none mr-1"})),e.original.icon&&r.push(s(w,{name:`${e.original.icon}`,class:"text-primary size-5 flex-none mr-2"})),r.push(s("span",{class:"truncate"},t(e.original.name))),s("div",{class:"flex items-center"},r)}},{accessorKey:"path",header:()=>s("p",{class:""},`${n.value.path}`),cell:({row:e})=>{const o=e.getValue("path");return s("div",{class:"max-w-xs truncate"},o||"-")}},{accessorKey:"type",header:()=>s("p",{class:""},`${n.value.type}`),cell:({row:e})=>{const o=e.getValue("type"),m={0:{label:t("console-common.menuType.group"),color:"neutral"},1:{label:t("console-common.menuType.catalogue"),color:"warning"},2:{label:t("console-common.menuType.menu"),color:"info"},3:{label:t("console-common.menuType.button"),color:"neutral"}}[o]||{label:"-",color:"neutral"};return s(C,{color:m.color,variant:"subtle",class:"capitalize"},()=>m.label)}},{accessorKey:"isHidden",header:()=>s("p",{class:""},`${n.value.isHidden}`),cell:({row:e})=>{const o=e.getValue("isHidden");return s(C,{color:o?"error":"success",variant:"subtle"},()=>t(o?"system-perms.menu.no":"system-perms.menu.yes"))}},{accessorKey:"permissionCode",header:()=>s("p",{class:""},`${n.value.permissionCode}`),cell:({row:e})=>{const o=e.getValue("permissionCode");return s("div",{class:"max-w-xs truncate"},o||"-")}},{accessorKey:"sort",header:()=>s("p",{class:""},`${n.value.sort}`),cell:({row:e})=>{const o=e.getValue("sort");return s("div",{},o||"0")}},{accessorKey:"createdAt",header:({column:e})=>{const o=e.getIsSorted();return s(c,{color:"neutral",variant:"ghost",label:n.value.createdAt,icon:o?o==="asc"?"i-lucide-arrow-up-narrow-wide":"i-lucide-arrow-down-wide-narrow":"i-lucide-arrow-up-down",class:"-mx-2.5",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc")})},cell:({row:e})=>{const o=e.getValue("createdAt");return s(P,{datetime:o,mode:"datetime"})}},{id:"actions",header:()=>s("p",{class:""},`${n.value.actions}`),size:80,enableSorting:!1,enableHiding:!1,cell:({row:e})=>s(x,{items:q(e)},()=>s(c,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost",class:"ml-auto"},()=>""))}];function q(e){return[f(["menu:add"])?{label:t("console-common.add"),icon:"i-lucide-plus-circle",color:"success",onClick:()=>{b(null,e.original.id)}}:null,f(["menu:edit"])?{label:t("console-common.edit"),icon:"i-lucide-pen-line",onClick:()=>{b(e.original.id||"",null)}}:null,f(["menu:delete"])?{label:t("console-common.delete"),icon:"i-lucide-trash",color:"error",onSelect(){M(e.original.id)}}:null].filter(Boolean)}const{lockFn:p,isLock:L}=W(async()=>{try{A.value=await fe(h.value)}catch(e){console.log("get menu-tree api error --->",e)}}),R=()=>{le().loadPermissions()},b=async(e,o)=>{await K.create(E).open({id:e??null,parentId:o??null,sourceType:h.value||1}).result&&(p(),R())},M=async e=>{try{await be({title:t("system-perms.menu.deleteTitle"),description:t("system-perms.menu.deleteMsg"),color:"error",confirmText:t("console-common.delete"),cancelText:t("console-common.cancel")});let o;Array.isArray(e)?o=await pe({ids:e}):o=await ge(e),o.success?(p(),S.success(t("system-perms.menu.success"))):S.error(o.message),R()}catch(o){console.error("删除失败:",o)}};return X(()=>h.value,()=>{p()}),Y(()=>p()),(e,o)=>{const r=de,m=me,T=ue;return ee(),Z("div",ye,[I("div",_e,[I("div",ve,[d(l(c),{color:"error",variant:"subtle",label:l(t)("console-common.batchDelete"),icon:"i-heroicons-trash",disabled:!k.value,onClick:o[0]||(o[0]=()=>{const a=H();a&&a.length>0&&M(a)})},{trailing:u(()=>[d(r,null,{default:u(()=>[V(D(k.value),1)]),_:1})]),_:1},8,["label","disabled"]),d(l(x),{items:l(i)?.tableApi?.getAllColumns().filter(a=>a.getCanHide()).map(a=>({label:n.value[a?.id]||a.columnDef.header,type:"checkbox",checked:a.getIsVisible(),onUpdateChecked(y){l(i)?.tableApi?.getColumn(a.id)?.toggleVisibility(!!y)},onSelect(y){y?.preventDefault()}})),content:{align:"end"}},{default:u(()=>[d(l(c),{label:l(t)("console-common.showColumns"),color:"neutral",variant:"outline","trailing-icon":"i-lucide-chevron-down"},null,8,["label"])]),_:1},8,["items"]),d(m,{codes:["menu:add"]},{default:u(()=>[d(l(c),{icon:"i-heroicons-plus",color:"primary",onClick:o[1]||(o[1]=()=>b(null,null))},{default:u(()=>[V(D(l(t)("system-perms.menu.add")),1)]),_:1})]),_:1})])]),d(T,{loading:l(L),data:l(A),columns:z,class:"shrink-0",ref_key:"table",ref:i,selectable:"",expanded:l(B),getSubRows:a=>a.children,ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default",tr:"[&:has(>td[colspan])]:hidden"}},null,8,["loading","data","expanded","getSubRows"])])}}});export{Ye as default};
