const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./COLvuZEJ.js","./coNoMDN2.js","./CXUt0j5Y.js","./-Eb02sIQ.js","./Dk6FGhu1.js","./BPKB8n-W.js","./DuSMYVIA.js","./MN31c9CG.js","./CCcv9mzY.js","./BFAo_s2U.js","./Cb04SOqd.js","./VGKgjfSv.js","./BruVSCWF.js","./CjMjJXge.js","./CgMDXot0.js","./CR1AS2Ry.js","./DVnbt8cp.js","./D6yWePie.js","./CuOaO1Pb.js","./DHFmmngs.js","./C3zg6GHm.js","./BgHJjJs-.js","./DDtM2OcI.js","./Btvd554H.js","./B-DdbQ-X.js","./V9POJiZu.js","./BstbYvQo.js","./CG0QMV_m.js","./Bcbime_x.js","./kRIii9yh.js","./C6Y-ieo6.js","./3UOIlTK8.js","./DduSJdeS.js","./CB78hAg2.js","./Cif_tCX1.js","./CvUJEDIF.js","./DLMDXBaB.js","./HuPhsSsV.js","./Dswg8GCv.js","./ClGKrygo.js","./DaWZu8wl.js","./BJ10eFuk.js","./CLKo8PO4.js","./bRMRu3YJ.js","./DS-TE4M7.js","./jQG0lB_l.js","./D-6Co9ha.js"])))=>i.map(i=>d[i]);
import{aC as F,aG as S,aF as he,aB as _e,d as ge,ap as be,b as ye,Q as ke,s as G,au as xe,f as j,i as we,aJ as z,g as B,w as N,H as Me,c as y,o as m,q as r,t as k,j as x,l as c,p as o,x as w,v as d,k as p,_ as Ae,F as q,B as H,z as I,C as ze,y as Se,A as Ue,R as J,U as Q}from"#entry";import Ce from"./BruVSCWF.js";import{_ as De}from"./CjMjJXge.js";import{_ as Te}from"./DDtM2OcI.js";import{_ as Ve}from"./CG0QMV_m.js";import{_ as $e}from"./CB78hAg2.js";import{_ as Be}from"./Cif_tCX1.js";import{_ as Ie}from"./CvUJEDIF.js";import{_ as Fe}from"./DLMDXBaB.js";import{_ as Re}from"./HuPhsSsV.js";import{e as Ee}from"./Dswg8GCv.js";import{D as Pe}from"./ClGKrygo.js";import{u as Le}from"./BJ10eFuk.js";import{u as Oe}from"./CLKo8PO4.js";function Ge(n){return F("/ai-models",n)}function So(n){return F(`/ai-models/${n}`)}function Uo(n){return _e("/ai-models",n)}function Co(n,g){return S(`/ai-models/${n}`,g)}function je(n,g){return S(`/ai-models/${n}/toggle-active`,{isActive:g})}function Do(n){return S("/ai-models/batch/update",{models:n})}function Ne(n,g){return S("/ai-models/batch-toggle-active",{ids:n,isActive:g})}function qe(n){return he("/ai-models",{ids:n})}function He(n){return S("/ai-models/batch/sort",{sort:n})}function To(n){return F("/ai-models/type-father/list",n)}const Je={class:"w-full space-y-2 px-5"},Qe={class:"mb-4 pl-2"},Ke={class:"mb-4 flex items-center justify-between pl-2"},We={class:"flex items-center gap-3"},Xe={class:"text-xs font-medium"},Ye={key:0,class:"text-primary"},Ze={class:"flex items-center gap-2"},eo={key:0,class:"space-y-3"},oo={class:"flex-none"},to={class:"min-w-0 flex-1"},ao={class:"mb-1 flex items-center gap-2"},so={class:"hover:text-primary cursor-pointer truncate text-sm font-medium text-gray-900 transition-colors dark:text-gray-100"},lo={class:"flex gap-1"},no={key:0,class:"text-muted-foreground flex items-center gap-2 text-xs"},io={class:"flex flex-none items-center gap-3"},ro={key:2,class:"py-12 text-center"},co={class:"text-foreground mb-2 text-lg font-medium"},uo={class:"text-muted-foreground text-sm"},mo=ge({__name:"model-list",props:{provider:{}},setup(n){const g=J(()=>Q(()=>import("./COLvuZEJ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42]),import.meta.url)),K=J(()=>Q(()=>import("./bRMRu3YJ.js"),__vite__mapDeps([43,1,12,44,21,37,15,20,45,46,2,3,4,5,6,7,8,9,10,11,13,14,16,17,18,19,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,38,39,40,41,42]),import.meta.url)),f=n,T=be(),{t:s}=ye(),V=ke(),{hasAccessByCodes:U}=Le(),u=G([]),h=xe({modelType:"all",search:""}),l=j(new Set),b=j(new Set),R=G([]),W=async()=>{try{const e=await Ee();R.value=[{label:s("ai-provider.backend.model.modelTypes.all"),value:"all"},...e.map(t=>({label:t.label,value:t.value}))]}catch(e){console.error("获取模型类型列表失败:",e)}};we(()=>{W()});const{lockFn:v,isLock:E}=z(async()=>{if(f.provider?.id)try{const e=await Ge({providerId:f.provider.id,isActive:void 0,keyword:h.search?.trim()||void 0,modelType:h.modelType==="all"?void 0:h.modelType});u.value=e||[]}catch(e){console.error("获取模型列表失败:",e)}}),{lockFn:X}=z(async(e,t)=>{try{await je(e,t);const i=u.value.find(_=>_.id===e);i&&(i.isActive=t),v()}catch(i){console.error("切换模型状态失败:",i)}}),Y=async e=>{await V.create(g).open({id:e.id,provider:f.provider}).result&&v()},Z=async()=>{await V.create(g).open({id:null,provider:f.provider}).result&&v()},ee=async()=>{if(l.value.size===0)return;await V.create(K).open({models:b.value,provider:f.provider}).result&&v(),l.value.clear(),b.value.clear()},{lockFn:P}=z(async e=>{if(l.value.size===0)return;const t=Array.from(l.value);try{await Ne(t,e),T.success(s(e?"ai-provider.backend.model.messages.isActiveEnabled":"ai-provider.backend.model.messages.isActiveDisabled")),l.value.clear(),b.value.clear(),v()}catch(i){console.error("Toggle model active failed:",i)}}),{lockFn:oe}=z(async()=>{if(l.value.size===0)return;const e=Array.from(l.value);try{await Oe({title:s("ai-provider.backend.model.messages.deleteTitle"),description:s("ai-provider.backend.model.messages.deleteMsg"),color:"error"}),await qe(e),T.success(s("console-common.batchDeleteSuccess")),l.value.clear(),b.value.clear(),v()}catch(t){console.error("批量删除失败:",t),T.error(s("console-common.batchDeleteFailed"))}}),{lockFn:te,isLock:L}=z(async()=>{if(u.value.length!==0)try{const e=u.value.map(t=>t.id);await He(e),await v()}catch(e){console.error("更新排序失败:",e),await v()}}),$=B({get:()=>u.value,set:e=>{u.value=e,te()}}),ae=()=>{const e=[];return U(["ai-models:update"])&&(e.push({label:s("console-common.batchEnable"),icon:"i-lucide-eye",color:"neutral",onSelect:()=>P(!0)}),e.push({label:s("console-common.batchDisable"),icon:"i-lucide-eye-off",color:"neutral",onSelect:()=>P(!1)}),e.push({label:s("console-common.batchEdit"),icon:"i-lucide-edit",color:"neutral",onSelect:()=>ee()})),U(["ai-models:delete"])&&e.push({label:s("console-common.batchDelete"),icon:"i-heroicons-trash",color:"error",onSelect:()=>oe()}),e},se=e=>{const t=e.id,i=new Set(l.value),_=new Set(b.value);i.has(t)?(i.delete(t),_.delete(e)):(i.add(t),_.add(e)),l.value=i,b.value=_},le=()=>{if(l.value.size===u.value.length)l.value.clear(),b.value.clear();else{const e=new Set,t=new Set;u.value.forEach(i=>{i.id&&(e.add(i.id),t.add(i))}),l.value=e,b.value=t}},ne=B(()=>u.value.length>0&&l.value.size===u.value.length),ie=B(()=>l.value.size>0&&l.value.size<u.value.length),re=e=>{const t=[];return e&&t.push(e.toUpperCase().replaceAll("-"," ")),t};N(()=>f.provider?.id,()=>v(),{immediate:!0});const ce=Me(()=>{v()},300);return N(()=>h,()=>ce()),(e,t)=>{const i=Ce,_=De,de=Te,C=Ae,ue=Ve,O=$e,me=ze,A=Be,D=Se,pe=Ie,ve=Fe,fe=Re;return m(),y("div",Je,[r("div",Qe,[c(i,{modelValue:o(h).search,"onUpdate:modelValue":t[0]||(t[0]=a=>o(h).search=a),variant:"soft",placeholder:o(s)("ai-provider.backend.model.searchPlaceholder"),ui:{root:"w-full",base:"bg-accent"}},null,8,["modelValue","placeholder"])]),r("div",Ke,[r("div",We,[c(_,{"model-value":o(ne),indeterminate:o(ie),"onUpdate:modelValue":le},null,8,["model-value","indeterminate"]),r("h3",Xe,[w(d(o(s)("ai-provider.backend.model.allModels"))+" "+d(o(u).length)+" "+d(o(s)("ai-provider.backend.model.unit"))+" ",1),o(l).size>0?(m(),y("span",Ye," ("+d(o(s)("ai-provider.backend.model.selected"))+" "+d(o(l).size)+" "+d(o(s)("ai-provider.backend.model.unit"))+") ",1)):k("",!0)])]),r("div",Ze,[c(de,{modelValue:o(h).modelType,"onUpdate:modelValue":t[1]||(t[1]=a=>o(h).modelType=a),items:o(R),"label-key":"label","value-key":"value",placeholder:o(s)("ai-provider.backend.model.modelTypeFilter"),size:"sm",class:"w-30",onChange:o(v)},null,8,["modelValue","items","placeholder","onChange"]),o(U)(["ai-models:delete"])||o(U)(["ai-models:update"])?(m(),x(ue,{key:0,items:ae(),size:"sm",content:{align:"start",side:"bottom",sideOffset:8}},{default:p(()=>[c(C,{color:"neutral",variant:"outline",icon:"i-lucide-list-checks",size:"sm",label:o(s)("ai-provider.backend.model.batchOperation",{count:o(l).size})},null,8,["label"])]),_:1},8,["items"])):k("",!0),c(O,{codes:["ai-models:create"]},{default:p(()=>[c(C,{color:"primary",variant:"soft",icon:"i-lucide-plus",size:"sm",onClick:t[2]||(t[2]=()=>Z())},{default:p(()=>[w(d(o(s)("ai-provider.backend.model.addModel")),1)]),_:1})]),_:1})])]),o(E)&&o(h).search.trim()===""&&o(u).length===0?(m(),y("div",eo,[(m(),y(q,null,H(10,a=>r("div",{key:a,class:"bg-muted flex items-center gap-4 rounded-lg p-8"})),64))])):k("",!0),o(u).length>0?(m(),x(o(Pe),{key:1,modelValue:o($),"onUpdate:modelValue":t[3]||(t[3]=a=>Ue($)?$.value=a:null),disabled:o(L),handle:".drag-handle","item-key":"id",animation:"200",class:"space-y-0"},{item:p(({element:a})=>[r("div",{class:I(["group hover:bg-muted flex items-center gap-3 rounded-lg p-2 transition-colors",{"bg-primary/5":o(l).has(a.id)}])},[r("div",{class:I(["flex-none opacity-0 group-hover:opacity-100",{"opacity-100":o(l).has(a.id)}])},[c(_,{"model-value":o(l).has(a.id),"onUpdate:modelValue":M=>se(a)},null,8,["model-value","onUpdate:modelValue"])],2),r("div",oo,[c(me,{src:f.provider?.iconUrl,alt:f.provider?.name,ui:{root:"rounded bg-transparent size-8",fallback:"text-inverted"},class:I([f.provider?.iconUrl?"":"bg-primary"])},null,8,["src","alt","class"])]),c(ve,{mode:"hover",content:{align:"center",side:"left",sideOffset:10}},{content:p(()=>[c(pe,{model:a,provider:f.provider,"show-billing-rule":!0},null,8,["model","provider"])]),default:p(()=>[r("div",to,[r("div",ao,[r("h4",so,d(a.name),1),r("div",lo,[(m(!0),y(q,null,H(re(a.modelType),M=>(m(),x(A,{variant:"soft",color:"neutral",key:M,size:"xs"},{default:p(()=>[w(d(M),1)]),_:2},1024))),128)),a.features?.includes("vision")?(m(),x(A,{key:0,variant:"soft",color:"info",size:"xs"},{default:p(()=>[c(D,{name:"i-lucide-image-play",class:"mr-1",size:"xs"}),w(" "+d(e.$t("common.ai.vision")),1)]),_:1})):k("",!0),a.features?.includes("video")?(m(),x(A,{key:1,variant:"soft",color:"warning",size:"xs"},{default:p(()=>[c(D,{name:"i-lucide-video",class:"mr-1",size:"xs"}),w(" "+d(e.$t("common.ai.video")),1)]),_:1})):k("",!0),a.features?.includes("audio")?(m(),x(A,{key:2,variant:"soft",color:"success",size:"xs"},{default:p(()=>[c(D,{name:"i-lucide-audio-lines",class:"mr-1",size:"xs"}),w(" "+d(e.$t("common.ai.audio")),1)]),_:1})):k("",!0)])]),a.billingRule.power>0?(m(),y("div",no,[r("span",null,d(a.billingRule?.power||0)+" "+d(o(s)("ai-provider.backend.model.points")),1),t[4]||(t[4]=r("span",null,"•",-1)),r("span",null,d(a.billingRule?.tokens||0)+" "+d(o(s)("ai-provider.backend.model.tokens")),1)])):(m(),x(A,{key:1,variant:"soft",color:"primary",size:"sm"},{default:p(()=>[...t[5]||(t[5]=[w(" Free ",-1)])]),_:1}))])]),_:2},1024),r("div",io,[c(O,{codes:["ai-models:update"]},{default:p(()=>[c(C,{color:"primary",variant:"ghost",icon:"i-lucide-edit",size:"sm",onClick:M=>Y(a)},null,8,["onClick"]),c(fe,{size:"sm","model-value":a.isActive,"onUpdate:modelValue":M=>o(X)(a.id,M)},null,8,["model-value","onUpdate:modelValue"]),c(C,{class:"drag-handle cursor-move",color:"neutral",variant:"ghost",icon:"i-lucide-grip-vertical",size:"sm",disabled:o(L)},null,8,["disabled"])]),_:2},1024)])],2)]),_:1},8,["modelValue","disabled"])):!o(E)&&o(u).length===0?(m(),y("div",ro,[c(D,{name:"i-lucide-brain",class:"mx-auto mb-4 h-12 w-12 text-gray-400"}),r("h3",co,d(o(s)("ai-provider.backend.model.noModels")),1),r("p",uo,d(o(s)("ai-provider.backend.model.noModelsDescription")),1)])):k("",!0)])}}}),Vo=Object.freeze(Object.defineProperty({__proto__:null,default:mo},Symbol.toStringTag,{value:"Module"}));export{So as a,Co as b,Uo as c,Do as d,To as e,Vo as m};
