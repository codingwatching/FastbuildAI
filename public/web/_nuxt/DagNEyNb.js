const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BqLgZXjT.js","./BixMXl5t.js","./Dgvg0_To.js","./CEOm-hjj.js","./BYm23QKU.js","./DGUAW_1C.js","./DDJ79SjH.js","./Ti3HjCpC.js","./DegKy-XA.js","./B1TeSxwV.js","./RmzZBBRE.js","./C4jlvBh2.js","./C-XPfH0G.js","./7d3iyZ8h.js","./CmGGY7JI.js","./DcxZIiHI.js"])))=>i.map(i=>d[i]);
import{d as j,e as E,ap as G,Q,s as q,aN as H,h as S,_ as Y,r as J,i as W,w as X,j as Z,c as y,o as u,t as n,F as ee,C as oe,m as i,l as m,x as d,q as e,v as te,y as V,k as w,B as ae,R as re,D as ne,U as se}from"#entry";import{_ as le}from"./BixMXl5t.js";import{_ as ie}from"./6WwfWHXT.js";import{_ as de}from"./BadPEZWm.js";import ce from"./CDSfhndf.js";import{_ as me}from"./12pJH7Js.js";import{_ as ue}from"./B-p4_8pw.js";import{_ as pe}from"./CEOm-hjj.js";import{_ as ge}from"./4yDHJZoY.js";import{b as fe,c as he,a as ye}from"./CmGGY7JI.js";import{u as be}from"./zDgZcZqa.js";import{u as _e}from"./C1xCp5oe.js";import{u as ke}from"./DcxZIiHI.js";import"./KiG0a5S-.js";import"./CXk2IlXx.js";import"./kRIii9yh.js";import"./DBwQYu6J.js";import"./B1TeSxwV.js";import"./C6Y-ieo6.js";import"./Ti3HjCpC.js";import"./CyS2mNdj.js";import"./BaKvIqXP.js";import"./cwT2REE1.js";import"./DaC7Nksz.js";import"./DegKy-XA.js";import"./DnFVE45b.js";import"./DSCppvl0.js";import"./7d3iyZ8h.js";import"./DVSiT9pd.js";import"./BstbYvQo.js";import"./DhlnS5e0.js";import"./DlAUqK2U.js";const ve={class:"flex h-full flex-col space-y-4 pb-6"},xe={class:"grid grid-cols-2 gap-4 pt-px md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5"},Se={class:"flex items-center justify-center"},Ve={class:"flex flex-col items-center"},we={class:"text-2xl font-bold"},Ae={class:"text-muted-foreground ml-1 text-xs"},Ce={class:"text-muted-foreground text-xs"},Ue={class:"flex flex-1 flex-col overflow-hidden"},Re={class:"h-fit py-5"},Ie={class:"flex items-center space-x-2"},Ne={class:"flex flex-col items-start"},Te={class:"flex flex-col items-center"},Oe={key:0,class:"text-muted-foreground mb-1 flex justify-center text-xs font-medium"},ze={class:"border-default mt-auto flex items-center justify-between gap-3 border-t pt-4"},De={class:"text-muted flex items-center gap-2 text-sm"},Pe={class:"flex items-center gap-1.5"},Be={class:"text-muted flex items-center gap-2 text-sm"},bo=j({__name:"order-recharge",setup(Ke){const A=re(()=>se(()=>import("./BqLgZXjT.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url)),C=le,b=Y,U=ie,{t:o}=E(),{hasAccessByCodes:_}=be(),R=G(),I=Q(),k=q({totalAmount:0,totalIncome:0,totalOrder:0,totalRefundAmount:0,totalRefundOrder:0}),N=[{key:"totalOrder",unit:"console-common.unit",label:"order.backend.recharge.rechargeCount"},{key:"totalAmount",unit:"console-common.yuan",label:"order.backend.recharge.totalRechargeAmount"},{key:"totalRefundOrder",unit:"console-common.unit",label:"order.backend.recharge.refundCount"},{key:"totalRefundAmount",unit:"console-common.yuan",label:"order.backend.recharge.totalRefundAmount"},{key:"totalIncome",unit:"console-common.yuan",label:"order.backend.recharge.netIncome"}],s=H({keyword:"",orderNo:"",payType:void 0,payStatus:void 0,refundStatus:void 0}),{paging:l,getLists:c,resetPage:T}=_e({fetchFun:fe,params:s}),O=[{accessorKey:"orderNo",header:o("order.backend.recharge.list.orderNo")},{accessorKey:"user",header:o("order.backend.recharge.list.user")},{accessorKey:"power",header:o("order.backend.recharge.list.rechargeQuantity")},{accessorKey:"givePower",header:o("order.backend.recharge.list.freeQuantity")},{accessorKey:"totalPower",header:o("order.backend.recharge.list.quantityReceived")},{accessorKey:"orderAmount",header:o("order.backend.recharge.list.paidInAmount"),cell:({row:r})=>{const a=Number.parseFloat(r.getValue("orderAmount"));return new Intl.NumberFormat("zh-CN",{style:"currency",currency:"CNY"}).format(a)}},{accessorKey:"payTypeDesc",header:o("order.backend.recharge.list.paymentMethod")},{accessorKey:"paymentStatus",header:o("order.backend.recharge.list.paymentStatus")},{accessorKey:"createdAt",header:({column:r})=>{const a=r.getIsSorted();return S(b,{color:"neutral",variant:"ghost",label:o("order.backend.recharge.list.createdAt"),icon:a?a==="asc"?"i-lucide-arrow-up-narrow-wide":"i-lucide-arrow-down-wide-narrow":"i-lucide-arrow-up-down",class:"-mx-2.5",onClick:()=>r.toggleSorting(r.getIsSorted()==="asc")})},cell:({row:r})=>{const a=r.getValue("createdAt");return S(C,{datetime:a,mode:"datetime"})}},{accessorKey:"actions",header:()=>o("order.backend.recharge.list.actions"),size:40,enableSorting:!1,enableHiding:!0}],z=async r=>{await ke({title:o("order.backend.recharge.list.refund"),description:o("console-common.confirmRefund"),color:"warning"}),await ye(r||""),c(),R.success(o("console-common.refundSuccess"))};function D(r){return[_(["recharge-order:detail"])?{label:o("order.backend.recharge.list.viewDetails"),icon:"i-lucide-eye",color:"info",onClick:()=>{B(r.original.id)}}:null,r.original.payStatus===1&&_(["recharge-order:refund"])&&r.original.refundStatus===0?{label:o("order.backend.recharge.list.refund"),icon:"tabler:arrow-back",color:"error",onSelect(){z(r.original.id)}}:null].filter(Boolean)}const g=J({left:[],right:["actions"]}),P=W(()=>{const r=l.extend?.payTypeLists||[];return[{label:o("console-common.all"),value:"all"},...r.map(a=>({label:a.name,value:a.payType}))]});X(()=>l.extend,r=>{r?.statistics&&(k.value=r.statistics)},{deep:!0});const B=async r=>{if(r)try{const a=await he(r);K(a)}catch(a){console.error(a)}},K=r=>{I.create(A).open({order:r,"onGet-list":()=>{c()},onClose:()=>{}})},f=()=>{s.payType==="all"&&(s.payType=void 0),s.payStatus==="all"&&(s.payStatus=void 0),s.refundStatus==="all"&&(s.refundStatus=void 0),T()};return Z(()=>c()),(r,a)=>{const v=de,h=ce,p=me,x=ne,$=ue,M=pe,F=ge;return u(),y("div",ve,[n("div",xe,[(u(),y(ee,null,oe(N,(t,L)=>i(v,{key:L},{default:m(()=>[n("div",Se,[n("div",Ve,[n("div",null,[n("span",we,d(e(k)[t.key]),1),n("span",Ae,d(e(o)(t.unit)),1)]),n("div",Ce,d(e(o)(t.label)),1)])])]),_:2},1024)),64))]),n("div",Ue,[n("div",Re,[n("div",Ie,[i(h,{placeholder:e(o)("order.backend.recharge.list.searchOrderNo"),icon:"i-heroicons-magnifying-glass",modelValue:e(s).orderNo,"onUpdate:modelValue":[a[0]||(a[0]=t=>e(s).orderNo=t),e(c)]},null,8,["placeholder","modelValue","onUpdate:modelValue"]),i(h,{placeholder:e(o)("order.backend.recharge.list.searchUser"),icon:"i-heroicons-magnifying-glass",modelValue:e(s).keyword,"onUpdate:modelValue":[a[1]||(a[1]=t=>e(s).keyword=t),e(c)]},null,8,["placeholder","modelValue","onUpdate:modelValue"]),i(p,{class:"ml-auto",placeholder:e(o)("order.backend.recharge.list.paymentMethod"),items:e(P),modelValue:e(s).payType,"onUpdate:modelValue":[a[2]||(a[2]=t=>e(s).payType=t),f]},null,8,["placeholder","items","modelValue"]),i(p,{placeholder:e(o)("order.backend.recharge.list.paymentStatus"),items:[{label:e(o)("console-common.all"),value:"all"},{label:e(o)("order.backend.recharge.list.paid"),value:"1"},{label:e(o)("order.backend.recharge.list.unpaid"),value:"0"}],modelValue:e(s).payStatus,"onUpdate:modelValue":[a[3]||(a[3]=t=>e(s).payStatus=t),f]},null,8,["placeholder","items","modelValue"]),i(p,{placeholder:e(o)("order.backend.recharge.list.refundStatus"),items:[{label:e(o)("console-common.all"),value:"all"},{label:e(o)("order.backend.recharge.list.refunded"),value:"1"},{label:e(o)("order.backend.recharge.list.notRefunded"),value:"0"}],modelValue:e(s).refundStatus,"onUpdate:modelValue":[a[4]||(a[4]=t=>e(s).refundStatus=t),f]},null,8,["placeholder","items","modelValue"])])]),i(M,{ref:"table",sticky:"",data:e(l).items,loading:e(l).loading,columns:O,"column-pinning":e(g),"onUpdate:columnPinning":a[5]||(a[5]=t=>ae(g)?g.value=t:null),ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default",tr:"[&:has(>td[colspan])]:hidden"},class:""},{"user-cell":m(({row:t})=>[t.original.user?.avatar?(u(),w(x,{key:0,src:t.original.user?.avatar},null,8,["src"])):(u(),w(x,{key:1,icon:"i-heroicons-user",name:t.original.user?.username},null,8,["name"])),V(" "+d(t.original.user?.nickname),1)]),"paymentStatus-cell":m(({row:t})=>[n("div",Ne,[n("div",Te,[t.original.refundStatus===1?(u(),y("div",Oe,d(e(o)("order.backend.recharge.list.paid")),1)):te("",!0),i($,{color:t.original.refundStatus===1?"warning":t.original.payStatus===1?"success":"error"},{default:m(()=>[V(d(t.original.refundStatus===1?e(o)("order.backend.recharge.list.refunded"):t.original.payStatus===1?e(o)("order.backend.recharge.list.paid"):e(o)("order.backend.recharge.list.unpaid")),1)]),_:2},1032,["color"])])])]),"actions-cell":m(({row:t})=>[i(e(U),{items:D(t)},{default:m(()=>[i(e(b),{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost","aria-label":"Actions"})]),_:1},8,["items"])]),_:1},8,["data","loading","column-pinning"]),n("div",ze,[n("div",De,[n("span",null,d(e(o)("console-common.total"))+" "+d(e(l).total)+" "+d(e(o)("console-common.items")),1),i(p,{modelValue:e(l).pageSize,"onUpdate:modelValue":a[6]||(a[6]=t=>e(l).pageSize=t),size:"lg",items:[{label:"10 "+e(o)("console-common.items")+"/"+e(o)("console-common.page"),value:10},{label:"20 "+e(o)("console-common.items")+"/"+e(o)("console-common.page"),value:20},{label:"50 "+e(o)("console-common.items")+"/"+e(o)("console-common.page"),value:50},{label:"100 "+e(o)("console-common.items")+"/"+e(o)("console-common.page"),value:100}],class:"w-28",onChange:e(c)},null,8,["modelValue","items","onChange"])]),n("div",Pe,[i(F,{page:e(l).page,"onUpdate:page":a[7]||(a[7]=t=>e(l).page=t),size:e(l).pageSize,"onUpdate:size":a[8]||(a[8]=t=>e(l).pageSize=t),"show-edges":"",total:e(l).total,onChange:e(c)},null,8,["page","size","total","onChange"]),n("div",Be,[n("span",null,d(e(o)("console-common.goTo")),1),i(h,{modelValue:e(l).page,"onUpdate:modelValue":a[9]||(a[9]=t=>e(l).page=t),size:"lg",type:"number",class:"w-18",onChange:e(c)},null,8,["modelValue","onChange"]),n("span",null,d(e(o)("console-common.page")),1)])])])])])}}});export{bo as default};
